<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />

    <link
      rel="preload"
      href="./fonts/fusion-pixel.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link rel="preload prefetch" href="./global.css" as="style" />
    <link rel="stylesheet" href="./global.css" />
    <!-- <link rel="manifest" href="./manifest.json" /> -->
    <link rel="icon" type="image/png" href="./favicon.ico" />

    <!-- This contains the contents of the <svelte:head> component, if
	     the current page has one -->
    <meta http-equiv="content-security-policy" content=""><title>使用 Google Sheet 作為資料庫</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-CRDP7WTXSQ" data-svelte="svelte-bhtlqr"></script><link rel="shortcut icon" href="/favicon.ico" data-svelte="svelte-1c8ynol"><link rel="bookmark" href="/favicon.ico" data-svelte="svelte-1c8ynol"><link rel="canonical" href="https://f6bfb5.github.io/use-google-spreadsheet-as-database" data-svelte="svelte-17ikmly"><meta property="og:url" content="https://f6bfb5.github.io/use-google-spreadsheet-as-database" data-svelte="svelte-17ikmly"><meta property="og:type" content="article" data-svelte="svelte-17ikmly">
    <meta property="og:title" content="使用 Google Sheet 作為資料庫" data-svelte="svelte-17ikmly">
    

    
    <meta property="og:image" data-svelte="svelte-17ikmly">

    <meta name="twitter:card" content="summary_large_image" data-svelte="svelte-17ikmly">
    <meta name="twitter:title" value="使用 Google Sheet 作為資料庫" data-svelte="svelte-17ikmly">
    
    <meta name="twitter:label1" value="Published on" data-svelte="svelte-17ikmly">
    <meta name="twitter:data1" value="Jul 23, 2022" data-svelte="svelte-17ikmly">
	<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-186f66d9.css">
	<link rel="stylesheet" href="/_app/assets/_post-6cf996f4.css">
	<link rel="stylesheet" href="/_app/assets/BlinkAnchor-39834c8c.css">
	<link rel="stylesheet" href="/_app/assets/login-with-discord-4c509c13.css">
	<link rel="stylesheet" href="/_app/assets/one-way-heroics-all-achievement-note-e75fed03.css">
	<link rel="stylesheet" href="/_app/assets/sticker-generator-a58d6bc5.css">
	<link rel="stylesheet" href="/_app/assets/template-dc5ff06d.css">
	<link rel="stylesheet" href="/_app/assets/BalloonQuote2-65b715a7.css">
	<link rel="stylesheet" href="/_app/assets/tool-list-creativity-74747bfb.css">
	<link rel="stylesheet" href="/_app/assets/what-nft-is-not-17bf58b6.css">
	<link rel="modulepreload" href="/_app/start-5f4ccb98.js">
	<link rel="modulepreload" href="/_app/chunks/index-ea9cc3fd.js">
	<link rel="modulepreload" href="/_app/chunks/index-a65d52b2.js">
	<link rel="modulepreload" href="/_app/chunks/paths-396f020f.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-4c107a64.js">
	<link rel="modulepreload" href="/_app/pages/_slug_.svelte-14834c65.js">
	<link rel="modulepreload" href="/_app/chunks/2020-what-i-have-read-on-internet-371f19bd.js">
	<link rel="modulepreload" href="/_app/chunks/_post-5580ff7d.js">
	<link rel="modulepreload" href="/_app/chunks/BlinkAnchor-922e4ed5.js">
	<link rel="modulepreload" href="/_app/chunks/2021-what-i-have-read-on-internet-497da4d9.js">
	<link rel="modulepreload" href="/_app/chunks/2022-what-i-have-read-on-internet-bd392e26.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-Pause-And-Select-Apocalypse-26186abc.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-char-counterattack-fans-interview-7358e3d3.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-difference-of-director-and-producer-25a09a33.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-does-anno-hideaki-really-dont-know-what-he-is-making-1bc7a0c4.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-evening-chat-of-game-xenogears-bc3d7f0a.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-expression-of-light-and-heavy-f9d5eff9.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-games-done-quick-introduction-6e724fac.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-linda-cube-introduction-1fb24ba1.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-linda-cube-on-ps-archive-55f01cd2.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-making-of-linda3-a9cc6e4f.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-note-399ad83d.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-rockman-1-tas-glitch-05b8ac1b.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-seino-tooru-9723f6d8.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-serial-experiments-lain-for-ps-c107f500.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-super-manga-book-list-7a62a648.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-the-influences-of-naoko-yamada-550e0c47.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-why-you-should-not-use-interpolation-on-anime-ba84d661.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-yume-no-shima-de-aimashou-c934ca2b.js">
	<link rel="modulepreload" href="/_app/chunks/auto-generate-eyecatch-image-for-blog-78f241ab.js">
	<link rel="modulepreload" href="/_app/chunks/autohotkey-note-bfecc18c.js">
	<link rel="modulepreload" href="/_app/chunks/blog-with-hexo-26e8599e.js">
	<link rel="modulepreload" href="/_app/chunks/blog-with-sapper-2c91723f.js">
	<link rel="modulepreload" href="/_app/chunks/blog-with-sveltekit-6f32de93.js">
	<link rel="modulepreload" href="/_app/chunks/capitalist-realism-mark-fisher-b8e0bdb3.js">
	<link rel="modulepreload" href="/_app/chunks/dot-painting-note-a3974fb6.js">
	<link rel="modulepreload" href="/_app/chunks/escape-from-algorithm-with-rss-ea2e1c36.js">
	<link rel="modulepreload" href="/_app/chunks/how-do-you-like-wendesday-904527a9.js">
	<link rel="modulepreload" href="/_app/chunks/how-to-check-font-family-name-in-computer-2427ede1.js">
	<link rel="modulepreload" href="/_app/chunks/login-with-discord-d05e815e.js">
	<link rel="modulepreload" href="/_app/chunks/mpv-e5941829.js">
	<link rel="modulepreload" href="/_app/chunks/one-way-heroics-all-achievement-note-bd579a01.js">
	<link rel="modulepreload" href="/_app/chunks/operating-with-keyboard-383a868b.js">
	<link rel="modulepreload" href="/_app/chunks/random-thoughts-about-rockman-x-dive-73e3dad5.js">
	<link rel="modulepreload" href="/_app/chunks/AutomaticColorText-c8bd26ca.js">
	<link rel="modulepreload" href="/_app/chunks/search-engine-operators-6d66b345.js">
	<link rel="modulepreload" href="/_app/chunks/sticker-generator-d6517c48.js">
	<link rel="modulepreload" href="/_app/chunks/LibLoader-18295e59.js">
	<link rel="modulepreload" href="/_app/chunks/template-9db1f04f.js">
	<link rel="modulepreload" href="/_app/chunks/BalloonQuote2-d940fc87.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-creativity-79412c2f.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-gaming-87c055d8.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-system-9fc0f957.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-website-33ebee6a.js">
	<link rel="modulepreload" href="/_app/chunks/use-foobar2k-to-listen-to-podcast-fcd6a674.js">
	<link rel="modulepreload" href="/_app/chunks/use-google-spreadsheet-as-database-88942600.js">
	<link rel="modulepreload" href="/_app/chunks/what-nft-is-not-25046f20.js">
	<link rel="modulepreload" href="/_app/chunks/why-is-life-so-boring-a861c04a.js">
  </head>
  <body>
    <!-- The application will be rendered inside this element,
	     because `app/client.js` references it -->
    








<div class="layout svelte-1avnl50" style=""><div class="loader-container svelte-1avnl50"><div class="loader svelte-v56dyc"><span class="loader-text loader-step1 svelte-v56dyc">/</span>
  <span class="loader-text loader-step1 svelte-v56dyc">-</span>
  <span class="loader-text loader-step1 svelte-v56dyc">\</span>
  <span class="loader-text loader-step1 svelte-v56dyc">|</span>
</div></div></div>

<div class="layout svelte-1avnl50" style="display: none;">
  
  <header class="svelte-ka06mn"><div class="header-container svelte-ka06mn"><div class="row svelte-ka06mn"><nav class="svelte-t90z2a"><a class=" svelte-t90z2a" href="/">トリコじかけの明け暮れ
  </a>
  <a class=" svelte-t90z2a" href="/about">about
  </a>
  <a class=" svelte-t90z2a" href="/rss.xml" target="_blank">rss
  </a>
  <a style="display: none;" href="/sitemap.xml" target="_blank" class="svelte-t90z2a">sitemap
  </a>
</nav>
      <a href="https://www.youtube.com/watch?v=f92VWkYl8CI" target="_blank" rel="noreferrer noopener" class="svelte-1swke90"><img src="data:image/gif;base64,AAABAAEAEBAQAAAAAAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAABbl4Awr28AAAAAAC4pp4ACgUAAFomhAB4aGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiIiQiQiIkREREREJCIiQRERERESIiJBEhEREREiIkFCQRFRESIiQRIRERFRIiJBEREREREiIkE2ZmZmESQiQWYAAAZhJCJBZgAABmEkIkFmAAAGYSQiQWYAAAZhRCJBZgAABmFEIkE2ZmZmMUQiQRERERERRCJERERERERCLABwAAgAMAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAwAA" alt="logo" style="width: 36px; height: 42px;">
</a></div>
    
<div id="progress-bar" style="--scrollAmount: 0%;" class="svelte-1gbseey"></div></div>
</header>

  <main class="svelte-1avnl50">

<header class="svelte-5uw8di"><h1 class="title svelte-5uw8di"><span style="animation-delay: 125ms; " class="svelte-5uw8di">使
      </span><span style="animation-delay: 150ms; " class="svelte-5uw8di">用
      </span><span style="animation-delay: 175ms; width: .25em;" class="svelte-5uw8di"> 
      </span><span style="animation-delay: 200ms; " class="svelte-5uw8di">G
      </span><span style="animation-delay: 225ms; " class="svelte-5uw8di">o
      </span><span style="animation-delay: 250ms; " class="svelte-5uw8di">o
      </span><span style="animation-delay: 275ms; " class="svelte-5uw8di">g
      </span><span style="animation-delay: 300ms; " class="svelte-5uw8di">l
      </span><span style="animation-delay: 325ms; " class="svelte-5uw8di">e
      </span><span style="animation-delay: 350ms; width: .25em;" class="svelte-5uw8di"> 
      </span><span style="animation-delay: 375ms; " class="svelte-5uw8di">S
      </span><span style="animation-delay: 400ms; " class="svelte-5uw8di">h
      </span><span style="animation-delay: 425ms; " class="svelte-5uw8di">e
      </span><span style="animation-delay: 450ms; " class="svelte-5uw8di">e
      </span><span style="animation-delay: 475ms; " class="svelte-5uw8di">t
      </span><span style="animation-delay: 500ms; width: .25em;" class="svelte-5uw8di"> 
      </span><span style="animation-delay: 525ms; " class="svelte-5uw8di">作
      </span><span style="animation-delay: 550ms; " class="svelte-5uw8di">為
      </span><span style="animation-delay: 575ms; " class="svelte-5uw8di">資
      </span><span style="animation-delay: 600ms; " class="svelte-5uw8di">料
      </span><span style="animation-delay: 625ms; " class="svelte-5uw8di">庫
      </span></h1>
  <p class="meta svelte-5uw8di"><span class="date svelte-5uw8di">Jul 23, 2022</span>
    <div class="tags svelte-5uw8di"><span class="tag svelte-5uw8di">F2E</span><span class="tag svelte-5uw8di">Toolbox</span></div></p></header>
<div class="post--container svelte-5uw8di"><article class="post--content svelte-5uw8di"><h2 id="js-id-介紹">介紹</h2>
<ul><li>Google 的 Sheet API 可以直接將 Sheet 內容轉換成 JSON 格式輸出</li>
<li>亦可從外部傳進資料，修改 Sheet 裡的內容</li>
<li>並有提供 CORS 支援，可免於處理跨域的困擾</li></ul>
<h2 id="js-id-實作">實作</h2>
<h3>1. [純讀取] Spreadsheets Data API</h3>
<ul><li>發佈表單<ul><li>「檔案（File）」</li>
<li>「發佈到網路（Publish to the web）」</li>
<li>選擇要發佈的 Sheet／發佈整份文件</li>
<li>點擊「發佈（Publish）」</li></ul></li>
<li>複製原始表單網址裡 <code>[sheet-id]</code> 的部份<ul><li><code>https://docs.google.com/spreadsheets/d/[sheet-id]/</code></li>
<li>注意：不是發佈頁面的連結網址，是<strong>表單的網址</strong></li></ul></li>
<li>從 API 取得資料<ul><li>將 <code>[sheet-id]</code> 貼至 Spreadsheets Data API 網址裡的對應處</li>
<li><code>https://spreadsheets.google.com/feeds/cells/[sheet-id]/[sheet-index]/public/values?alt=json</code></li>
<li><code>https://spreadsheets.google.com/feeds/list/[sheet-id]/[sheet-index]/public/values?alt=json</code><ul><li>預設格式為 xml，在後面加上 <code>?alt=json</code> 改為取得 JSON 格式</li></ul></li>
<li><code>[sheet-index]</code> 可以指定要取得表單裡的哪個分頁</li>
<li>ex: <code>https://spreadsheets.google.com/feeds/cells/[sheet-id]/1/public/values?alt=json</code><ul><li><code>od6</code> 似乎是 API 的預設值？</li></ul></li></ul></li>
<li>主要內容在 <code>feed.entry.content</code> 或 <code>feed.entry.gs$cell</code> 裡</li></ul>
<p>資料結構：</p>
<pre class="language-json"><!-- HTML_TAG_START --><code class="language-json"><span class="token punctuation">&#123;</span>
  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>
  <span class="token property">"encoding"</span><span class="token operator">:</span> <span class="token string">"UTF-8"</span><span class="token punctuation">,</span>
  <span class="token property">"feed"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token property">"xmlns"</span><span class="token operator">:</span> <span class="token string">"http://www.w3.org/2005/Atom"</span><span class="token punctuation">,</span>
    ...
    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
      <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
      <span class="token property">"$t"</span><span class="token operator">:</span> <span class="token string">"Sheet1"</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token property">"link"</span><span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span><span class="token punctuation">,</span>
    ...
    <span class="token property">"entry"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">&#123;</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>...<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
        ...
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span>
        <span class="token property">"$t"</span><span class="token operator">:</span> <span class="token string">"content"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      <span class="token property">"link"</span><span class="token operator">:</span> <span class="token punctuation">[</span>...<span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"gs$cell"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token property">"row"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"col"</span><span class="token operator">:</span> <span class="token string">"1"</span><span class="token punctuation">,</span>
        <span class="token property">"$t"</span><span class="token operator">:</span> <span class="token string">"content"</span>
      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
      ...
    <span class="token punctuation">]</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<h3>2. [可讀寫] Google Apps Script</h3>
<ul><li>建立 GAS 檔案<ul><li>「Extensions」</li>
<li>「指令碼編輯器（Script editor）」</li></ul></li>
<li>撰寫 GAS<ul><li>預設以 <code>doGet()</code> 處理 GET 要求、<code>doPost()</code> 處理 POST 要求</li>
<li>詳見下方範例</li></ul></li>
<li>發佈 API<ul><li>「Deploy」</li>
<li>「Select type」<ul><li>「網路應用程式（web app）」</li></ul></li>
<li>「Description」<ul><li>發佈註解</li></ul></li>
<li>「將應用程式執行為（Execute the app as）」<ul><li><strong>「我（Me）」</strong></li></ul></li>
<li>「具有應用程式存取權的使用者（Who has access to the app）」<ul><li><strong>「任何人，甚至匿名使用者（Anyone, even anonymous）」</strong></li></ul></li>
<li>「部署（Deploy）」<ul><li>「核對權限（Authorize access）」</li>
<li>選擇授權用的 Google 帳號</li>
<li>「進階（Advanced）」</li>
<li>「前往 <code>此應用程式名稱</code>（Go to <code>[web app name]</code> (unsafe)）」</li>
<li>「允許（Allow）」</li></ul></li>
<li>「Web app」底下的「URL」即為讀取與寫入用的網址<ul><li>之後也可以從「Deploy」→「Manage deployments」裡查詢</li></ul></li></ul></li>
<li>若有更改程式<ul><li>部署時「專案版本（Project version）」要選擇「新增（New）」</li>
<li>既有數字是之前發佈的版本，不會反應最新的修改內容</li>
<li>改動後一定要選擇「新增」專案版本，才會有效反應</li></ul></li>
<li>表單資料格式<ul><li>要注意 Google Sheet 預設會自動轉換各種資料</li>
<li>例如 <code>0123</code> 會被轉換成數值後，變成 <code>123</code></li>
<li>推薦事先點選表單左上角格全選後，將格式設為純文字</li></ul></li></ul>
<details><summary>範例程式</summary>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token comment">// Sheet 網址裡 [sheet-id] 的部份</span>
<span class="token comment">// https://docs.google.com/spreadsheets/d/[sheet-id]/</span>
<span class="token comment">// </span>
<span class="token comment">//            col1 col2</span>
<span class="token comment">// row1 ---->  |    |</span>
<span class="token comment">// row2 ---->  |    |</span>
<span class="token comment">//             v    v</span>

<span class="token keyword">const</span> SpreadSheetID <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> SpreadSheet <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">openById</span><span class="token punctuation">(</span>SpreadSheetID<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">textOutput</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> mimeType <span class="token operator">=</span> <span class="token string">"JSON"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> ContentService<span class="token punctuation">.</span><span class="token function">createTextOutput</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMimeType</span><span class="token punctuation">(</span>
    ContentService<span class="token punctuation">.</span>MimeType<span class="token punctuation">[</span>mimeType<span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token parameter">sheetName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> SpreadSheet<span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ----------</span>
<span class="token comment">// doGet</span>
<span class="token comment">// ----------</span>

<span class="token keyword">function</span> <span class="token function">getAllSheetData</span><span class="token punctuation">(</span><span class="token parameter">sheetName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> Sheet <span class="token operator">=</span> <span class="token function">getSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// the first row is category,</span>
  <span class="token comment">// so row starts from 2</span>
  <span class="token comment">//</span>
  <span class="token comment">// and the first row is not needed,</span>
  <span class="token comment">// so length is full length -1</span>
  <span class="token comment">//</span>
  <span class="token keyword">return</span> Sheet<span class="token punctuation">.</span><span class="token function">getSheetValues</span><span class="token punctuation">(</span>
    <span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token number">1</span><span class="token punctuation">,</span>
    Sheet<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span>
    Sheet<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">getSheetDataByRange</span><span class="token punctuation">(</span><span class="token parameter">sheetName<span class="token punctuation">,</span> range</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> Sheet <span class="token operator">=</span> <span class="token function">getSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// wouldn't return category row (the first row) by default</span>
  <span class="token keyword">const</span> startRow <span class="token operator">=</span> range<span class="token punctuation">.</span>startRow <span class="token operator">?</span> range<span class="token punctuation">.</span>startRow <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> startCol <span class="token operator">=</span> range<span class="token punctuation">.</span>startCol <span class="token operator">?</span> range<span class="token punctuation">.</span>startCol <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> rowRange <span class="token operator">=</span>
    range<span class="token punctuation">.</span>endRow <span class="token operator">&amp;&amp;</span> range<span class="token punctuation">.</span>startRow
      <span class="token operator">?</span> range<span class="token punctuation">.</span>endRow <span class="token operator">-</span> range<span class="token punctuation">.</span>startRow <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token operator">:</span> Sheet<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> colRange <span class="token operator">=</span>
    range<span class="token punctuation">.</span>endCol <span class="token operator">&amp;&amp;</span> range<span class="token punctuation">.</span>startCol
      <span class="token operator">?</span> range<span class="token punctuation">.</span>endCol <span class="token operator">-</span> range<span class="token punctuation">.</span>startCol <span class="token operator">+</span> <span class="token number">1</span>
      <span class="token operator">:</span> Sheet<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>rowRange <span class="token operator">></span> Sheet<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> rowRange <span class="token operator">=</span> Sheet<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>colRange <span class="token operator">></span> Sheet<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> colRange <span class="token operator">=</span> Sheet<span class="token punctuation">.</span><span class="token function">getLastColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> data <span class="token operator">=</span> Sheet<span class="token punctuation">.</span><span class="token function">getSheetValues</span><span class="token punctuation">(</span>startRow<span class="token punctuation">,</span> startCol<span class="token punctuation">,</span> rowRange<span class="token punctuation">,</span> colRange<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ex. &#123;</span>
<span class="token comment">//       2: [ ['row2_cell1'], ['row2_cell2'], ['row2_cell3'] ],</span>
<span class="token comment">//       5: [ ['row5_cell1'], ['row5_cell2'], ['row5_cell3'] ]</span>
<span class="token comment">//     &#125;</span>
<span class="token keyword">function</span> <span class="token function">getSheetDataBySpecificColumns</span><span class="token punctuation">(</span><span class="token parameter">sheetName<span class="token punctuation">,</span> columnsArray</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> Sheet <span class="token operator">=</span> <span class="token function">getSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span>
  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>columnsArray<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">column</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    data<span class="token punctuation">[</span>column<span class="token punctuation">]</span> <span class="token operator">=</span> Sheet<span class="token punctuation">.</span><span class="token function">getSheetValues</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> column<span class="token punctuation">,</span> Sheet<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// accept object as parameter</span>
  <span class="token keyword">const</span> params <span class="token operator">=</span> e<span class="token operator">?.</span>parameter<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>params<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// you can custom what key to use for different execution</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>params<span class="token punctuation">.</span>action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token string">"getAll"</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token function">getAllSheetData</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">"getSpecificColumns"</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span>
        <span class="token function">getSheetDataBySpecificColumns</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> params<span class="token punctuation">.</span>columnsArray<span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ----------</span>
<span class="token comment">// doPost</span>
<span class="token comment">// ----------</span>

<span class="token keyword">function</span> <span class="token function">appendSheetRow</span><span class="token punctuation">(</span><span class="token parameter">sheetName<span class="token punctuation">,</span> newRowData</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> Sheet <span class="token operator">=</span> <span class="token function">getSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> newRow <span class="token operator">=</span> Sheet<span class="token punctuation">.</span><span class="token function">getLastRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token comment">// accept number key as row-col index</span>
  <span class="token comment">// for example,</span>
  <span class="token comment">// data: &#123; 1: "Cell 1 data", 2: "Cell 2 data", 3: "Cell 3 data" &#125;</span>
  <span class="token comment">// would save to the row by the key</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">[</span>index<span class="token punctuation">,</span> cellData<span class="token punctuation">]</span> <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span>newRowData<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    Sheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span>newRow<span class="token punctuation">,</span> index<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>cellData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">editSheetCell</span><span class="token punctuation">(</span><span class="token parameter">sheetName<span class="token punctuation">,</span> row<span class="token punctuation">,</span> col<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span>row<span class="token punctuation">,</span> col<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">deleteSheetRow</span><span class="token punctuation">(</span><span class="token parameter">sheetName<span class="token punctuation">,</span> row</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token function">getSheet</span><span class="token punctuation">(</span>sheetName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">deleteRow</span><span class="token punctuation">(</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">function</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// accept object as post data</span>
  <span class="token keyword">const</span> postContents <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token operator">?.</span>postData<span class="token punctuation">.</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>postContents<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token comment">// you can custom what key to use for different execution</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>postContents<span class="token punctuation">.</span>action<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">case</span> <span class="token string">"appendRow"</span><span class="token operator">:</span>
      <span class="token comment">// again, you can also custom what key to use for post data</span>
      <span class="token function">appendSheetRow</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> postContents<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">"editCell"</span><span class="token operator">:</span>
      <span class="token function">editSheetCell</span><span class="token punctuation">(</span>
        <span class="token string">"Sheet1"</span><span class="token punctuation">,</span>
        postContents<span class="token punctuation">.</span>row<span class="token punctuation">,</span>
        postContents<span class="token punctuation">.</span>col<span class="token punctuation">,</span>
        postContents<span class="token punctuation">.</span>data
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">"deleteRow"</span><span class="token operator">:</span>
      <span class="token function">deleteSheetRow</span><span class="token punctuation">(</span><span class="token string">"Sheet1"</span><span class="token punctuation">,</span> postContents<span class="token punctuation">.</span>row<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">return</span> <span class="token function">textOutput</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span> <span class="token literal-property property">response</span><span class="token operator">:</span> <span class="token string">"200"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">// ----------</span>
<span class="token comment">// onEdit</span>
<span class="token comment">// ----------</span>
<span class="token comment">// google apps script - onEdit trigger for specific sheets in a spreadsheet? - Stack Overflow</span>
<span class="token comment">// https://stackoverflow.com/questions/49465608/onedit-trigger-for-specific-sheets-in-a-spreadsheet</span>

<span class="token keyword">function</span> <span class="token function">onEdit</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">const</span> editedSheetName <span class="token operator">=</span> e<span class="token punctuation">.</span>range<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>editedSheetName <span class="token operator">!=</span> <span class="token string">"SomeSheetName"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// some execution here</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></details>
<h2 id="js-id-參考文章">參考文章</h2>
<ul><li><a href="https://medium.com/unalai/%E5%AF%AB%E7%B5%A6%E7%B4%94%E5%89%8D%E7%AB%AF-%E8%AE%93-google-sheets-%E7%95%B6%E4%BD%A0%E7%9A%84%E5%BE%8C%E7%AB%AF%E5%AE%8C%E6%88%90%E5%AF%AB%E5%85%A5%E5%8A%9F%E8%83%BD-715799e5e013" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://medium.com/unalai/%E5%AF%AB%E7%B5%A6%E7%B4%94%E5%89%8D%E7%AB%AF-%E8%AE%93-google-sheets-%E7%95%B6%E4%BD%A0%E7%9A%84%E5%BE%8C%E7%AB%AF%E5%AE%8C%E6%88%90%E5%AF%AB%E5%85%A5%E5%8A%9F%E8%83%BD-715799e5e013" alt="寫給純前端，讓 Google Sheets 當你的後端完成寫入功能"><span>寫給純前端，讓 Google Sheets 當你的後端完成寫入功能</span></a></li>
<li><a href="https://tutorials.webduino.io/zh-tw/docs/socket/useful/google-sheet-2.html" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://tutorials.webduino.io/zh-tw/docs/socket/useful/google-sheet-2.html" alt="Google 試算表 (前後端實作)"><span>Google 試算表 (前後端實作)</span></a></li>
<li><a href="https://g0v.hackpad.tw/5Ofw64qSz7P#:h=Google-Spreadsheet" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://g0v.hackpad.tw/5Ofw64qSz7P#:h=Google-Spreadsheet" alt="盤點各種線上協作資料(庫)方案 - g0v.hackpad.tw"><span>盤點各種線上協作資料(庫)方案 - g0v.hackpad.tw</span></a></li></ul>
<h2 id="js-id-gas">GAS</h2>
<ul><li><p><a href="https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app" alt="SpreadsheetApp"><span>SpreadsheetApp</span></a></p></li>
<li><p><a href="https://developers.google.com/apps-script/reference/spreadsheet/sheet" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://developers.google.com/apps-script/reference/spreadsheet/sheet" alt="Sheet"><span>Sheet</span></a></p></li>
<li><p><a href="https://developers.google.com/apps-script/guides/web" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://developers.google.com/apps-script/guides/web" alt="Web Apps"><span>Web Apps</span></a></p></li>
<li><p>處理 GET</p>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>parameter<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  <span class="token function">getHandler</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></li>
<li><p>處理 POST</p>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> parameter <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>postData<span class="token punctuation">.</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> parameter<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  <span class="token function">postHandler</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre></li>
<li><p>操作觸發處理</p>
<ul><li><code>onEdit(event)</code><ul><li>想做進一步操作似乎會有權限問題…？</li></ul></li>
<li><code>Apps Script</code> 頁面左側的 <code>Triggers</code></li>
<li><code>Apps Script</code> 頁面左側的 <code>Executions</code> 可查看腳本執行是否正常</li></ul></li>
<li><p>GAS 的回傳資料格式</p>
<ul><li>字串：<code>return ContentService.createTextOutput(&quot;回傳字串&quot;);</code></li>
<li>HTML：<code>return HtmlService.createHtmlOutput(HTMLString);</code></li>
<li>JSON：<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">const</span> JSONString <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">return</span> ContentService<span class="token punctuation">.</span><span class="token function">createTextOutput</span><span class="token punctuation">(</span>JSONString<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setMimeType</span><span class="token punctuation">(</span>
  ContentService<span class="token punctuation">.</span>MimeType<span class="token punctuation">.</span><span class="token constant">JSON</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre></li></ul></li>
<li><p>從 GAS 獲取資料</p>
<ul><li>透過網址傳送參數</li>
<li>參數傳到 <code>e.parameter</code></li></ul>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">const</span> apiUrl <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> action <span class="token operator">=</span> <span class="token string">"getSpecificColumns"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> columnsArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 若參數內有另外傳入資料，例如傳入陣列，須做 JSON.stringify()</span>
<span class="token comment">// GAS 處也要進行 JSON.parse() 處理</span>
<span class="token keyword">const</span> getParameter <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">?action=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>action<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
&amp;columnsArray=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>columnsArray<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>apiUrl <span class="token operator">+</span> getParameter<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"GET"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">response</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 處理取得資料</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre></li>
<li><p>傳送資料至 GAS</p>
<ul><li>透過請求傳送資料</li>
<li>資料傳到 <code>e.postData.contents</code></li></ul>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">const</span> apiUrl <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> postData <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">action</span><span class="token operator">:</span> <span class="token string">"appendRow"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token number">1</span><span class="token operator">:</span> <span class="token string">"some data to post"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>apiUrl<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>postData<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"content-type"</span><span class="token operator">:</span> <span class="token string">"text/plain;charset=utf-8"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">redirect</span><span class="token operator">:</span> <span class="token string">"follow"</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre></li>
<li><p>讀取表單</p>
<ul><li>SpreadSheet<ul><li><code>SpreadsheetApp.getActiveSpreadsheet()</code></li>
<li><code>SpreadsheetApp.openById(SpreadSheetID)</code></li></ul></li>
<li>Sheet<ul><li><code>Spreadsheet#getSheetByName(sheetName)</code></li>
<li><code>Spreadsheet#getSheets()[sheetIndex]</code></li></ul></li>
<li>Range<ul><li><code>Sheet#getRange(row, column)</code><ul><li>表單的行與列起始座標值是 <code>1</code>，不是 <code>0</code>，須注意</li></ul></li>
<li><code>Sheet#getRange(row, column, numRows)</code></li>
<li><code>Sheet#getRange(row, column, numRows, numColumns)</code></li>
<li><code>Sheet#getRange(cellRangeNotation)</code><ul><li>ex: <code>getRange(&quot;A1:B2&quot;)</code></li></ul></li>
<li><code>Range#getValues()</code><ul><li>ex. <code>const values = sheet.getRange(&quot;A1:C2&quot;).getValues();</code></li>
<li><code>const values = sheet.getRange(&quot;A1:C2&quot;).getValues().flat();</code></li></ul></li>
<li><code>Sheet#getSheetValues(startRow, startColumn, numRows, numColumns)</code><ul><li>表單的行與列起始座標值是 <code>1</code>，不是 <code>0</code>，須注意</li></ul></li></ul></li></ul></li>
<li><p>寫入表單</p>
<ul><li>Range<ul><li><code>Range#setValues(values)</code></li>
<li><pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">const</span> rowLength <span class="token operator">=</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">const</span> colLength <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
sheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> rowLength<span class="token punctuation">,</span> colLength<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValues</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre></li></ul></li></ul></li>
<li><p><a href="https://developers.google.com/apps-script/reference/utilities/utilities" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://developers.google.com/apps-script/reference/utilities/utilities" alt="Utilities"><span>Utilities</span></a></p>
<ul><li>Timestamp<ul><li><code>Utilities.formatDate(new Date(), &quot;Asia/Taipei&quot;, &quot;顯示格式&quot;);</code></li>
<li>顯示格式<ul><li><code>年：y</code></li>
<li><code>月：M</code></li>
<li><code>日：d</code></li>
<li><code>時（12 小時制）：h</code></li>
<li><code>時（24 小時制）：H</code></li>
<li><code>分：m</code></li>
<li><code>秒：s</code></li>
<li><code>&#39;yyyy/MM/dd/HH:mm&#39;</code> → <code>2020/12/31/23:59</code></li></ul></li></ul></li>
<li>Hash<ul><li><code>var md5bin = Utilities.computeDigest(Utilities.DigestAlgorithm.MD5, text);</code></li>
<li><code>var md5 = Utilities.base64Encode(md5bin);</code></li></ul></li></ul></li>
<li><p>Use library</p>
<ul><li>Libraries</li>
<li>貼上 script id</li>
<li>追加</li>
<li><a href="https://github.com/tani/cheeriogs" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/tani/cheeriogs" alt="Cheeriogs"><span>Cheeriogs</span></a></li></ul></li>
<li><p>Message Box</p>
<ul><li><code>if (Browser.msgBox(&quot;確認&quot;, &quot;是否要執行？&quot;, Browser.Buttons.YES_NO) != &quot;yes&quot;)</code></li></ul></li></ul>
<h3>撰寫 Discord Webhook</h3>
<ul><li>建立 Webhook<ul><li>點擊 Discord 頻道右邊的齒輪鍵</li>
<li>點擊 <code>Integrations</code> -&gt; <code>Create Webhook</code> -&gt; <code>Copy Webhook URL</code></li></ul></li>
<li>撰寫 GAS</li>
<li><a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app" alt="UrlFetchApp"><span>UrlFetchApp</span></a></li>
<li><code>UrlFetchApp.fetch(url[, params])</code></li>
<li>params<ul><li><code>contentType</code></li>
<li><code>headers</code></li>
<li><code>method</code></li>
<li><code>payload</code></li></ul></li>
<li>response<ul><li><code>getContentText()</code></li>
<li><code>getHeaders()</code></li>
<li><code>getResponseCode()</code></li>
<li><code>getBlob()</code></li></ul></li></ul>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">function</span> <span class="token function">sendToDiscord</span><span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> url      <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// 上方建立的 Webhook 網址</span>
  <span class="token keyword">const</span> token    <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// Webhook 網址後半的 token 部份</span>
                       <span class="token comment">// * 未確認是否已不需要</span>
  <span class="token keyword">const</span> channel  <span class="token operator">=</span> <span class="token string">'#general'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> text     <span class="token operator">=</span> message<span class="token punctuation">;</span>
  <span class="token keyword">const</span> username <span class="token operator">=</span> <span class="token string">'bot'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> parse    <span class="token operator">=</span> <span class="token string">'full'</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> method   <span class="token operator">=</span> <span class="token string">'POST'</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">'token'</span>     <span class="token operator">:</span> token<span class="token punctuation">,</span>
    <span class="token string-property property">'channel'</span>   <span class="token operator">:</span> channel<span class="token punctuation">,</span>
    <span class="token string-property property">'content'</span>   <span class="token operator">:</span> text<span class="token punctuation">,</span>
    <span class="token string-property property">'username'</span>  <span class="token operator">:</span> username<span class="token punctuation">,</span>
    <span class="token string-property property">'parse'</span>     <span class="token operator">:</span> parse<span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">'method'</span><span class="token operator">:</span> method<span class="token punctuation">,</span>
    <span class="token string-property property">'payload'</span><span class="token operator">:</span> payload<span class="token punctuation">,</span>
    <span class="token string-property property">'muteHttpExceptions'</span><span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

  response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<h3>Save as excel file</h3>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">var</span> sheetID <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> fetchUrl <span class="token operator">=</span>
  <span class="token string">"https://docs.google.com/feeds/download/spreadsheets/Export?key="</span> <span class="token operator">+</span>
  sheetID <span class="token operator">+</span>
  <span class="token string">"&amp;amp;exportFormat=xlsx"</span><span class="token punctuation">;</span>

<span class="token comment">//OAuth</span>
<span class="token keyword">var</span> fetchOpt <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span> <span class="token literal-property property">Authorization</span><span class="token operator">:</span> <span class="token string">"Bearer "</span> <span class="token operator">+</span> ScriptApp<span class="token punctuation">.</span><span class="token function">getOAuthToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">muteHttpExceptions</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> xlsxFile <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>fetchUrl<span class="token punctuation">,</span> fetchOpt<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"filename.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre>
<h3>參考文章</h3>
<ul><li><a href="https://github.com/contributorpw/google-apps-script-awesome-list#parsing" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/contributorpw/google-apps-script-awesome-list#parsing" alt="google-apps-script-awesome-list"><span>google-apps-script-awesome-list</span></a></li>
<li><a href="https://qiita.com/matsu7089/items/6ea7931e97ae703f6607?utm_campaign=6922a8b5e9-Qiita_newsletter_419_07_15_2020&utm_term=0_e44feaa081-6922a8b5e9-34565689#%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-onget-%E3%82%92%E3%81%A4%E3%81%8F%E3%82%8B" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/matsu7089/items/6ea7931e97ae703f6607?utm_campaign=6922a8b5e9-Qiita_newsletter_419_07_15_2020&utm_term=0_e44feaa081-6922a8b5e9-34565689#%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-onget-%E3%82%92%E3%81%A4%E3%81%8F%E3%82%8B" alt="【GAS x Vue.js】JavaScript のみで今、家計簿をつくるとしたら【ハンズオン付き！】"><span>【GAS x Vue.js】JavaScript のみで今、家計簿をつくるとしたら【ハンズオン付き！】</span></a></li>
<li><a href="https://qiita.com/hironobu-igawa/items/9b5c224d9bbe7b9843be" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/hironobu-igawa/items/9b5c224d9bbe7b9843be" alt="【初心者向け Tips】単純作業はもう嫌だ！GAS ツール作りの 4 つの技"><span>【初心者向け Tips】単純作業はもう嫌だ！GAS ツール作りの 4 つの技</span></a></li>
<li><a href="https://qiita.com/FUJIvillage/items/e22ad7efdf7fc898ffda" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/FUJIvillage/items/e22ad7efdf7fc898ffda" alt="Google Apps Script（GAS）を利用した業務改善"><span>Google Apps Script（GAS）を利用した業務改善</span></a></li>
<li><a href="https://qiita.com/mitonattou919/items/de415bb9302a52d52e2e" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/mitonattou919/items/de415bb9302a52d52e2e" alt="Google Apps Script の割り当て値と制限値"><span>Google Apps Script の割り当て値と制限値</span></a></li>
<li><a href="https://qiita.com/shikumiya_hata/items/5e11ff875a9dd050a722" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/shikumiya_hata/items/5e11ff875a9dd050a722" alt="GAS でライブラリを使う・作る方法"><span>GAS でライブラリを使う・作る方法</span></a></li>
<li><a href="https://qiita.com/TakeshiNickOsanai/items/62810b0e96bf37bd0eca" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/TakeshiNickOsanai/items/62810b0e96bf37bd0eca" alt="Google Apps Script + OAuth ライブラリで、freee API の操作を行う"><span>Google Apps Script + OAuth ライブラリで、freee API の操作を行う</span></a></li>
<li><a href="https://qiita.com/yamaguchi_yo/items/09bfc5c32faffa3beb62" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/yamaguchi_yo/items/09bfc5c32faffa3beb62" alt="法改正情報を早く確実にキャッチするために GAS で自動化するツールを作って運用してみた。"><span>法改正情報を早く確実にキャッチするために GAS で自動化するツールを作って運用してみた。</span></a></li>
<li><a href="https://qiita.com/cyoi0129/items/1cafb446dbe176e9366e" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/cyoi0129/items/1cafb446dbe176e9366e" alt="スクレイピングいろいろ"><span>スクレイピングいろいろ</span></a></li>
<li><a href="https://qiita.com/tapatyo/items/465a982635ba3933b32d" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/tapatyo/items/465a982635ba3933b32d" alt="【Google Apps Script】トリガーによる定期実行の時間のズレをなくす方法"><span>【Google Apps Script】トリガーによる定期実行の時間のズレをなくす方法</span></a></li></ul>
<h2 id="js-id-番外-客製化-google-form">[番外？] 客製化 Google Form</h2>
<ul><li>使用 Google Form 製作好和需求相同形式的表單</li>
<li>點擊右上預覽表單</li>
<li>開啟開發者工具</li>
<li>尋找 <code>&lt;form&gt;</code> 標籤的 <code>action</code> 屬性中的傳送表單網址<ul><li><code>action=[表單網址]</code></li>
<li><code>https://docs.google.com/forms/u/0/d/e/xxxxxxx/formResponse</code></li></ul></li>
<li>尋找所有提問的 id<ul><li><code>name=[提問 ID]</code></li>
<li>通常為 <code>entry.xxxxxxx</code>，可使用此關鍵字快速搜尋</li></ul></li>
<li>另外撰寫表格網頁，將傳送行為綁定至自訂的傳送按鍵上</li></ul>
<h3>參考文章</h3>
<ul><li><a href="https://qiita.com/inoue2002/items/78dac54dba93ea4a087a" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/inoue2002/items/78dac54dba93ea4a087a" alt="独自フォームと Google フォームを連携してかっこよくスマートにアンケート回収する"><span>独自フォームと Google フォームを連携してかっこよくスマートにアンケート回収する</span></a></li>
<li><a href="https://qiita.com/Robot-Inventor/items/56e2b7b69760d045fad3" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://qiita.com/Robot-Inventor/items/56e2b7b69760d045fad3" alt="【2020 年最新版】カスタマイズしたフォームから JavaScript で Google フォームに回答を送信"><span>【2020 年最新版】カスタマイズしたフォームから JavaScript で Google フォームに回答を送信</span></a></li>
<li><a href="https://valmore.work/auto-response-from-google-form/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://valmore.work/auto-response-from-google-form/" alt="【GAS】自動返信機能付き Google フォームの作り方"><span>【GAS】自動返信機能付き Google フォームの作り方</span></a></li></ul>
<div class="toc-container"><ul class="toc"><li><a href="#" onclick="document.querySelector('#js-id-介紹').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">介紹</a></li><li><a href="#" onclick="document.querySelector('#js-id-實作').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">實作</a></li><li><a href="#" onclick="document.querySelector('#js-id-參考文章').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">參考文章</a></li><li><a href="#" onclick="document.querySelector('#js-id-gas').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">GAS</a></li><li><a href="#" onclick="document.querySelector('#js-id-番外-客製化-google-form').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">undefined</a></li></ul></div>
    <span class="blink svelte-1kip24n">_</span></article>
  

<div class="back-to-top svelte-1p7rwza hidden" style="right: 2em">Back to top
</div>
</div></main>

  <footer scoped class="svelte-qi6xiu"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer noopener nofollow">CC BY-NC-SA 4.0
  </a>
  <div class="right svelte-qi6xiu">Made with <span class="heart svelte-qi6xiu">❤️</span> and
    <a href="https://kit.svelte.dev/" target="_blank" ref="noreferrer noopener nofollow">SvelteKit
    </a></div>
</footer>
</div>


		<script type="module" data-hydrate="ntndgr">
		import { start } from "/_app/start-5f4ccb98.js";
		start({
			target: document.querySelector('[data-hydrate="ntndgr"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-4c107a64.js"),
						import("/_app/pages/_slug_.svelte-14834c65.js")
				],
				params: {slug:"use-google-spreadsheet-as-database"},
				routeId: "[slug]"
			}
		});
	</script>
  </body>
</html>
