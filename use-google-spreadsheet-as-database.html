<!DOCTYPE html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta name="generator" content="Astro v3.3.0"><link rel="icon" href="/favicon.ico"><title>使用Google Sheet作為資料庫</title><!-- OGP --><meta property="og:url" content="https://f6bfb5.github.io/use-google-spreadsheet-as-database.html"><meta property="og:type" content="article"><meta property="og:title" content="使用Google Sheet作為資料庫"><meta property="og:description" content=""><meta property="og:image" content="https://f6bfb5.github.io/images/use-google-spreadsheet-as-database.png"><link rel="stylesheet" href="/_astro/_slug_.35185d57.css" />
<style>h1[data-astro-cid-gkspkard]{margin:.13em 0 .39em;font-size:3em;line-height:1.1;color:var(--title-color)}@media all and (max-width: 735px){h1[data-astro-cid-gkspkard]{max-width:80%;margin:auto;font-size:2.5em}}.title[data-astro-cid-gkspkard]{display:flex;flex-wrap:wrap;overflow:hidden;justify-content:center}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-8){animation:Title_red .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-7){animation:Title_orange .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-6){animation:Title_yellow .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-5){animation:Title_lime .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-4){animation:Title_green .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-3){animation:Title_cyan .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-2){animation:Title_blue .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-1){animation:Title_purple .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n){animation:Title_pink .5s linear both}@keyframes Title_red{0%{color:var(--bg-color);fill:transparent}50%{color:#e50020;fill:#e50020}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_orange{0%{color:var(--bg-color);fill:transparent}50%{color:#ec6c00;fill:#ec6c00}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_yellow{0%{color:var(--bg-color);fill:transparent}50%{color:#fbc600;fill:#fbc600}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_lime{0%{color:var(--bg-color);fill:transparent}50%{color:#6fba2c;fill:#6fba2c}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_green{0%{color:var(--bg-color);fill:transparent}50%{color:#008b38;fill:#008b38}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_cyan{0%{color:var(--bg-color);fill:transparent}50%{color:#009fe8;fill:#009fe8}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_blue{0%{color:var(--bg-color);fill:transparent}50%{color:#004da0;fill:#004da0}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_purple{0%{color:var(--bg-color);fill:transparent}50%{color:#910782;fill:#910782}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_pink{0%{color:var(--bg-color);fill:transparent}50%{color:#e40065;fill:#e40065}to{color:var(--title-color);fill:var(--title-color)}}article[data-astro-cid-5grsw2hi]{padding:10px;border:1px solid var(--subtitle-color);box-shadow:2px 2px 0 var(--subtext-color),4px 4px 0 var(--title-color);background-color:#e5edc8}
</style><script type="module">
</script>
<script type="module" src="/_astro/page.75c7f027.js"></script></head><html lang="zh-Hant-TW" data-astro-cid-37fxchfa><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta name="generator" content="Astro v3.3.0"><link rel="icon" href="/favicon.ico"></head><body data-astro-cid-37fxchfa><header data-astro-cid-pux6a34n><nav data-astro-cid-pux6a34n><a href="/" data-astro-cid-pux6a34n> トリコじかけの明け暮れ</a><a href="/rss.xml" target="_blank" data-astro-cid-pux6a34n> rss</a><a style="display: none;" href="/sitemap.xml" target="_blank" data-astro-cid-pux6a34n> sitemap</a></nav></header><main class="container" data-astro-cid-37fxchfa><article data-astro-cid-5grsw2hi><h1 class="title" data-astro-cid-gkspkard><span style="animation-delay:125ms;width:" data-astro-cid-gkspkard>使</span><span style="animation-delay:150ms;width:" data-astro-cid-gkspkard>用</span><span style="animation-delay:175ms;width:" data-astro-cid-gkspkard>G</span><span style="animation-delay:200ms;width:" data-astro-cid-gkspkard>o</span><span style="animation-delay:225ms;width:" data-astro-cid-gkspkard>o</span><span style="animation-delay:250ms;width:" data-astro-cid-gkspkard>g</span><span style="animation-delay:275ms;width:" data-astro-cid-gkspkard>l</span><span style="animation-delay:300ms;width:" data-astro-cid-gkspkard>e</span><span style="animation-delay:325ms;width:.25em;" data-astro-cid-gkspkard> </span><span style="animation-delay:350ms;width:" data-astro-cid-gkspkard>S</span><span style="animation-delay:375ms;width:" data-astro-cid-gkspkard>h</span><span style="animation-delay:400ms;width:" data-astro-cid-gkspkard>e</span><span style="animation-delay:425ms;width:" data-astro-cid-gkspkard>e</span><span style="animation-delay:450ms;width:" data-astro-cid-gkspkard>t</span><span style="animation-delay:475ms;width:" data-astro-cid-gkspkard>作</span><span style="animation-delay:500ms;width:" data-astro-cid-gkspkard>為</span><span style="animation-delay:525ms;width:" data-astro-cid-gkspkard>資</span><span style="animation-delay:550ms;width:" data-astro-cid-gkspkard>料</span><span style="animation-delay:575ms;width:" data-astro-cid-gkspkard>庫</span></h1><h2 id="介紹"><strong>介紹</strong></h2>
<ul>
<li>使用 Google 的 Sheet API 實現簡易資料庫處理</li>
<li>可將 Sheet 內容轉為 JSON 格式輸出</li>
<li>可從外部傳進資料，修改 Sheet 裡的內容</li>
<li>提供 CORS 支援，免於處理跨域的困擾</li>
</ul>
<h2 id="實作">實作</h2>
<h3 id="1-純讀取-spreadsheets-data-api">1. [純讀取] Spreadsheets Data API</h3>
<ul>
<li>發佈表單
<ul>
<li>「檔案（File）」</li>
<li>「發佈到網路（Publish to the web）」</li>
<li>選擇要發佈的 Sheet／發佈整份文件</li>
<li>點擊「發佈（Publish）」</li>
</ul>
</li>
<li>複製原始表單網址裡的 <code>[sheet-id]</code> 部份
<ul>
<li><code>https://docs.google.com/spreadsheets/d/[sheet-id]/</code></li>
<li>注意：不是發佈頁面的連結網址，是<strong>表單的網址</strong></li>
</ul>
</li>
<li>從 API 取得資料
<ul>
<li>將 <code>[sheet-id]</code> 貼至 Spreadsheets Data API 網址裡的對應處
<ul>
<li><code>https://spreadsheets.google.com/feeds/cells/[sheet-id]/[sheet-index]/public/values?alt=json</code></li>
<li><code>https://spreadsheets.google.com/feeds/list/[sheet-id]/[sheet-index]/public/values?alt=json</code></li>
<li>預設格式為 xml，在後面加上 <code>?alt=json</code> 改為取得 JSON 格式</li>
</ul>
</li>
<li><code>[sheet-index]</code> 可以指定要取得表單裡的哪個分頁
<ul>
<li>ex: <code>https://spreadsheets.google.com/feeds/cells/[sheet-id]/1/public/values?alt=json</code></li>
<li><code>od6</code> 似乎是 API 的預設值？</li>
</ul>
</li>
</ul>
</li>
<li>主要內容在 <code>feed.entry.content</code> 或 <code>feed.entry.gs$cell</code> 裡</li>
<li>資料結構：
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#F8F8F2">{</span></span>
<span class="line"><span style="color:#8BE9FE">  "</span><span style="color:#8BE9FD">version</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">1.0</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#8BE9FE">  "</span><span style="color:#8BE9FD">encoding</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">UTF-8</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#8BE9FE">  "</span><span style="color:#8BE9FD">feed</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#8BE9FE">    "</span><span style="color:#8BE9FD">xmlns</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">http://www.w3.org/2005/Atom</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#6272A4">   // ...</span></span>
<span class="line"><span style="color:#8BE9FE">   "</span><span style="color:#8BE9FD">title</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#8BE9FE">     "</span><span style="color:#8BE9FD">type</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">text</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#8BE9FE">     "</span><span style="color:#8BE9FD">$t</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">Sheet1</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#F8F8F2">   },</span></span>
<span class="line"><span style="color:#8BE9FE">   "</span><span style="color:#8BE9FD">link</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span><span style="color:#FF5555;font-style:italic;text-decoration:underline">...</span><span style="color:#F8F8F2">],</span></span>
<span class="line"><span style="color:#6272A4">   // ...</span></span>
<span class="line"><span style="color:#8BE9FE">   "</span><span style="color:#8BE9FD">entry</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> [</span></span>
<span class="line"><span style="color:#F8F8F2">     {</span></span>
<span class="line"><span style="color:#8BE9FE">       "</span><span style="color:#8BE9FD">id</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span><span style="color:#FF5555;font-style:italic;text-decoration:underline">...</span><span style="color:#F8F8F2">},</span></span>
<span class="line"><span style="color:#6272A4">       // ...</span></span>
<span class="line"><span style="color:#F8F8F2">     },</span></span>
<span class="line"><span style="color:#E9F284">     "</span><span style="color:#F1FA8C">content</span><span style="color:#E9F284">"</span><span style="color:#FF5555;font-style:italic;text-decoration:underline">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#8BE9FE">       "</span><span style="color:#8BE9FD">type</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">text</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#8BE9FE">       "</span><span style="color:#8BE9FD">$t</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">content</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#F8F8F2">     },</span></span>
<span class="line"><span style="color:#E9F284">     "</span><span style="color:#F1FA8C">link</span><span style="color:#E9F284">"</span><span style="color:#FF5555;font-style:italic;text-decoration:underline">:</span><span style="color:#F8F8F2"> [</span><span style="color:#FF5555;font-style:italic;text-decoration:underline">...</span><span style="color:#F8F8F2">],</span></span>
<span class="line"><span style="color:#E9F284">     "</span><span style="color:#F1FA8C">gs$cell</span><span style="color:#E9F284">"</span><span style="color:#FF5555;font-style:italic;text-decoration:underline">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#8BE9FE">       "</span><span style="color:#8BE9FD">row</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#8BE9FE">       "</span><span style="color:#8BE9FD">col</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#8BE9FE">       "</span><span style="color:#8BE9FD">$t</span><span style="color:#8BE9FE">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">content</span><span style="color:#E9F284">"</span></span>
<span class="line"><span style="color:#F8F8F2">     },</span></span>
<span class="line"><span style="color:#6272A4">     // ...</span></span>
<span class="line"><span style="color:#F8F8F2">   ]</span></span>
<span class="line"><span style="color:#F8F8F2"> }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
</li>
</ul>
<h3 id="2-可讀寫-google-apps-script">2. [可讀寫] Google Apps Script</h3>
<ul>
<li><strong>建立 GAS 檔案</strong>
<ul>
<li>「Extensions」</li>
<li>「指令碼編輯器（Script editor）」
<ul>
<li>現改為「Apps Script」</li>
</ul>
</li>
</ul>
</li>
<li><strong>撰寫 GAS</strong>
<ul>
<li>預設以 <code>doGet()</code> 處理 GET 要求</li>
<li>以 <code>doPost()</code> 處理 POST 要求</li>
<li>詳見下方範例</li>
</ul>
</li>
<li><strong>發佈 API</strong>
<ul>
<li>「Deploy」</li>
<li>「Select type」
<ul>
<li>「網路應用程式（web app）」</li>
</ul>
</li>
<li>「Description」
<ul>
<li>發佈註解</li>
</ul>
</li>
<li>「將應用程式執行為（Execute the app as）」
<ul>
<li><strong>「我（Me）」</strong></li>
</ul>
</li>
<li>「具有應用程式存取權的使用者（Who has access to the app）」
<ul>
<li><strong>「任何人，甚至匿名使用者（Anyone, even anonymous）」</strong></li>
</ul>
</li>
<li>「部署（Deploy）」
<ul>
<li>「核對權限（Authorize access）」</li>
<li>選擇授權用的 Google 帳號</li>
<li>「進階（Advanced）」</li>
<li>「前往 <code>此應用程式名稱</code>（Go to <code>[web app name]</code> (unsafe)）」</li>
<li>「允許（Allow）」</li>
</ul>
</li>
<li>「Web app」底下的「URL」即為讀取與寫入用的網址
<ul>
<li>之後也可以從「Deploy」→「Manage deployments」裡查詢</li>
</ul>
</li>
<li>開發時可善用「Test deployments」</li>
</ul>
</li>
<li><strong>若有更改程式</strong>
<ul>
<li>部署時「專案版本（Project version）」要選擇「新增（New）」</li>
<li>既有數字是之前發佈的版本，不會反應最新的修改內容</li>
<li><strong>改動後要選擇「新增」專案版本，才會有效反應</strong></li>
</ul>
</li>
<li><strong>表單資料格式</strong>
<ul>
<li>要注意 Google Sheet 預設會自動轉換各種資料
<ul>
<li>例如 <code>0123</code> 會被轉換成數值後，變成 <code>123</code></li>
</ul>
</li>
<li>推薦事先點選表單左上角格全選，將格式設為「純文字（Plain text）」</li>
<li>Google Sheet 的最大可儲存量為 1000 萬格資料
<ul>
<li>最大行數為 18278 行</li>
<li>一次可新增 40000 列</li>
<li>字串上限長度為 50000 字元</li>
<li>詳細限制可參考 <a href="https://support.google.com/drive/answer/37603">Google Drive Help</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<details>
  <summary>範例程式</summary>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#6272A4">// Sheet 網址裡 [sheet-id] 的部份</span></span>
<span class="line"><span style="color:#6272A4">// https://docs.google.com/spreadsheets/d/[sheet-id]/</span></span>
<span class="line"><span style="color:#6272A4">// </span></span>
<span class="line"><span style="color:#6272A4">//            col1 col2</span></span>
<span class="line"><span style="color:#6272A4">// row1 ---->  |    |</span></span>
<span class="line"><span style="color:#6272A4">// row2 ---->  |    |</span></span>
<span class="line"><span style="color:#6272A4">//             v    v</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> SpreadSheetID </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> ""</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> SpreadSheet </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> SpreadsheetApp.</span><span style="color:#50FA7B">openById</span><span style="color:#F8F8F2">(SpreadSheetID);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// simpilify output function</span></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">obj</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">mimeType</span><span style="color:#FF79C6"> =</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">JSON</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> ContentService.</span><span style="color:#50FA7B">createTextOutput</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">stringify</span><span style="color:#F8F8F2">(obj)).</span><span style="color:#50FA7B">setMimeType</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">    ContentService.MimeType[mimeType]</span></span>
<span class="line"><span style="color:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> getSheet</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> SpreadSheet.</span><span style="color:#50FA7B">getSheetByName</span><span style="color:#F8F8F2">(sheetName);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// ----------</span></span>
<span class="line"><span style="color:#6272A4">// doGet</span></span>
<span class="line"><span style="color:#6272A4">// ----------</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> getAllSheetData</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> Sheet </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> getSheet</span><span style="color:#F8F8F2">(sheetName);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // getSheetValues(startRow, startColumn, numRows, numColumns)</span></span>
<span class="line"><span style="color:#6272A4">  //</span></span>
<span class="line"><span style="color:#6272A4">  // the first row is category,</span></span>
<span class="line"><span style="color:#6272A4">  // so row starts from 2</span></span>
<span class="line"><span style="color:#6272A4">  //</span></span>
<span class="line"><span style="color:#6272A4">  // and if the first row is not needed,</span></span>
<span class="line"><span style="color:#6272A4">  // the result length would be full length -1</span></span>
<span class="line"><span style="color:#6272A4">  //</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getSheetValues</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#BD93F9">    2</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#BD93F9">    1</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    Sheet.</span><span style="color:#50FA7B">getLastRow</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">-</span><span style="color:#BD93F9"> 1</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">    Sheet.</span><span style="color:#50FA7B">getLastColumn</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">  );</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> getSheetDataByRange</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">range</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> Sheet </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> getSheet</span><span style="color:#F8F8F2">(sheetName);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // wouldn't return category row (the first row) by default</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> startRow </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> range.startRow </span><span style="color:#FF79C6">?</span><span style="color:#F8F8F2"> range.startRow </span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 2</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> startCol </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> range.startCol </span><span style="color:#FF79C6">?</span><span style="color:#F8F8F2"> range.startCol </span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> 1</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  let</span><span style="color:#F8F8F2"> rowRange </span><span style="color:#FF79C6">=</span></span>
<span class="line"><span style="color:#F8F8F2">    range.endRow </span><span style="color:#FF79C6">&#x26;&#x26;</span><span style="color:#F8F8F2"> range.startRow</span></span>
<span class="line"><span style="color:#FF79C6">      ?</span><span style="color:#F8F8F2"> range.endRow </span><span style="color:#FF79C6">-</span><span style="color:#F8F8F2"> range.startRow </span><span style="color:#FF79C6">+</span><span style="color:#BD93F9"> 1</span></span>
<span class="line"><span style="color:#FF79C6">      :</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastRow</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">-</span><span style="color:#BD93F9"> 1</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">  let</span><span style="color:#F8F8F2"> colRange </span><span style="color:#FF79C6">=</span></span>
<span class="line"><span style="color:#F8F8F2">    range.endCol </span><span style="color:#FF79C6">&#x26;&#x26;</span><span style="color:#F8F8F2"> range.startCol</span></span>
<span class="line"><span style="color:#FF79C6">      ?</span><span style="color:#F8F8F2"> range.endCol </span><span style="color:#FF79C6">-</span><span style="color:#F8F8F2"> range.startCol </span><span style="color:#FF79C6">+</span><span style="color:#BD93F9"> 1</span></span>
<span class="line"><span style="color:#FF79C6">      :</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastColumn</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (rowRange </span><span style="color:#FF79C6">></span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastRow</span><span style="color:#F8F8F2">()) rowRange </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastRow</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">-</span><span style="color:#BD93F9"> 1</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (colRange </span><span style="color:#FF79C6">></span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastColumn</span><span style="color:#F8F8F2">()) colRange </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastColumn</span><span style="color:#F8F8F2">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> data </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getSheetValues</span><span style="color:#F8F8F2">(startRow, startCol, rowRange, colRange);</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> data;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// columnsArray [2, 5]</span></span>
<span class="line"><span style="color:#6272A4">// would return</span></span>
<span class="line"><span style="color:#6272A4">//   {</span></span>
<span class="line"><span style="color:#6272A4">//     2: [ ['col2_cell1'], ['col2_cell2'], ['col2_cell3'] ],</span></span>
<span class="line"><span style="color:#6272A4">//     5: [ ['col5_cell1'], ['col5_cell2'], ['col5_cell3'] ]</span></span>
<span class="line"><span style="color:#6272A4">//   }</span></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> getSheetDataBySpecificColumns</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">columnsArray</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> Sheet </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> getSheet</span><span style="color:#F8F8F2">(sheetName);</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> data </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {};</span></span>
<span class="line"><span style="color:#F8F8F2">  columnsArray.</span><span style="color:#50FA7B">forEach</span><span style="color:#F8F8F2">((</span><span style="color:#FFB86C;font-style:italic">column</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">    // skip the first row</span></span>
<span class="line"><span style="color:#F8F8F2">    data[column] </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getSheetValues</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">, column, Sheet.</span><span style="color:#50FA7B">getLastRow</span><span style="color:#F8F8F2">(), </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">);</span></span>
<span class="line"><span style="color:#F8F8F2">  });</span></span>
<span class="line"><span style="color:#FF79C6">  return</span><span style="color:#F8F8F2"> data;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> doGet</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">e</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">  // accept object as parameter</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> params </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> e?.parameter;</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">params) {</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // you can customize what value to use for different execution</span></span>
<span class="line"><span style="color:#6272A4">  // and the object key name</span></span>
<span class="line"><span style="color:#6272A4">  // like params.exec or case "getAllData"</span></span>
<span class="line"><span style="color:#FF79C6">  switch</span><span style="color:#F8F8F2"> (params.action) {</span></span>
<span class="line"><span style="color:#FF79C6">    case</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">getAll</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">(</span><span style="color:#50FA7B">getAllSheetData</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">Sheet1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">));</span></span>
<span class="line"><span style="color:#FF79C6">      break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">    case</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">getSpecificColumns</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#6272A4">      // accept array-like input and parse it</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#50FA7B">        getSheetDataBySpecificColumns</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">Sheet1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">parse</span><span style="color:#F8F8F2">(params.columnsArray))</span></span>
<span class="line"><span style="color:#F8F8F2">      );</span></span>
<span class="line"><span style="color:#FF79C6">      break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">    default</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#FF79C6">      break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// ----------</span></span>
<span class="line"><span style="color:#6272A4">// doPost</span></span>
<span class="line"><span style="color:#6272A4">// ----------</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> appendSheetRow</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">newRowData</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> Sheet </span><span style="color:#FF79C6">=</span><span style="color:#50FA7B"> getSheet</span><span style="color:#F8F8F2">(sheetName);</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> newRow </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> Sheet.</span><span style="color:#50FA7B">getLastRow</span><span style="color:#F8F8F2">() </span><span style="color:#FF79C6">+</span><span style="color:#BD93F9"> 1</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#6272A4">  // accept numeric key as row-col index</span></span>
<span class="line"><span style="color:#6272A4">  // for example,</span></span>
<span class="line"><span style="color:#6272A4">  // data: { 1: "Cell 1 data", 2: "Cell 2 data", 3: "Cell 3 data" }</span></span>
<span class="line"><span style="color:#6272A4">  // would save to the row by the key</span></span>
<span class="line"><span style="color:#FF79C6">  for</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> [index, cellData] </span><span style="color:#FF79C6">of</span><span style="color:#F8F8F2"> Object.</span><span style="color:#50FA7B">entries</span><span style="color:#F8F8F2">(newRowData)) {</span></span>
<span class="line"><span style="color:#F8F8F2">    Sheet.</span><span style="color:#50FA7B">getRange</span><span style="color:#F8F8F2">(newRow, index).</span><span style="color:#50FA7B">setValue</span><span style="color:#F8F8F2">(cellData);</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> editSheetSpecificCell</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">row</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">col</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">value</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#50FA7B">  getSheet</span><span style="color:#F8F8F2">(sheetName).</span><span style="color:#50FA7B">getRange</span><span style="color:#F8F8F2">(row, col).</span><span style="color:#50FA7B">setValue</span><span style="color:#F8F8F2">(value);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> deleteSheetRow</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">sheetName</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">row</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#50FA7B">  getSheet</span><span style="color:#F8F8F2">(sheetName).</span><span style="color:#50FA7B">deleteRow</span><span style="color:#F8F8F2">(row);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> doPost</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">e</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">  // accept object as post data</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> postContents </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">parse</span><span style="color:#F8F8F2">(e?.postData.contents);</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">postContents) {</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">  // you can customize the key and value for different execution</span></span>
<span class="line"><span style="color:#FF79C6">  switch</span><span style="color:#F8F8F2"> (postContents.action) {</span></span>
<span class="line"><span style="color:#FF79C6">    case</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">appendRow</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#6272A4">      // again, you can also customize the key and value for post data</span></span>
<span class="line"><span style="color:#50FA7B">      appendSheetRow</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">Sheet1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">, postContents.data);</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#FF79C6">      break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">    case</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">editCell</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#50FA7B">      editSheetSpecificCell</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#E9F284">        "</span><span style="color:#F1FA8C">Sheet1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">        postContents.row,</span></span>
<span class="line"><span style="color:#F8F8F2">        postContents.col,</span></span>
<span class="line"><span style="color:#F8F8F2">        postContents.data</span></span>
<span class="line"><span style="color:#F8F8F2">      );</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#FF79C6">      break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">    case</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">deleteRow</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#50FA7B">      deleteSheetRow</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">Sheet1</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">, postContents.row);</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#FF79C6">    default</span><span style="color:#F8F8F2">:</span></span>
<span class="line"><span style="color:#FF79C6">      return</span><span style="color:#50FA7B"> textOutput</span><span style="color:#F8F8F2">({ response</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">200</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2"> });</span></span>
<span class="line"><span style="color:#FF79C6">      break</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">// ----------</span></span>
<span class="line"><span style="color:#6272A4">// onEdit</span></span>
<span class="line"><span style="color:#6272A4">// ----------</span></span>
<span class="line"><span style="color:#6272A4">// google apps script - onEdit trigger for specific sheets in a spreadsheet? - Stack Overflow</span></span>
<span class="line"><span style="color:#6272A4">// https://stackoverflow.com/questions/49465608/onedit-trigger-for-specific-sheets-in-a-spreadsheet</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> onEdit</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">e</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (</span><span style="color:#FF79C6">!</span><span style="color:#F8F8F2">e) {</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> editedSheetName </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> e.range.</span><span style="color:#50FA7B">getSheet</span><span style="color:#F8F8F2">().</span><span style="color:#50FA7B">getName</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (editedSheetName </span><span style="color:#FF79C6">!=</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">SomeSheetName</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#6272A4">    // some execution here</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
</details>
<h2 id="參考文章"><strong>參考文章</strong></h2>
<ul>
<li><a href="https://medium.com/unalai/%E5%AF%AB%E7%B5%A6%E7%B4%94%E5%89%8D%E7%AB%AF-%E8%AE%93-google-sheets-%E7%95%B6%E4%BD%A0%E7%9A%84%E5%BE%8C%E7%AB%AF%E5%AE%8C%E6%88%90%E5%AF%AB%E5%85%A5%E5%8A%9F%E8%83%BD-715799e5e013">寫給純前端，讓 Google Sheets 當你的後端完成寫入功能</a></li>
<li><a href="https://tutorials.webduino.io/zh-tw/docs/socket/useful/google-sheet-2.html">Google 試算表 (前後端實作)</a></li>
<li><a href="https://g0v.hackpad.tw/5Ofw64qSz7P#:h=Google-Spreadsheet">盤點各種線上協作資料(庫)方案 - g0v.hackpad.tw</a></li>
</ul>
<h2 id="gas"><strong>GAS</strong></h2>
<ul>
<li><a href="https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app">SpreadsheetApp</a></li>
<li><a href="https://developers.google.com/apps-script/reference/spreadsheet/sheet">Sheet</a></li>
<li><a href="https://developers.google.com/apps-script/guides/web">Web Apps</a></li>
<li>處理 GET
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> doGet</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">e</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> target </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> e.parameter.target;</span></span>
<span class="line"><span style="color:#50FA7B">  getHandler</span><span style="color:#F8F8F2">(target);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
</li>
<li>處理 POST
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> doPost</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">e</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> parameter </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">parse</span><span style="color:#F8F8F2">(e.postData.contents);</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> target </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> parameter.target;</span></span>
<span class="line"><span style="color:#50FA7B">  postHandler</span><span style="color:#F8F8F2">(target);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
</li>
<li>除了 <code>event.parameter</code> 之外，還有一個 <code>event.parameters</code>（多了 s）
<ul>
<li>兩者傳入的內容結構會不同，詳細可見 <a href="https://developers.google.com/apps-script/guides/web">Web Apps</a></li>
</ul>
</li>
<li>操作觸發處理
<ul>
<li><code>onEdit(event)</code>
<ul>
<li>想做進一步操作似乎會有權限問題…？</li>
</ul>
</li>
<li><code>Apps Script</code> 頁面左側的 <code>Triggers</code>
<ul>
<li>可以解決權限問題</li>
</ul>
</li>
<li><code>Apps Script</code> 頁面左側的 <code>Executions</code> 可查看腳本執行是否正常</li>
</ul>
</li>
<li>GAS 的回傳資料格式
<ul>
<li>字串：<code>return ContentService.createTextOutput("回傳字串");</code></li>
<li>HTML：<code>return HtmlService.createHtmlOutput(HTMLString);</code></li>
<li>JSON：
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> JSONString </span><span style="color:#FF79C6">=</span><span style="color:#BD93F9"> JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">stringify</span><span style="color:#F8F8F2">(result);</span></span>
<span class="line"><span style="color:#FF79C6">return</span><span style="color:#F8F8F2"> ContentService.</span><span style="color:#50FA7B">createTextOutput</span><span style="color:#F8F8F2">(JSONString).</span><span style="color:#50FA7B">setMimeType</span><span style="color:#F8F8F2">(</span></span>
<span class="line"><span style="color:#F8F8F2">  ContentService.MimeType.</span><span style="color:#BD93F9">JSON</span></span>
<span class="line"><span style="color:#F8F8F2">);</span></span></code></pre>
</li>
</ul>
</li>
<li>從 GAS 獲取資料
<ul>
<li>GET 請求</li>
<li>透過網址傳送參數</li>
<li>參數傳到 <code>e.parameter</code></li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> apiUrl </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> ""</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> action </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">getSpecificColumns</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> columnsArray </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> [</span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">2</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">3</span><span style="color:#F8F8F2">];</span></span>
<span class="line"><span style="color:#6272A4">// 若網址參數內有另外傳入結構式資料</span></span>
<span class="line"><span style="color:#6272A4">// 例如傳入陣列，須做 JSON.stringify()</span></span>
<span class="line"><span style="color:#6272A4">// GAS 處也要進行 JSON.parse() 處理</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> getParameter </span><span style="color:#FF79C6">=</span><span style="color:#F1FA8C"> `?action=</span><span style="color:#FF79C6">${</span><span style="color:#F8F8F2">action</span><span style="color:#FF79C6">}</span></span>
<span class="line"><span style="color:#F1FA8C">&#x26;columnsArray=</span><span style="color:#FF79C6">${</span><span style="color:#BD93F9">JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">stringify</span><span style="color:#F8F8F2">(columnsArray)</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C">`</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">await</span><span style="color:#50FA7B"> fetch</span><span style="color:#F8F8F2">(apiUrl </span><span style="color:#FF79C6">+</span><span style="color:#F8F8F2"> getParameter, {</span></span>
<span class="line"><span style="color:#F8F8F2">  method</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">GET</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">})</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">then</span><span style="color:#F8F8F2">((</span><span style="color:#FFB86C;font-style:italic">response</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#F8F8F2"> response.</span><span style="color:#50FA7B">json</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">  })</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">then</span><span style="color:#F8F8F2">((</span><span style="color:#FFB86C;font-style:italic">data</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6272A4">    // 處理取得資料</span></span>
<span class="line"><span style="color:#F8F8F2">    console.</span><span style="color:#50FA7B">log</span><span style="color:#F8F8F2">(data);</span></span>
<span class="line"><span style="color:#F8F8F2">  })</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">catch</span><span style="color:#F8F8F2">((</span><span style="color:#FFB86C;font-style:italic">error</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">=></span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">    console.</span><span style="color:#50FA7B">log</span><span style="color:#F8F8F2">(error);</span></span>
<span class="line"><span style="color:#F8F8F2">  });</span></span></code></pre>
</li>
<li>傳送資料至 GAS
<ul>
<li>POST 請求</li>
<li>透過請求傳送資料</li>
<li>資料傳到 <code>e.postData.contents</code></li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> apiUrl </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> ""</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> postData </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  action</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">appendRow</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  data</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#BD93F9">    1</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">some data to post</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">await</span><span style="color:#50FA7B"> fetch</span><span style="color:#F8F8F2">(apiUrl, {</span></span>
<span class="line"><span style="color:#F8F8F2">  method</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">POST</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  body</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> JSON</span><span style="color:#F8F8F2">.</span><span style="color:#50FA7B">stringify</span><span style="color:#F8F8F2">(postData),</span></span>
<span class="line"><span style="color:#F8F8F2">  headers</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#E9F284">    "</span><span style="color:#F1FA8C">content-type</span><span style="color:#E9F284">"</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">text/plain;charset=utf-8</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">  },</span></span>
<span class="line"><span style="color:#F8F8F2">  redirect</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">follow</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">});</span></span></code></pre>
</li>
<li>讀取表單
<ul>
<li>SpreadSheet
<ul>
<li><code>SpreadsheetApp.getActiveSpreadsheet()</code></li>
<li><code>SpreadsheetApp.openById(SpreadSheetID)</code></li>
</ul>
</li>
<li>Sheet
<ul>
<li><code>Spreadsheet#getSheetByName(sheetName)</code></li>
<li><code>Spreadsheet#getSheets()[sheetIndex]</code></li>
</ul>
</li>
<li>Range
<ul>
<li><code>Sheet#getRange(row, column)</code>
<ul>
<li>表單的行與列起始座標值是 <code>1</code>，不是 <code>0</code>，須注意</li>
</ul>
</li>
<li><code>Sheet#getRange(row, column, numRows)</code></li>
<li><code>Sheet#getRange(row, column, numRows, numColumns)</code></li>
<li><code>Sheet#getRange(cellRangeNotation)</code>
<ul>
<li>ex: <code>getRange("A1:B2")</code></li>
</ul>
</li>
<li><code>Range#getValues()</code>
<ul>
<li>ex. <code>const values = sheet.getRange("A1:C2").getValues();</code></li>
<li><code>const values = sheet.getRange("A1:C2").getValues().flat();</code></li>
</ul>
</li>
<li><code>Sheet#getSheetValues(startRow, startColumn, numRows, numColumns)</code>
<ul>
<li>表單的行與列起始座標值是 <code>1</code>，不是 <code>0</code>，須注意</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>寫入表單
<ul>
<li>Range
<ul>
<li><code>Range#setValues(values)</code></li>
<li>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> rowLength </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> array.length;</span></span>
<span class="line"><span style="color:#FF79C6">const</span><span style="color:#F8F8F2"> colLength </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> array[</span><span style="color:#BD93F9">0</span><span style="color:#F8F8F2">].length;</span></span>
<span class="line"><span style="color:#F8F8F2">sheet.</span><span style="color:#50FA7B">getRange</span><span style="color:#F8F8F2">(</span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, </span><span style="color:#BD93F9">1</span><span style="color:#F8F8F2">, rowLength, colLength).</span><span style="color:#50FA7B">setValues</span><span style="color:#F8F8F2">(array);</span></span></code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>建立觸發函式按鈕
<ul>
<li>Insert -> Drawing -> Shape 選擇任意圖案後輸入文字 -> Save and close</li>
<li>右鍵點擊圖案 -> 點擊圖案右上角的三點圖示 -> Assign script -> 輸入要綁定的函式名稱（不需參數括弧）</li>
</ul>
</li>
<li><a href="https://developers.google.com/apps-script/reference/utilities/utilities">Utilities</a>
<ul>
<li>Timestamp
<ul>
<li><code>Utilities.formatDate(new Date(), "Asia/Taipei", "顯示格式");</code></li>
<li>顯示格式
<ul>
<li><code>年：y</code></li>
<li><code>月：M</code></li>
<li><code>日：d</code></li>
<li><code>時（12 小時制）：h</code></li>
<li><code>時（24 小時制）：H</code></li>
<li><code>分：m</code></li>
<li><code>秒：s</code></li>
<li><code>'yyyy/MM/dd/HH:mm'</code> → <code>2020/12/31/23:59</code></li>
</ul>
</li>
</ul>
</li>
<li>Hash
<ul>
<li><code>var md5bin = Utilities.computeDigest(Utilities.DigestAlgorithm.MD5, text);</code></li>
<li><code>var md5 = Utilities.base64Encode(md5bin);</code></li>
</ul>
</li>
</ul>
</li>
<li>Use library
<ul>
<li>Libraries > 貼上 script id > 追加</li>
<li><a href="https://github.com/tani/cheeriogs">Cheeriogs</a></li>
</ul>
</li>
<li>Message Box
<ul>
<li><code>if (Browser.msgBox("確認", "是否要執行？", Browser.Buttons.YES_NO) != "yes")</code></li>
</ul>
</li>
</ul>
<h3 id="撰寫-discord-webhook">撰寫 Discord Webhook</h3>
<ul>
<li>建立 Discord 獲取 Webhook 用的網址
<ul>
<li>點擊 Discord 頻道右邊的齒輪鍵</li>
<li>點擊 <code>Integrations</code> -> <code>Create Webhook</code> -> <code>Copy Webhook URL</code></li>
</ul>
</li>
<li>撰寫 GAS 的通知函式
<ul>
<li><a href="https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app">UrlFetchApp</a>
<ul>
<li><code>UrlFetchApp.fetch(url[, params])</code></li>
</ul>
</li>
<li>params
<ul>
<li><code>contentType</code></li>
<li><code>headers</code></li>
<li><code>method</code></li>
<li><code>payload</code></li>
</ul>
</li>
<li>response
<ul>
<li><code>getContentText()</code></li>
<li><code>getHeaders()</code></li>
<li><code>getResponseCode()</code></li>
<li><code>getBlob()</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> sendToDiscord</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">message</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> url      </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> ''</span><span style="color:#F8F8F2">; </span><span style="color:#6272A4">// 上方建立的 Webhook 網址</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> token    </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> ''</span><span style="color:#F8F8F2">; </span><span style="color:#6272A4">// Webhook 網址後半的 token 部份</span></span>
<span class="line"><span style="color:#6272A4">                       // * 未確認是否已不需要</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> channel  </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">#general</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> text     </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> message;</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> username </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">bot</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> parse    </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">full</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> method   </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">POST</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> payload </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">token</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">     :</span><span style="color:#F8F8F2"> token,</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">channel</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">   :</span><span style="color:#F8F8F2"> channel,</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">content</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">   :</span><span style="color:#F8F8F2"> text,</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">username</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">  :</span><span style="color:#F8F8F2"> username,</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">parse</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">     :</span><span style="color:#F8F8F2"> parse,</span></span>
<span class="line"><span style="color:#F8F8F2">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">  const</span><span style="color:#F8F8F2"> params </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">method</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> method,</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">payload</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> payload,</span></span>
<span class="line"><span style="color:#E9F284">    '</span><span style="color:#F1FA8C">muteHttpExceptions</span><span style="color:#E9F284">'</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span></span>
<span class="line"><span style="color:#F8F8F2">  };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F8F8F2">  response </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> UrlFetchApp.</span><span style="color:#50FA7B">fetch</span><span style="color:#F8F8F2">(url, params);</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<h3 id="unit-test">Unit Test</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> assert</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">cond</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (cond </span><span style="color:#FF79C6">!==</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">) </span><span style="color:#FF79C6">throw</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">NG</span><span style="color:#E9F284">'</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> assertEquals</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">actual</span><span style="color:#F8F8F2">, </span><span style="color:#FFB86C;font-style:italic">expected</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  if</span><span style="color:#F8F8F2"> (actual </span><span style="color:#FF79C6">!==</span><span style="color:#F8F8F2"> expected) </span><span style="color:#FF79C6">throw</span><span style="color:#F1FA8C"> `NG: </span><span style="color:#FF79C6">${</span><span style="color:#F8F8F2">actual</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C"> !== </span><span style="color:#FF79C6">${</span><span style="color:#F8F8F2">expected</span><span style="color:#FF79C6">}</span><span style="color:#F1FA8C">`</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">function</span><span style="color:#50FA7B"> assertThrows</span><span style="color:#F8F8F2">(</span><span style="color:#FFB86C;font-style:italic">func</span><span style="color:#F8F8F2">) {</span></span>
<span class="line"><span style="color:#FF79C6">  try</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#50FA7B">    func</span><span style="color:#F8F8F2">();</span></span>
<span class="line"><span style="color:#F8F8F2">  } </span><span style="color:#FF79C6">catch</span><span style="color:#F8F8F2"> (e) {</span></span>
<span class="line"><span style="color:#F8F8F2">    Logger.</span><span style="color:#50FA7B">log</span><span style="color:#F8F8F2">(e);</span></span>
<span class="line"><span style="color:#FF79C6">    return</span><span style="color:#F8F8F2"> ;</span></span>
<span class="line"><span style="color:#F8F8F2">  }</span></span>
<span class="line"><span style="color:#FF79C6">  throw</span><span style="color:#E9F284"> '</span><span style="color:#F1FA8C">NG: No expection.</span><span style="color:#E9F284">'</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#F8F8F2">}</span></span></code></pre>
<h3 id="save-as-excel-file">Save as excel file</h3>
<pre class="astro-code dracula" style="background-color:#282A36;color:#F8F8F2; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color:#FF79C6">var</span><span style="color:#F8F8F2"> sheetID </span><span style="color:#FF79C6">=</span><span style="color:#E9F284"> ""</span><span style="color:#F8F8F2">;</span></span>
<span class="line"><span style="color:#FF79C6">var</span><span style="color:#F8F8F2"> fetchUrl </span><span style="color:#FF79C6">=</span></span>
<span class="line"><span style="color:#E9F284">  "</span><span style="color:#F1FA8C">https://docs.google.com/feeds/download/spreadsheets/Export?key=</span><span style="color:#E9F284">"</span><span style="color:#FF79C6"> +</span></span>
<span class="line"><span style="color:#F8F8F2">  sheetID </span><span style="color:#FF79C6">+</span></span>
<span class="line"><span style="color:#E9F284">  "</span><span style="color:#F1FA8C">&#x26;amp;exportFormat=xlsx</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6272A4">//OAuth</span></span>
<span class="line"><span style="color:#FF79C6">var</span><span style="color:#F8F8F2"> fetchOpt </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#F8F8F2">  headers</span><span style="color:#FF79C6">:</span><span style="color:#F8F8F2"> { Authorization</span><span style="color:#FF79C6">:</span><span style="color:#E9F284"> "</span><span style="color:#F1FA8C">Bearer </span><span style="color:#E9F284">"</span><span style="color:#FF79C6"> +</span><span style="color:#F8F8F2"> ScriptApp.</span><span style="color:#50FA7B">getOAuthToken</span><span style="color:#F8F8F2">() },</span></span>
<span class="line"><span style="color:#F8F8F2">  muteHttpExceptions</span><span style="color:#FF79C6">:</span><span style="color:#BD93F9"> true</span><span style="color:#F8F8F2">,</span></span>
<span class="line"><span style="color:#F8F8F2">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#FF79C6">var</span><span style="color:#F8F8F2"> xlsxFile </span><span style="color:#FF79C6">=</span><span style="color:#F8F8F2"> UrlFetchApp.</span><span style="color:#50FA7B">fetch</span><span style="color:#F8F8F2">(fetchUrl, fetchOpt)</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">getBlob</span><span style="color:#F8F8F2">()</span></span>
<span class="line"><span style="color:#F8F8F2">  .</span><span style="color:#50FA7B">setName</span><span style="color:#F8F8F2">(</span><span style="color:#E9F284">"</span><span style="color:#F1FA8C">filename.xlsx</span><span style="color:#E9F284">"</span><span style="color:#F8F8F2">);</span></span></code></pre>
<h3 id="參考文章-1">參考文章</h3>
<ul>
<li><a href="https://github.com/contributorpw/google-apps-script-awesome-list#parsing">google-apps-script-awesome-list</a></li>
<li><a href="https://qiita.com/matsu7089/items/6ea7931e97ae703f6607?utm_campaign=6922a8b5e9-Qiita_newsletter_419_07_15_2020&#x26;utm_term=0_e44feaa081-6922a8b5e9-34565689#%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-onget-%E3%82%92%E3%81%A4%E3%81%8F%E3%82%8B">【GAS x Vue.js】JavaScript のみで今、家計簿をつくるとしたら【ハンズオン付き！】</a></li>
<li><a href="https://qiita.com/hironobu-igawa/items/9b5c224d9bbe7b9843be">【初心者向け Tips】単純作業はもう嫌だ！GAS ツール作りの 4 つの技</a></li>
<li><a href="https://qiita.com/FUJIvillage/items/e22ad7efdf7fc898ffda">Google Apps Script（GAS）を利用した業務改善</a></li>
<li><a href="https://qiita.com/mitonattou919/items/de415bb9302a52d52e2e">Google Apps Script の割り当て値と制限値</a></li>
<li><a href="https://qiita.com/shikumiya_hata/items/5e11ff875a9dd050a722">GAS でライブラリを使う・作る方法</a></li>
<li><a href="https://qiita.com/TakeshiNickOsanai/items/62810b0e96bf37bd0eca">Google Apps Script + OAuth ライブラリで、freee API の操作を行う</a></li>
<li><a href="https://qiita.com/yamaguchi_yo/items/09bfc5c32faffa3beb62">法改正情報を早く確実にキャッチするために GAS で自動化するツールを作って運用してみた。</a></li>
<li><a href="https://qiita.com/cyoi0129/items/1cafb446dbe176e9366e">スクレイピングいろいろ</a></li>
<li><a href="https://qiita.com/tapatyo/items/465a982635ba3933b32d">【Google Apps Script】トリガーによる定期実行の時間のズレをなくす方法</a></li>
</ul>
<h2 id="google-charts"><strong>Google Charts</strong></h2>
<ul>
<li>QR Code
<ul>
<li><a href="https://developers.google.com/chart/infographics/docs/qr_codes">QR 圖碼</a></li>
<li>可以透過網址請求即時取得 QR Code 的圖片</li>
<li><code>https://chart.googleapis.com/chart?chs=450x450&#x26;cht=qr&#x26;chl=</code>[內容文字]</li>
<li>但此 API 已不再維護，隨時都可能無法再使用</li>
</ul>
</li>
</ul>
<h2 id="番外-客製化-google-form"><strong>[番外？] 客製化 Google Form</strong></h2>
<ul>
<li>使用 Google Form 製作好和需求相同形式的表單</li>
<li>點擊右上預覽表單</li>
<li>開啟開發者工具</li>
<li>尋找 <code>&#x3C;form></code> 標籤的 <code>action</code> 屬性中的傳送表單網址
<ul>
<li><code>action=[表單網址]</code></li>
<li><code>https://docs.google.com/forms/u/0/d/e/xxxxxxx/formResponse</code></li>
</ul>
</li>
<li>尋找所有提問的 id
<ul>
<li><code>name=[提問 ID]</code></li>
<li>通常為 <code>entry.xxxxxxx</code>，可使用此關鍵字快速搜尋</li>
</ul>
</li>
<li>另外撰寫表格網頁，將傳送行為綁定至自訂的傳送按鍵上</li>
</ul>
<h3 id="參考文章-2">參考文章</h3>
<ul>
<li><a href="https://qiita.com/inoue2002/items/78dac54dba93ea4a087a">独自フォームと Google フォームを連携してかっこよくスマートにアンケート回収する</a></li>
<li><a href="https://qiita.com/Robot-Inventor/items/56e2b7b69760d045fad3">【2020 年最新版】カスタマイズしたフォームから JavaScript で Google フォームに回答を送信</a></li>
<li><a href="https://valmore.work/auto-response-from-google-form/">【GAS】自動返信機能付き Google フォームの作り方</a></li>
<li><a href="https://zenn.dev/howdy39/articles/066bb145b8f247">GoogleフォームとGASを使って利便性高くセキュアな共有ドライブ運用を作る</a></li>
</ul></article></main><footer data-astro-cid-sz7xmlte><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-sz7xmlte>
CC BY-NC-SA 4.0
</a><div class="right" data-astro-cid-sz7xmlte>
Made with <span class="heart" data-astro-cid-sz7xmlte>❤️</span> and
<a href="https://astro.new/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-sz7xmlte>
Astro
</a></div></footer></body><script async src="https://www.googletagmanager.com/gtag/js?id=G-CRDP7WTXSQ"></script><script>
window.dataLayer = window.dataLayer || [];
function gtag() {
  dataLayer.push(arguments);
}
gtag("js", new Date());

gtag("config", "G-CRDP7WTXSQ");
</script></html>