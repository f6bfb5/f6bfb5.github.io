<!DOCTYPE html> <html lang=zh-Hant-TW> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <meta name=theme-color content=#333333> <base href=/ > <link href=https://fonts.googleapis.com rel=preconnect> <link href=https://fonts.gstatic.com rel=preconnect crossorigin> <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.png rel=icon type=image/png> <link href=client/client-b6ae9451.css rel=stylesheet><link href=client/[slug]-f40e8e13.css rel=stylesheet> <title>前端筆記 (8) 網頁測試</title><script async data-svelte=svelte-a2kvt3 src="https://www.googletagmanager.com/gtag/js?id=UA-114661136-2"></script><script async data-svelte=svelte-1op50db src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js data-ad-client=ca-pub-9613661448556355></script><link href=/favicon.ico rel="shortcut icon" data-svelte=svelte-oksmvs><link href=/favicon.ico rel=bookmark data-svelte=svelte-oksmvs><link href=https://f6bfb5.github.io/f2e-08-unit-test rel=canonical data-svelte=svelte-oowxqk><meta data-svelte=svelte-oowxqk content=https://f6bfb5.github.io/f2e-08-unit-test property=og:url><meta data-svelte=svelte-oowxqk content=article property=og:type><meta data-svelte=svelte-oowxqk content="前端筆記 (8) 網頁測試" property=og:title><meta data-svelte=svelte-oowxqk property=og:description><meta data-svelte=svelte-oowxqk name=Description><meta data-svelte=svelte-oowxqk content=https://f6bfb5.github.io/preview/f2e-08-unit-test.png property=og:image><meta data-svelte=svelte-oowxqk name=twitter:card content=summary_large_image><meta data-svelte=svelte-oowxqk name=twitter:title value="前端筆記 (8) 網頁測試"><meta data-svelte=svelte-oowxqk name=twitter:description><meta data-svelte=svelte-oowxqk name=twitter:label1 value="Published on"><meta data-svelte=svelte-oowxqk name=twitter:data1 value="Jul 18, 2019"> <link href=/client/client.b4cfb689.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-b6ae9451.css rel=preload as=style><link href=/client/[slug].a79b3a91.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-f40e8e13.css rel=preload as=style></head> <body> <div id=sapper> <div class="svelte-5s6wka layout"> <header class=svelte-1f9e1m7><nav class=svelte-t90z2a><a href=. class=svelte-t90z2a>トリコじかけの明け暮れ</a> <a href=about class=svelte-t90z2a>about</a> <a href=rss.xml class=svelte-t90z2a>rss</a> </nav> <a href=/ class=svelte-kw2jbs> <img alt=logo src=data:image/gif;base64,AAABAAEAEBAQAAAAAAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAABbl4Awr28AAAAAAC4pp4ACgUAAFomhAB4aGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiIiQiQiIkREREREJCIiQRERERESIiJBEhEREREiIkFCQRFRESIiQRIRERFRIiJBEREREREiIkE2ZmZmESQiQWYAAAZhJCJBZgAABmEkIkFmAAAGYSQiQWYAAAZhRCJBZgAABmFEIkE2ZmZmMUQiQRERERERRCJERERERERCLABwAAgAMAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAwAA style=width:36px;height:42px> </a> </header> <main class=svelte-5s6wka> <header class=svelte-cvs7ll> <h1 class="svelte-cvs7ll title"><span class=svelte-cvs7ll style=animation-delay:125ms>前</span><span class=svelte-cvs7ll style=animation-delay:150ms>端</span><span class=svelte-cvs7ll style=animation-delay:175ms>筆</span><span class=svelte-cvs7ll style=animation-delay:.2s>記</span><span class=svelte-cvs7ll style=animation-delay:225ms;width:.25em> </span><span class=svelte-cvs7ll style=animation-delay:250ms>(</span><span class=svelte-cvs7ll style=animation-delay:275ms>8</span><span class=svelte-cvs7ll style=animation-delay:.3s>)</span><span class=svelte-cvs7ll style=animation-delay:325ms;width:.25em> </span><span class=svelte-cvs7ll style=animation-delay:350ms>網</span><span class=svelte-cvs7ll style=animation-delay:375ms>頁</span><span class=svelte-cvs7ll style=animation-delay:.4s>測</span><span class=svelte-cvs7ll style=animation-delay:425ms>試</span></h1> <p class=svelte-cvs7ll>July 18, 2019 <small class=svelte-cvs7ll>4 min read</small></header> <div class="svelte-cvs7ll container"><article class=content><ul> <li><a href=https://medium.com/yusong-blog/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%AB%E5%9C%A8github%E4%B8%8A%E6%8C%81%E7%BA%8C%E6%95%B4%E5%90%88%E8%88%87%E9%83%A8%E7%BD%B2-ci-cd-9735f622ae68 target=_blank rel=nofollow>前端工程師在 GitHub 上持續整合與部署(CI/CD)</a></li> <li><a href=https://qiita.com/Daara_y/items/4f006ead604e015186dc target=_blank rel=nofollow>Chrome の拡張機能を 2 つ使うだけでブラウザの操作を自動化！？</a></li> <li><a href=https://qiita.com/nezuq/items/c5e827e1827e7cb29011 target=_blank rel=nofollow>Web スクレイピングの注意事項一覧</a></li> <li><a href=https://qiita.com/Azunyan1111/items/b161b998790b1db2ff7a target=_blank rel=nofollow>Python Web スクレイピング テクニック集「取得できない値は無い」JavaScript 対応</a></li> <li><a href=https://hackmd.io/Jsn8miqHQdWUUdqgrIc9Cg target=_blank rel=nofollow>六角學院線上分享單元測試 QA 區</a></li> <li><a href=https://github.com/ms314006/step-by-step-unit-testing target=_blank rel=nofollow>step-by-step-unit-testing</a></li> <li><a href=https://speakerdeck.com/nihonbuson/scrum-fest-osaka-2021 target=_blank rel=nofollow>テストコードを書き始める前に考えるべきテストの話（2021 年版）</a></li> <li><a href=https://blog.yyisyou.tw/c91309fe/ target=_blank rel=nofollow>如何在前端導入單元測試</a></li> <li><a href=https://jaceju.net/to-test-the-detail-or-to-test-the-result/ target=_blank rel=nofollow>測試該驗證結果還是該驗證細節</a></li> <li><a href=https://blog.cybai.dev/intro-pbt/ target=_blank rel=nofollow>小朋友才『寫』測試，成熟的大人都 Property-Based Testing | λ. Thoughts -> Text</a></li> <li><a href=https://zenn.dev/mizchi/articles/my-test-policy target=_blank rel=nofollow>(自分の) JavaScript のユニットテストの書き方</a></li> </ul> <h2 id=1-selenium>1. <a href=https://selenium.dev/ target=_blank rel=nofollow>Selenium</a></h2> <h2 id=2-jest>2. <a href=https://jestjs.io/ target=_blank rel=nofollow>Jest</a></h2> <h3 id=安裝>安裝</h3> <p><code>npm install --save-dev jest</code> <code>yarn add puppeteer jest</code></p> <h3 id=使用>使用</h3> <h4 id=撰寫>撰寫</h4> <p><code>util.test.js</code></p> <ul> <li><code>test()</code> 是 Jest 提供的 function，第一個參數為文字敘述，第二個參數則是傳入一個 function</li> <li><code>expect()</code> 是傳入要接受測試的函式</li> <li><code>toBe()</code> 是預期得到的結果</li> </ul> <h4 id=執行>執行</h4> <p><code>npm run jest</code>: 測試所有的測試檔案 <code>npm run jest [檔案]</code>: 測試指定檔案</p> <h3 id=參考>參考</h3> <ul> <li><a href=https://wcc723.github.io/development/2020/02/02/jest-intro/ target=_blank rel=nofollow>十分鐘上手前端單元測試 - 使用 Jest</a></li> <li><a href=https://medium.com/enjoy-life-enjoy-coding/%E8%AE%93-jest-%E7%82%BA%E4%BD%A0%E7%9A%84-code-%E5%81%9A%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6-%E5%9F%BA%E7%A4%8E%E7%94%A8%E6%B3%95%E6%95%99%E5%AD%B8-d898f11d9a23 target=_blank rel=nofollow>讓 Jest 為你的 Code 做測試-基礎用法教學</a></li> </ul> <h2 id=3-cypress>3. <a href=https://www.cypress.io/ target=_blank rel=nofollow>Cypress</a></h2> <h2 id=4-storybook>4. <a href=https://storybook.js.org/ target=_blank rel=nofollow>Storybook</a></h2> <h2 id=5-nightwatch>5. <a href=https://nightwatchjs.org/ target=_blank rel=nofollow>Nightwatch</a></h2> <h2 id=6-puppeteer>6. <a href=https://github.com/puppeteer/puppeteer target=_blank rel=nofollow>Puppeteer</a></h2> <h3 id=簡介>簡介</h3> <p>Puppter 是由 Google Chrome 官方團隊所推出的無界面（Headless）Chrome 工具，是一套 Node 的 Library，提供 API 讓使用者可以透過 DevTools Protocol 控制無介面的 Chrome，亦可透過調整參數使用完整版的 Chrome。</p> <p>常見用途：</p> <ul> <li>產生網頁頁面的截圖或 PDF 檔</li> <li>抓取 Single Page Application 產生預覽內容 (Server-Side Rendering)</li> <li>從網站上抓取想要的內容</li> <li>自動送出表單、測試 UI、控制輸入</li> <li>建構自動化測試環境</li> </ul> <h3 id=安裝-1>安裝</h3> <pre class=language-bash><code class=language-bash>npm i puppeteer
# or use yarn
yarn add puppeteer</code></pre><h3 id=使用-1>使用</h3> <p>使用方式相當簡單，安裝完 puppeteer 的套件之後，將相關的程式碼寫進一支 js 檔案裡，並直接使用 Node.js 執行便可使用：<code>node example.js</code></p> <h4 id=基礎使用>基礎使用</h4> <pre class=language-js><code class=language-js><span class="token comment">// 引入 puppeteer</span>
<span class="token keyword">const</span> puppeteer <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'puppeteer'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">''</span>

<span class="token punctuation">(</span><span class="token keyword">async</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token comment">// 啟動 puppeteer</span>
  <span class="token keyword">const</span> browser <span class="token operator">=</span> <span class="token keyword">await</span><span class="token punctuation">.</span>puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 使用背景模式執行</span>
    <span class="token literal-property property">headless</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 開啟新分頁</span>
  <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 前往頁面</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// action here...</span>

  <span class="token comment">// 關閉 puppeteer</span>
  <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 也可以使用 then 撰寫</span>
puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">headless</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token parameter">browser</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> page <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// action here...</span>
  <span class="token keyword">await</span> browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre><p><code>launch</code> 裡面可以使用諸多參數，調整瀏覽器的細部運作設定，例如：</p> <ul> <li><code>headless: [boolean]</code>：是否以背景模式執行瀏覽器</li> <li><code>useDataDir: [string]</code>：儲存使用者的相關資料</li> <li><code>slowMo: [number]</code>：設定每個操作的延遲毫秒數</li> <li><code>args: [array[string]]</code>：設定傳入給瀏覽器的相關參數</li> <li><code>timeout: [number]</code>：等待瀏覽器啟動的時間長度</li> <li><code>devtools: [boolean]</code>：啟動後是否開啟開發者工具列，啟用此選項時 <code>headless</code> 必須為 <code>true</code></li> </ul> <h4 id=獲取節點>獲取節點</h4> <p>網頁最常見的操作是，我們會專注於某個節點上，例如一個連結、按鈕，或是一個文字輸入框、一段文字內容，在 puppeteer 裡，我們可以透過類似 jQuery 的寫法來取得網頁節點。</p> <pre class=language-javascript><code class=language-javascript><span class="token comment">// 取得 DOM</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".listItem ul li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 取得 DOM 裡的值</span>
<span class="token keyword">const</span> target <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".listItem ul li"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> targetText <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">evaluate</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token parameter">_target</span><span class="token punctuation">)</span> <span class="token operator">=></span> _target<span class="token punctuation">.</span>textContent<span class="token punctuation">,</span>
  target
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等同於</span>
<span class="token keyword">const</span> targetText <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$eval</span><span class="token punctuation">(</span><span class="token string">".listItem ul li"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=></span> el<span class="token punctuation">.</span>textContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 也可以取得 DOM 的其它屬性，例如 HTML 內容，或是連結網址</span>
<span class="token keyword">const</span> targetText <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$eval</span><span class="token punctuation">(</span><span class="token string">".listItem ul li"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=></span> el<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> href <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$eval</span><span class="token punctuation">(</span><span class="token string">".btn-download"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=></span> el<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 取得所有節點</span>
<span class="token keyword">const</span> targets <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$$</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 同樣可以結合 evaluate 使用，但傳入的是 DOM 陣列，需要再做一次迭代處理</span>
<span class="token keyword">const</span> targets <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$$eval</span><span class="token punctuation">(</span><span class="token string">"a"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">els</span><span class="token punctuation">)</span> <span class="token operator">=></span> els<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token operator">=></span> el<span class="token punctuation">.</span>innerHTML<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id=操作節點>操作節點</h4> <p>在拿到節點之後，我們就可以進行相應操作，例如點擊按鈕、輸入文字，或是取得節點內容、下載檔案、截圖等等。</p> <pre class=language-javascript><code class=language-javascript><span class="token comment">// 輸入內容</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token string">"#email"</span><span class="token punctuation">,</span> <span class="token string">"example@example.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 點擊元素</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token string">"#loginButton"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> agreeButton <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".btn-input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> agreeButton<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">clickCount</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">delay</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 截圖頁面</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"screenshot.png"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 截圖指定元素</span>
<span class="token keyword">const</span> element <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"h1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> element<span class="token punctuation">.</span><span class="token function">screenshot</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">"screenshot_h1.png"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id=等待頁面>等待頁面</h4> <p>由於網頁操作常會出現非同步的狀況，例如點擊同意使用規約之後，網頁會自行跳轉，puppeteer 有一系列與等待相關的 function：</p> <ul> <li><code>page.waitFor(selector/function/timeout[, options[, args]])</code>：等待 selector 出現／function 執行完畢／時間過後，才執行後面動作</li> <li><code>page.waitForNavigation(options)</code>：等待頁面跳轉完，才執行後面動作，通常會用於點擊連結或同意使用者規約等等頁面會發生跳轉的行為之後</li> <li><code>page.waitForSelector(selector[, options])</code>：等待至元素出現，才執行後面動作</li> <li><code>page.waitForRequest(url/predicate, options)</code>：等待 request 處理完畢</li> <li><code>page.waitForResponse(url/predicate, options)</code>：等待獲得 response</li> </ul> <pre class=language-javascript><code class=language-javascript><span class="token comment">// 點擊同意按鈕</span>
<span class="token keyword">const</span> agreeButton <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".btn-input"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> agreeButton<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">clickCount</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">delay</span><span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 點擊後網頁會自動跳頁，因此等待至跳轉完畢，再進行後續處理</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">waitForNavigation</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">waitUntil</span><span class="token operator">:</span> <span class="token string">"networkidle0"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// some other execution...</span></code></pre><h4 id=使用-cookie-登入>使用 cookie 登入</h4> <pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 從本地端讀取 oookie 檔案</span>
<span class="token keyword">const</span> cookies <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">"./cookies.json"</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">setCookie</span><span class="token punctuation">(</span><span class="token operator">...</span>cookies<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id=儲存檔案>儲存檔案</h4> <p>puppeteer 裡只有提供截圖功能，並沒有下載檔案的 function（之前似乎有個 <code>page.setDownloadBehavior</code> 或 <code>browser.setDownloadBehavior</code>？），想要下載檔案的話，需要再搭配 <code>fs</code>，以及 <code>$eval</code> 使用。</p> <pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 取得檔案連結</span>
<span class="token keyword">const</span> href <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">$eval</span><span class="token punctuation">(</span><span class="token string">".btn-download"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">anchor</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  anchor<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"href"</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 取得檔案名稱</span>
<span class="token keyword">const</span> split <span class="token operator">=</span> href<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> filename <span class="token operator">=</span> split<span class="token punctuation">[</span>split<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 取得檔案資料</span>
<span class="token keyword">let</span> bufferData <span class="token operator">=</span> <span class="token keyword">await</span> page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span>href<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 使用 fs 下載檔案</span>
fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>
  <span class="token string">"./download/"</span> <span class="token operator">+</span> filename<span class="token punctuation">,</span>
  <span class="token keyword">await</span> bufferData<span class="token punctuation">.</span><span class="token function">buffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"File saved!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id=參考-1>參考</h3> <ul> <li><a href=https://zhaoqize.github.io/puppeteer-api-zh_CN/#/ target=_blank rel=nofollow>Puppeteer v2.1.1 API</a></li> <li><a href=https://techblog.gmo-ap.jp/2018/12/28/puppeteer%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8%E3%81%BE%E3%81%A8%E3%82%81/ target=_blank rel=nofollow>Puppeteer でできることまとめ</a></li> <li><a href=https://qiita.com/KawamotoShuji/items/878ae659a5c6e540343e target=_blank rel=nofollow>うるるを Puppeteer でスクレイピングしてみた</a></li> <li><a href=https://qiita.com/go_sagawa/items/85f97deab7ccfdce53ea target=_blank rel=nofollow>puppeteer での要素の取得方法</a></li> <li><a href=https://github.com/chenxiaochun/blog/issues/38 target=_blank rel=nofollow>Puppeteer：模拟浏览器操作行为的利器</a></li> <li><a href=https://blog.techbridge.cc/2019/07/13/medium-crawler/ target=_blank rel=nofollow>Medium 爬蟲進化史</a></li> <li><a href=https://blog.typeart.cc/using-puppeteer-crawler-common-skills/ target=_blank rel=nofollow>Puppeteer 爬蟲常用技巧</a></li> <li><a href=https://github.com/puppeteer/puppeteer/blob/main/examples/block-images.js target=_blank rel=nofollow>puppeteer/block-images.js</a></li> <li><a href=https://github.com/puppeteer/puppeteer/blob/main/docs/api.md#pagesetrequestinterceptionvalue target=_blank rel=nofollow>puppeteer/api.md</a></li> </ul> <h2 id=文章>文章</h2> <ul> <li><a href=https://www.ptt.cc/bbs/Soft_Job/M.1332567899.A.C00.html target=_blank rel=nofollow>[閒聊] 笑談軟體測試的幾個階段（一）</a></li> <li><a href=https://www.ptt.cc/bbs/Soft_Job/M.1332601969.A.342.html target=_blank rel=nofollow>[閒聊] 笑談軟體測試的幾個階段（二）</a></li> <li><a href=https://www.ptt.cc/bbs/Soft_Job/M.1332681709.A.EB4.html target=_blank rel=nofollow>[閒聊] 笑談軟體測試的幾個階段（三）</a></li> <li><a href=https://www.ptt.cc/bbs/Soft_Job/M.1332697283.A.630.html target=_blank rel=nofollow>[閒聊] 笑談軟體測試的幾個階段（四）</a></li> <li><a href=https://www.ptt.cc/bbs/Soft_Job/M.1332863702.A.076.html target=_blank rel=nofollow>[閒聊] 笑談軟體測試的幾個階段（五） 測試權重</a></li> <li><a href=https://www.ptt.cc/bbs/Soft_Job/M.1597938487.A.566.html target=_blank rel=nofollow>[心得] 笑談軟體測試的幾個階段（六） 歷史代碼</a></li> </ul> </article> <div class="back-to-top hidden svelte-142cfra" style=right:2em>Back to top </div> </div></main> <footer class=svelte-1nz5bf0><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="noreferrer noopener nofollow">CC BY-SA 4.0.</a> <div class="svelte-1nz5bf0 right">Made with <span class="svelte-1nz5bf0 heart">❤️</span> and <a href=https://github.com/Charca/sapper-blog-template target=_blank ref="noreferrer noopener nofollow">Sapper</a></div> <div class="svelte-1nz5bf0 clearfix"></div> </footer> <a href=https://www.nicovideo.jp/watch/sm5667565 target=_blank rel="noreferrer noopener"><img alt=easter_egg src=_c_choju56_0008_s512_choju56_0008_1.png class="easter-egg svelte-72qmgd"> </a> </div></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{post:{title:"前端筆記 (8) 網頁測試",slug:"f2e-08-unit-test",html:"\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fmedium.com\u002Fyusong-blog\u002F%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%AB%E5%9C%A8github%E4%B8%8A%E6%8C%81%E7%BA%8C%E6%95%B4%E5%90%88%E8%88%87%E9%83%A8%E7%BD%B2-ci-cd-9735f622ae68\"\u003E前端工程師在 GitHub 上持續整合與部署(CI\u002FCD)\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002FDaara_y\u002Fitems\u002F4f006ead604e015186dc\"\u003EChrome の拡張機能を 2 つ使うだけでブラウザの操作を自動化！？\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fnezuq\u002Fitems\u002Fc5e827e1827e7cb29011\"\u003EWeb スクレイピングの注意事項一覧\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002FAzunyan1111\u002Fitems\u002Fb161b998790b1db2ff7a\"\u003EPython Web スクレイピング テクニック集「取得できない値は無い」JavaScript 対応\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fhackmd.io\u002FJsn8miqHQdWUUdqgrIc9Cg\"\u003E六角學院線上分享單元測試 QA 區\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Fms314006\u002Fstep-by-step-unit-testing\"\u003Estep-by-step-unit-testing\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fspeakerdeck.com\u002Fnihonbuson\u002Fscrum-fest-osaka-2021\"\u003Eテストコードを書き始める前に考えるべきテストの話（2021 年版）\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fblog.yyisyou.tw\u002Fc91309fe\u002F\"\u003E如何在前端導入單元測試\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fjaceju.net\u002Fto-test-the-detail-or-to-test-the-result\u002F\"\u003E測試該驗證結果還是該驗證細節\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fblog.cybai.dev\u002Fintro-pbt\u002F\"\u003E小朋友才『寫』測試，成熟的大人都 Property-Based Testing | λ. Thoughts -&gt; Text\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fzenn.dev\u002Fmizchi\u002Farticles\u002Fmy-test-policy\"\u003E(自分の) JavaScript のユニットテストの書き方\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"1-selenium\"\u003E1. \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fselenium.dev\u002F\"\u003ESelenium\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Ch2 id=\"2-jest\"\u003E2. \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fjestjs.io\u002F\"\u003EJest\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Ch3 id=\"安裝\"\u003E安裝\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Ccode\u003Enpm install --save-dev jest\u003C\u002Fcode\u003E\n\u003Ccode\u003Eyarn add puppeteer jest\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Ch3 id=\"使用\"\u003E使用\u003C\u002Fh3\u003E\n\u003Ch4 id=\"撰寫\"\u003E撰寫\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Ccode\u003Eutil.test.js\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Etest()\u003C\u002Fcode\u003E 是 Jest 提供的 function，第一個參數為文字敘述，第二個參數則是傳入一個 function\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eexpect()\u003C\u002Fcode\u003E 是傳入要接受測試的函式\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003EtoBe()\u003C\u002Fcode\u003E 是預期得到的結果\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 id=\"執行\"\u003E執行\u003C\u002Fh4\u003E\n\u003Cp\u003E\u003Ccode\u003Enpm run jest\u003C\u002Fcode\u003E: 測試所有的測試檔案\n\u003Ccode\u003Enpm run jest [檔案]\u003C\u002Fcode\u003E: 測試指定檔案\u003C\u002Fp\u003E\n\u003Ch3 id=\"參考\"\u003E參考\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwcc723.github.io\u002Fdevelopment\u002F2020\u002F02\u002F02\u002Fjest-intro\u002F\"\u003E十分鐘上手前端單元測試 - 使用 Jest\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fmedium.com\u002Fenjoy-life-enjoy-coding\u002F%E8%AE%93-jest-%E7%82%BA%E4%BD%A0%E7%9A%84-code-%E5%81%9A%E5%96%AE%E5%85%83%E6%B8%AC%E8%A9%A6-%E5%9F%BA%E7%A4%8E%E7%94%A8%E6%B3%95%E6%95%99%E5%AD%B8-d898f11d9a23\"\u003E讓 Jest 為你的 Code 做測試-基礎用法教學\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"3-cypress\"\u003E3. \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.cypress.io\u002F\"\u003ECypress\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Ch2 id=\"4-storybook\"\u003E4. \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fstorybook.js.org\u002F\"\u003EStorybook\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Ch2 id=\"5-nightwatch\"\u003E5. \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fnightwatchjs.org\u002F\"\u003ENightwatch\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Ch2 id=\"6-puppeteer\"\u003E6. \u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Fpuppeteer\u002Fpuppeteer\"\u003EPuppeteer\u003C\u002Fa\u003E\u003C\u002Fh2\u003E\n\u003Ch3 id=\"簡介\"\u003E簡介\u003C\u002Fh3\u003E\n\u003Cp\u003EPuppter 是由 Google Chrome 官方團隊所推出的無界面（Headless）Chrome 工具，是一套 Node 的 Library，提供 API 讓使用者可以透過 DevTools Protocol 控制無介面的 Chrome，亦可透過調整參數使用完整版的 Chrome。\u003C\u002Fp\u003E\n\u003Cp\u003E常見用途：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E產生網頁頁面的截圖或 PDF 檔\u003C\u002Fli\u003E\n\u003Cli\u003E抓取 Single Page Application 產生預覽內容 (Server-Side Rendering)\u003C\u002Fli\u003E\n\u003Cli\u003E從網站上抓取想要的內容\u003C\u002Fli\u003E\n\u003Cli\u003E自動送出表單、測試 UI、控制輸入\u003C\u002Fli\u003E\n\u003Cli\u003E建構自動化測試環境\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"安裝-1\"\u003E安裝\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-bash\"\u003E\u003Ccode class=\"language-bash\"\u003Enpm i puppeteer\n# or use yarn\nyarn add puppeteer\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"使用-1\"\u003E使用\u003C\u002Fh3\u003E\n\u003Cp\u003E使用方式相當簡單，安裝完 puppeteer 的套件之後，將相關的程式碼寫進一支 js 檔案裡，並直接使用 Node.js 執行便可使用：\u003Ccode\u003Enode example.js\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Ch4 id=\"基礎使用\"\u003E基礎使用\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-js\"\u003E\u003Ccode class=\"language-js\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F 引入 puppeteer\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E puppeteer \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'puppeteer'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E url \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E''\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F 啟動 puppeteer\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E browser \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Epuppeteer\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Elaunch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E\u002F\u002F 使用背景模式執行\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token literal-property property\"\u003Eheadless\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F 開啟新分頁\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E page \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E browser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EnewPage\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F 前往頁面\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Egoto\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eurl\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F action here...\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F 關閉 puppeteer\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E browser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eclose\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 也可以使用 then 撰寫\u003C\u002Fspan\u003E\npuppeteer\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Elaunch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003Eheadless\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Efalse\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ethen\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Easync\u003C\u002Fspan\u003E \u003Cspan class=\"token parameter\"\u003Ebrowser\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E page \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E browser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EnewPage\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Egoto\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eurl\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F action here...\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E browser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eclose\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ccode\u003Elaunch\u003C\u002Fcode\u003E 裡面可以使用諸多參數，調整瀏覽器的細部運作設定，例如：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Eheadless: [boolean]\u003C\u002Fcode\u003E：是否以背景模式執行瀏覽器\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003EuseDataDir: [string]\u003C\u002Fcode\u003E：儲存使用者的相關資料\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003EslowMo: [number]\u003C\u002Fcode\u003E：設定每個操作的延遲毫秒數\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Eargs: [array[string]]\u003C\u002Fcode\u003E：設定傳入給瀏覽器的相關參數\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Etimeout: [number]\u003C\u002Fcode\u003E：等待瀏覽器啟動的時間長度\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Edevtools: [boolean]\u003C\u002Fcode\u003E：啟動後是否開啟開發者工具列，啟用此選項時 \u003Ccode\u003Eheadless\u003C\u002Fcode\u003E 必須為 \u003Ccode\u003Etrue\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 id=\"獲取節點\"\u003E獲取節點\u003C\u002Fh4\u003E\n\u003Cp\u003E網頁最常見的操作是，我們會專注於某個節點上，例如一個連結、按鈕，或是一個文字輸入框、一段文字內容，在 puppeteer 裡，我們可以透過類似 jQuery 的寫法來取得網頁節點。\u003C\u002Fp\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F 取得 DOM\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".listItem ul li\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 取得 DOM 裡的值\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E target \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".listItem ul li\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E targetText \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eevaluate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003E_target\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E _target\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EtextContent\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  target\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 等同於\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E targetText \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$eval\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".listItem ul li\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E el\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EtextContent\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 也可以取得 DOM 的其它屬性，例如 HTML 內容，或是連結網址\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E targetText \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$eval\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".listItem ul li\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E el\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EinnerHTML\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E href \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$eval\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".btn-download\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E el\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetAttribute\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"href\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 取得所有節點\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E targets \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 同樣可以結合 evaluate 使用，但傳入的是 DOM 陣列，需要再做一次迭代處理\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E targets \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$$eval\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"a\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eels\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E els\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Emap\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E el\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EinnerHTML\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"操作節點\"\u003E操作節點\u003C\u002Fh4\u003E\n\u003Cp\u003E在拿到節點之後，我們就可以進行相應操作，例如點擊按鈕、輸入文字，或是取得節點內容、下載檔案、截圖等等。\u003C\u002Fp\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F 輸入內容\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etype\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"#email\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"example@example.com\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 點擊元素\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eclick\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"#loginButton\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E agreeButton \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".btn-input\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E agreeButton\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eclick\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003EclickCount\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003Edelay\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E100\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 截圖頁面\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Escreenshot\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003Epath\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"screenshot.png\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 截圖指定元素\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E element \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"h1\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E element\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Escreenshot\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003Epath\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"screenshot_h1.png\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"等待頁面\"\u003E等待頁面\u003C\u002Fh4\u003E\n\u003Cp\u003E由於網頁操作常會出現非同步的狀況，例如點擊同意使用規約之後，網頁會自行跳轉，puppeteer 有一系列與等待相關的 function：\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003Epage.waitFor(selector\u002Ffunction\u002Ftimeout[, options[, args]])\u003C\u002Fcode\u003E：等待 selector 出現／function 執行完畢／時間過後，才執行後面動作\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Epage.waitForNavigation(options)\u003C\u002Fcode\u003E：等待頁面跳轉完，才執行後面動作，通常會用於點擊連結或同意使用者規約等等頁面會發生跳轉的行為之後\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Epage.waitForSelector(selector[, options])\u003C\u002Fcode\u003E：等待至元素出現，才執行後面動作\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Epage.waitForRequest(url\u002Fpredicate, options)\u003C\u002Fcode\u003E：等待 request 處理完畢\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003Epage.waitForResponse(url\u002Fpredicate, options)\u003C\u002Fcode\u003E：等待獲得 response\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F 點擊同意按鈕\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E agreeButton \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".btn-input\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E agreeButton\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eclick\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003EclickCount\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003Edelay\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E100\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 點擊後網頁會自動跳頁，因此等待至跳轉完畢，再進行後續處理\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EwaitForNavigation\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E \u003Cspan class=\"token literal-property property\"\u003EwaitUntil\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"networkidle0\"\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F some other execution...\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"使用-cookie-登入\"\u003E使用 cookie 登入\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E fs \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"fs\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 從本地端讀取 oookie 檔案\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E cookies \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token constant\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eparse\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Efs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EreadFileSync\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".\u002Fcookies.json\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"utf-8\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetCookie\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E...\u003C\u002Fspan\u003Ecookies\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch4 id=\"儲存檔案\"\u003E儲存檔案\u003C\u002Fh4\u003E\n\u003Cp\u003Epuppeteer 裡只有提供截圖功能，並沒有下載檔案的 function（之前似乎有個 \u003Ccode\u003Epage.setDownloadBehavior\u003C\u002Fcode\u003E 或 \u003Ccode\u003Ebrowser.setDownloadBehavior\u003C\u002Fcode\u003E？），想要下載檔案的話，需要再搭配 \u003Ccode\u003Efs\u003C\u002Fcode\u003E，以及 \u003Ccode\u003E$eval\u003C\u002Fcode\u003E 使用。\u003C\u002Fp\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E fs \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Erequire\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"fs\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 取得檔案連結\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E href \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003E$eval\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".btn-download\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eanchor\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E\n  anchor\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetAttribute\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"href\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 取得檔案名稱\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E split \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E href\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Esplit\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\u002F\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Elet\u003C\u002Fspan\u003E filename \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E split\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Esplit\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Elength \u003Cspan class=\"token operator\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 取得檔案資料\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Elet\u003C\u002Fspan\u003E bufferData \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E page\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Egoto\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehref\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 使用 fs 下載檔案\u003C\u002Fspan\u003E\nfs\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EwriteFileSync\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E\".\u002Fdownload\u002F\"\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E filename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eawait\u003C\u002Fspan\u003E bufferData\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebuffer\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eerr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token keyword\"\u003Ethrow\u003C\u002Fspan\u003E err\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n    console\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"File saved!\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"參考-1\"\u003E參考\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fzhaoqize.github.io\u002Fpuppeteer-api-zh_CN\u002F#\u002F\"\u003EPuppeteer v2.1.1 API\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Ftechblog.gmo-ap.jp\u002F2018\u002F12\u002F28\u002Fpuppeteer%E3%81%A7%E3%81%A7%E3%81%8D%E3%82%8B%E3%81%93%E3%81%A8%E3%81%BE%E3%81%A8%E3%82%81\u002F\"\u003EPuppeteer でできることまとめ\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002FKawamotoShuji\u002Fitems\u002F878ae659a5c6e540343e\"\u003Eうるるを Puppeteer でスクレイピングしてみた\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fgo_sagawa\u002Fitems\u002F85f97deab7ccfdce53ea\"\u003Epuppeteer での要素の取得方法\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Fchenxiaochun\u002Fblog\u002Fissues\u002F38\"\u003EPuppeteer：模拟浏览器操作行为的利器\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fblog.techbridge.cc\u002F2019\u002F07\u002F13\u002Fmedium-crawler\u002F\"\u003EMedium 爬蟲進化史\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fblog.typeart.cc\u002Fusing-puppeteer-crawler-common-skills\u002F\"\u003EPuppeteer 爬蟲常用技巧\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Fpuppeteer\u002Fpuppeteer\u002Fblob\u002Fmain\u002Fexamples\u002Fblock-images.js\"\u003Epuppeteer\u002Fblock-images.js\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Fpuppeteer\u002Fpuppeteer\u002Fblob\u002Fmain\u002Fdocs\u002Fapi.md#pagesetrequestinterceptionvalue\"\u003Epuppeteer\u002Fapi.md\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"文章\"\u003E文章\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.ptt.cc\u002Fbbs\u002FSoft_Job\u002FM.1332567899.A.C00.html\"\u003E[閒聊] 笑談軟體測試的幾個階段（一）\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.ptt.cc\u002Fbbs\u002FSoft_Job\u002FM.1332601969.A.342.html\"\u003E[閒聊] 笑談軟體測試的幾個階段（二）\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.ptt.cc\u002Fbbs\u002FSoft_Job\u002FM.1332681709.A.EB4.html\"\u003E[閒聊] 笑談軟體測試的幾個階段（三）\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.ptt.cc\u002Fbbs\u002FSoft_Job\u002FM.1332697283.A.630.html\"\u003E[閒聊] 笑談軟體測試的幾個階段（四）\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.ptt.cc\u002Fbbs\u002FSoft_Job\u002FM.1332863702.A.076.html\"\u003E[閒聊] 笑談軟體測試的幾個階段（五） 測試權重\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fwww.ptt.cc\u002Fbbs\u002FSoft_Job\u002FM.1597938487.A.566.html\"\u003E[心得] 笑談軟體測試的幾個階段（六） 歷史代碼\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n",date:"2019-07-18T07:08:00.000Z",excerpt:null,printDate:"July 18, 2019",printReadingTime:"4 min read",tags:["F2E"],image:"https:\u002F\u002Ff6bfb5.github.io\u002Fpreview\u002Ff2e-08-unit-test.png"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.b4cfb689.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main","/client/client.b4cfb689.js")}document.head.appendChild(s)</script> 