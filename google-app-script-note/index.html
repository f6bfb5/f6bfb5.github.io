<!DOCTYPE html> <html lang=zh-Hant-TW> <head> <meta charset=utf-8> <meta name=viewport content="width=device-width,initial-scale=1"> <meta name=theme-color content=#333333> <base href=/ > <link href=https://fonts.googleapis.com rel=preconnect> <link href=https://fonts.gstatic.com rel=preconnect crossorigin> <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.png rel=icon type=image/png> <link href=client/client-9fb8c9fe.css rel=stylesheet><link href=client/[slug]-f40e8e13.css rel=stylesheet> <title>Google App Script 筆記</title><script async data-svelte=svelte-a2kvt3 src="https://www.googletagmanager.com/gtag/js?id=UA-114661136-2"></script><script async data-svelte=svelte-1op50db src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js data-ad-client=ca-pub-9613661448556355></script><link href=/favicon.ico rel="shortcut icon" data-svelte=svelte-oksmvs><link href=/favicon.ico rel=bookmark data-svelte=svelte-oksmvs><link href=https://f6bfb5.github.io/google-app-script-note rel=canonical data-svelte=svelte-oowxqk><meta data-svelte=svelte-oowxqk content=https://f6bfb5.github.io/google-app-script-note property=og:url><meta data-svelte=svelte-oowxqk content=article property=og:type><meta data-svelte=svelte-oowxqk content="Google App Script 筆記" property=og:title><meta data-svelte=svelte-oowxqk property=og:description><meta data-svelte=svelte-oowxqk name=Description><meta data-svelte=svelte-oowxqk content=https://f6bfb5.github.io/preview/google-app-script-note.png property=og:image><meta data-svelte=svelte-oowxqk name=twitter:card content=summary_large_image><meta data-svelte=svelte-oowxqk name=twitter:title value="Google App Script 筆記"><meta data-svelte=svelte-oowxqk name=twitter:description><meta data-svelte=svelte-oowxqk name=twitter:label1 value="Published on"><meta data-svelte=svelte-oowxqk name=twitter:data1 value="Aug 25, 2020"> <link href=/client/client.33446b18.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/client-9fb8c9fe.css rel=preload as=style><link href=/client/[slug].ac8bd3e1.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/inject_styles.5607aec6.js rel=modulepreload as=script crossorigin=use-credentials><link href=/client/[slug]-f40e8e13.css rel=preload as=style></head> <body> <div id=sapper> <div class="svelte-5s6wka layout"> <header class=svelte-1f9e1m7><nav class=svelte-t90z2a><a href=. class=svelte-t90z2a>トリコじかけの明け暮れ</a> <a href=about class=svelte-t90z2a>about</a> <a href=rss.xml class=svelte-t90z2a>rss</a> </nav> <a href=/ class=svelte-kw2jbs> <img alt=logo src=data:image/gif;base64,AAABAAEAEBAQAAAAAAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAABbl4Awr28AAAAAAC4pp4ACgUAAFomhAB4aGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiIiQiQiIkREREREJCIiQRERERESIiJBEhEREREiIkFCQRFRESIiQRIRERFRIiJBEREREREiIkE2ZmZmESQiQWYAAAZhJCJBZgAABmEkIkFmAAAGYSQiQWYAAAZhRCJBZgAABmFEIkE2ZmZmMUQiQRERERERRCJERERERERCLABwAAgAMAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAwAA style=width:36px;height:42px> </a> </header> <main class=svelte-5s6wka> <header class=svelte-cvs7ll> <h1 class="svelte-cvs7ll title"><span class=svelte-cvs7ll style=animation-delay:125ms>G</span><span class=svelte-cvs7ll style=animation-delay:150ms>o</span><span class=svelte-cvs7ll style=animation-delay:175ms>o</span><span class=svelte-cvs7ll style=animation-delay:.2s>g</span><span class=svelte-cvs7ll style=animation-delay:225ms>l</span><span class=svelte-cvs7ll style=animation-delay:250ms>e</span><span class=svelte-cvs7ll style=animation-delay:275ms;width:.25em> </span><span class=svelte-cvs7ll style=animation-delay:.3s>A</span><span class=svelte-cvs7ll style=animation-delay:325ms>p</span><span class=svelte-cvs7ll style=animation-delay:350ms>p</span><span class=svelte-cvs7ll style=animation-delay:375ms;width:.25em> </span><span class=svelte-cvs7ll style=animation-delay:.4s>S</span><span class=svelte-cvs7ll style=animation-delay:425ms>c</span><span class=svelte-cvs7ll style=animation-delay:450ms>r</span><span class=svelte-cvs7ll style=animation-delay:475ms>i</span><span class=svelte-cvs7ll style=animation-delay:.5s>p</span><span class=svelte-cvs7ll style=animation-delay:525ms>t</span><span class=svelte-cvs7ll style=animation-delay:550ms;width:.25em> </span><span class=svelte-cvs7ll style=animation-delay:575ms>筆</span><span class=svelte-cvs7ll style=animation-delay:.6s>記</span></h1> <p class=svelte-cvs7ll>August 25, 2020 <small class=svelte-cvs7ll>5 min read</small></header> <div class="svelte-cvs7ll container"><article class=content><ul> <li><a href=https://github.com/contributorpw/google-apps-script-awesome-list#parsing target=_blank rel=nofollow>contributorpw/google-apps-script-awesome-list: The usual list of links to interesting resources for Google Apps Script</a></li> <li><a href="https://qiita.com/matsu7089/items/6ea7931e97ae703f6607?utm_campaign=6922a8b5e9-Qiita_newsletter_419_07_15_2020&utm_term=0_e44feaa081-6922a8b5e9-34565689#%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-onget-%E3%82%92%E3%81%A4%E3%81%8F%E3%82%8B" target=_blank rel=nofollow>【GAS x Vue.js】JavaScript のみで今、家計簿をつくるとしたら【ハンズオン付き！】 - Qiita</a></li> <li><a href=https://qiita.com/hironobu-igawa/items/9b5c224d9bbe7b9843be target=_blank rel=nofollow>【初心者向け Tips】単純作業はもう嫌だ！GAS ツール作りの 4 つの技 - Qiita</a></li> <li><a href=https://qiita.com/FUJIvillage/items/e22ad7efdf7fc898ffda target=_blank rel=nofollow>Google Apps Script（GAS）を利用した業務改善 - Qiita</a></li> <li><a href=https://qiita.com/mitonattou919/items/de415bb9302a52d52e2e target=_blank rel=nofollow>Google Apps Script の割り当て値と制限値 - Qiita</a></li> </ul> <h2 id=get--post>GET / POST</h2> <pre class=language-javascript><code class=language-javascript><span class="token keyword">function</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> e<span class="token punctuation">.</span>parameter<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  <span class="token function">getHandler</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><pre class=language-javascript><code class=language-javascript><span class="token keyword">function</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> parameter <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>postData<span class="token punctuation">.</span>contents<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> target <span class="token operator">=</span> parameter<span class="token punctuation">.</span>target<span class="token punctuation">;</span>
  <span class="token function">postHandler</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h2 id=sheet-handler>Sheet Handler</h2> <h3 id=read>Read</h3> <ul> <li><code>SpreadsheetApp.getActiveSpreadsheet()</code></li> <li><code>Spreadsheet#getSheetByName(name)</code></li> <li><code>Sheet#getRange(row, column)</code></li> <li><code>Sheet#getRange(row, column, numRows)</code></li> <li><code>Sheet#getRange(row, column, numRows, numColumns)</code></li> <li><code>Sheet#getRange(cellRangeNotation)</code> <br>└ ex: <code>getRange("A1:B2")</code></li> <li><code>Range#getValues()</code> <br>│ ex. <code>const values = sheet.getRange("A1:C2").getValues();</code> <br>└ <code>const values = sheet.getRange("A1:C2").getValues().flat();</code></li> </ul> <h3 id=write>Write</h3> <ul> <li><code>Range#setValues(values)</code></li> </ul> <h4 id=寫入整個陣列內容>寫入整個陣列內容</h4> <pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> rowLength <span class="token operator">=</span> array<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
<span class="token keyword">const</span> colLength <span class="token operator">=</span> array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
sheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> rowLength<span class="token punctuation">,</span> colLength<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValues</span><span class="token punctuation">(</span>array<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id=edit-trigger>Edit Trigger</h3> <pre class=language-javascript><code class=language-javascript><span class="token keyword">function</span> <span class="token function">onEdit</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//目当てのシートでなければ中断</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>range<span class="token punctuation">.</span><span class="token function">getSheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSheetName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">"シート名"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">//ヘッダ行だった場合も中断</span>
  <span class="token keyword">const</span> row <span class="token operator">=</span> e<span class="token punctuation">.</span>range<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> today <span class="token operator">=</span> Utilities<span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token string">"Asia/Tokyo"</span><span class="token punctuation">,</span> <span class="token string">"yyyy/MM/dd"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> time <span class="token operator">=</span> Utilities<span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token string">"Asia/Tokyo"</span><span class="token punctuation">,</span> <span class="token string">"HH:mm"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//A1セルに８桁の年月日 B1セルに２４時間表記の時刻</span>
  <span class="token keyword">var</span> spreadsheet <span class="token operator">=</span>
    SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span><span class="token string">"シート名"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  spreadsheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token string">"A1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>today<span class="token punctuation">)</span><span class="token punctuation">;</span>
  spreadsheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token string">"B1"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h2 id=use-library>Use Library</h2> <ul> <li><a href=https://qiita.com/shikumiya_hata/items/5e11ff875a9dd050a722 target=_blank rel=nofollow>GAS でライブラリを使う・作る方法 - Qiita</a></li> <li>開啟 App Script 程式碼頁面 <br>├ -> Resources -> Libraries <br>├ -> 複製 cheeriogs 的說明頁面裡的 script ID <br>└ -> 貼至下方的 add library -> 追加</li> <li><a href=https://qiita.com/TakeshiNickOsanai/items/62810b0e96bf37bd0eca target=_blank rel=nofollow>Google Apps Script + OAuth ライブラリで、freee API の操作を行う - Qiita</a></li> </ul> <h2 id=crawler>Crawler</h2> <h3 id=urlfetchapp><a href=https://developers.google.com/apps-script/reference/url-fetch/url-fetch-app target=_blank rel=nofollow>UrlFetchApp</a></h3> <ul> <li><a href=https://qiita.com/yamaguchi_yo/items/09bfc5c32faffa3beb62 target=_blank rel=nofollow>法改正情報を早く確実にキャッチするために GAS で自動化するツールを作って運用してみた。 - Qiita</a></li> <li><a href=https://qiita.com/cyoi0129/items/1cafb446dbe176e9366e target=_blank rel=nofollow>スクレイピングいろいろ - Qiita</a></li> </ul> <pre class=language-javascript><code class=language-javascript><span class="token keyword">var</span> sheet <span class="token operator">=</span> SpreadsheetApp<span class="token punctuation">.</span><span class="token function">getActiveSpreadsheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSheetByName</span><span class="token punctuation">(</span><span class="token string">"urlリスト"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> rows <span class="token operator">=</span> sheet<span class="token punctuation">.</span><span class="token function">getDataRange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> numRows <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token function">getNumRows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> values <span class="token operator">=</span> rows<span class="token punctuation">.</span><span class="token function">getValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 一行ずつチェック</span>
<span class="token keyword">var</span> results <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> numRows <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> row <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// GSSから対象URLの値を取得</span>
  <span class="token keyword">var</span> name <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> url <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// 前回のハッシュ値</span>
  <span class="token keyword">var</span> hash <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token comment">// htmlを取得</span>
  <span class="token keyword">var</span> html <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> text <span class="token operator">=</span> html<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ハッシュ値を計算</span>
  <span class="token keyword">var</span> md5bin <span class="token operator">=</span> Utilities<span class="token punctuation">.</span><span class="token function">computeDigest</span><span class="token punctuation">(</span>Utilities<span class="token punctuation">.</span>DigestAlgorithm<span class="token punctuation">.</span><span class="token constant">MD5</span><span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> md5 <span class="token operator">=</span> Utilities<span class="token punctuation">.</span><span class="token function">base64Encode</span><span class="token punctuation">(</span>md5bin<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 前回と同じならスキップ</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>hash <span class="token operator">==</span> md5<span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>
  results<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>name<span class="token punctuation">,</span> url<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  sheet<span class="token punctuation">.</span><span class="token function">getRange</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span>md5<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>results<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  Logger<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"更新はありませんでした。"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id=cheeriogs><a href=https://github.com/tani/cheeriogs target=_blank rel=nofollow>Cheeriogs</a></h3> <ul> <li>cheerio 的 Google Sheet 版</li> <li>可以用類似 jQuery 的語法解析 HTML 內容</li> </ul> <ol> <li>選擇「Tool」 → 「Script Editor」</li> <li>「Library」 → 「Script ID」處加入 <code>1ReeQ6WO8kKNxoaA_O0XEQ589cIrRvEBA9qcWpNqdOP17i47u6N9M5Xh0</code></li> </ol> <pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> htmlContent <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> $ <span class="token operator">=</span> Cheerio<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>htmlContent<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> title <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"title"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ret<span class="token punctuation">[</span><span class="token string">"title"</span><span class="token punctuation">]</span> <span class="token operator">=</span> title<span class="token punctuation">;</span>
ret<span class="token punctuation">[</span><span class="token string">"description"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">"meta[name='description']"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">attr</span><span class="token punctuation">(</span><span class="token string">"content"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ret<span class="token punctuation">[</span><span class="token string">"pref"</span><span class="token punctuation">]</span> <span class="token operator">=</span> title<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"赤十字血液センター｜日本赤十字社"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ret<span class="token punctuation">[</span><span class="token string">"demand_date"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".center-main-today-timedate"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">first</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ret<span class="token punctuation">[</span><span class="token string">"demands"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">".center-main-today-types-state"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> element</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  ret<span class="token punctuation">[</span><span class="token string">"demands"</span><span class="token punctuation">]</span><span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span>element<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h2 id=discord-webhook>Discord Webhook</h2> <h3 id=url-fetch-app>URL Fetch App</h3> <ul> <li><code>UrlFetchApp.fetch(url[, params])</code></li> </ul> <h4 id=parameters>parameters</h4> <table> <thead> <tr> <th>parameter</th> <th>type</th> <th>description</th> </tr> </thead> <tr> <td>url</td> <td>String</td> <td>傳送 HTTP Request 的目標網址</td> </tr> <tr> <td>params.contentType</td> <td>String</td> <td>Request 的 Content-Type</td> </tr> <tr> <td>params.headers</td> <td>Object</td> <td>設定 Request Header 的 key/value object</td> </tr> <tr> <td>params.method</td> <td>String</td> <td>指定使用何種 method，預設為 <code>GET</code></td> </tr> <tr> <td>params.payload</td> <td>String</td> <td>指定 Request Body。<code>GET</code> 時無法指定。指定後會被視為 <code>application/x-www-form-urlencoded</code> 或 <code>multipart/form-data</code></td> </tr> </table> <h4 id=handle-response>Handle Response</h4> <table> <thead> <tr> <th>method</th> <th>type</th> <th>description</th> </tr> </thead> <tr> <td>getContentText()</td> <td>String</td> <td>取得 Response Body</td> </tr> <tr> <td>getHeaders()</td> <td>Object</td> <td>取得 Response Header</td> </tr> <tr> <td>getResponseCode()</td> <td>Integer</td> <td>取得回傳的 HTTP 狀態</td> </tr> </table> <pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  channel<span class="token operator">:</span> <span class="token string">"sample"</span><span class="token punctuation">,</span>
  text<span class="token operator">:</span> <span class="token string">"hello"</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

response <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>
  <span class="token string">"https://slack.com/api/chat.postMessage"</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span>
    contentType<span class="token operator">:</span> <span class="token string">"application/json"</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">"Authorization"</span><span class="token operator">:</span> <span class="token string">"Bearer xoxp-xxxxxxxxx-xxxx"</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    method<span class="token operator">:</span> <span class="token string">"post"</span><span class="token punctuation">,</span>
    payload<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getResponseCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// output: 200</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// output: '{ "OK": true, ... }'</span></code></pre><h3 id=建立-webhook>建立 Webhook</h3> <ol> <li>點擊 Discord 頻道右邊的齒輪鍵</li> <li>點擊畫面左邊的 <code>Integrations</code> -> <code>Create Webhook</code> -> <code>Copy Webhook URL</code></li> </ol> <h3 id=撰寫-gas>撰寫 GAS</h3> <p><code>Google App Script</code></p> <pre class=language-javaScript><code class=language-javaScript>function sendToDiscord(message) {
  const url      = ''; // 上方建立的 Webhook 網址
  const token    = ''; // Webhook 網址後半的 token 部份
                       // * 未確認是否已不需要
  const channel  = '#general';
  const text     = message;
  const username = 'bot';
  const parse    = 'full';
  const method   = 'POST';

  const payload = {
    'token'     : token,
    'channel'   : channel,
    'content'   : text,
    'username'  : username,
    'parse'     : parse,
  };

  const params = {
    'method': method,
    'payload': payload,
    'muteHttpExceptions': true
  };

  response = UrlFetchApp.fetch(url, params);
}</code></pre><h2 id=add-timestamp>Add Timestamp</h2> <pre class=language-javascript><code class=language-javascript><span class="token comment">// 今天</span>
<span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> today <span class="token operator">=</span> Utilities<span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token string">"Asia/Taipei"</span><span class="token punctuation">,</span> <span class="token string">"顯示格式"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 明天 i=1 昨天 i=-1</span>
<span class="token keyword">var</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
date<span class="token punctuation">.</span><span class="token function">setDate</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> day <span class="token operator">=</span> Utilities<span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span>date<span class="token punctuation">,</span> <span class="token string">"Asia/Taipei"</span><span class="token punctuation">,</span> <span class="token string">"顯示格式"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><code>顯示格式</code> 的部份可以使用 <code>年：y</code>、<code>月：M</code>、<code>日：d</code>、<code>時（12 小時制）：h</code>、<code>時（24 小時制）：H</code>、<code>分：m</code>、<code>秒：s</code> 自行制定格式</p> <p>例：<code>'yyyy/MM/dd/HH:mm'</code> → <code>2020/12/31/23:59</code></p> <h2 id=set-trigger>Set Trigger</h2> <ul> <li><a href=https://qiita.com/tapatyo/items/465a982635ba3933b32d target=_blank rel=nofollow>【Google Apps Script】トリガーによる定期実行の時間のズレをなくす方法 - Qiita</a></li> </ul> <h3 id=display-message-box>Display Message Box</h3> <pre class=language-javascript><code class=language-javascript><span class="token keyword">if</span> <span class="token punctuation">(</span>Browser<span class="token punctuation">.</span><span class="token function">msgBox</span><span class="token punctuation">(</span><span class="token string">"確認"</span><span class="token punctuation">,</span> <span class="token string">"是否要執行？"</span><span class="token punctuation">,</span> Browser<span class="token punctuation">.</span>Buttons<span class="token punctuation">.</span><span class="token constant">YES_NO</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token string">"yes"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h2 id=write-gs-code-on-vscode>Write GS code on VSCode</h2> <ul> <li><a href=https://qiita.com/jooji/items/76f07f3f82900ebcd2b8 target=_blank rel=nofollow>[clasp]Google Apps Script を VSCode/Typescript/Git で書く。 - Qiita</a></li> </ul> <h2 id=backup-sheet>Backup Sheet</h2> <pre class=language-javascript><code class=language-javascript><span class="token keyword">const</span> file <span class="token operator">=</span> DriveApp<span class="token punctuation">.</span><span class="token function">getFileById</span><span class="token punctuation">(</span><span class="token string">'File ID'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> folder <span class="token operator">=</span> DriveApp<span class="token punctuation">.</span><span class="token function">getFolderById</span><span class="token punctuation">(</span><span class="token string">'Folder ID'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> filename <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> Utilities<span class="token punctuation">.</span><span class="token function">formatDate</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'JST'</span> <span class="token string">'MM/dd/HH:mm'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

file<span class="token punctuation">.</span><span class="token function">makeCopy</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> folder<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id=conver-sheet-to-excel-file>Conver Sheet to excel file</h3> <pre class=language-javascript><code class=language-javascript><span class="token comment">//エクセルを返すURL</span>
<span class="token keyword">var</span> fetchUrl <span class="token operator">=</span>
  <span class="token string">"https://docs.google.com/feeds/download/spreadsheets/Export?key="</span> <span class="token operator">+</span>
  <span class="token string">"シートID"</span> <span class="token operator">+</span>
  <span class="token string">"&ampamp;exportFormat=xlsx"</span><span class="token punctuation">;</span>

<span class="token comment">//OAuth</span>
<span class="token keyword">var</span> fetchOpt <span class="token operator">=</span> <span class="token punctuation">{</span>
  headers<span class="token operator">:</span> <span class="token punctuation">{</span> Authorization<span class="token operator">:</span> <span class="token string">"Bearer "</span> <span class="token operator">+</span> ScriptApp<span class="token punctuation">.</span><span class="token function">getOAuthToken</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  muteHttpExceptions<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//エクセルファイルゲット！</span>
<span class="token keyword">var</span> xlsxFile <span class="token operator">=</span> UrlFetchApp<span class="token punctuation">.</span><span class="token function">fetch</span><span class="token punctuation">(</span>fetchUrl<span class="token punctuation">,</span> fetchOpt<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getBlob</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"任意の名前.xlsx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre> </article> <div class="back-to-top hidden svelte-142cfra" style=right:2em>Back to top </div> </div></main> <footer class=svelte-1nz5bf0><a href=https://creativecommons.org/licenses/by-sa/4.0/ target=_blank rel="noreferrer noopener nofollow">CC BY-SA 4.0.</a> <div class="svelte-1nz5bf0 right">Made with <span class="svelte-1nz5bf0 heart">❤️</span> and <a href=https://github.com/Charca/sapper-blog-template target=_blank ref="noreferrer noopener nofollow">Sapper</a></div> <div class="svelte-1nz5bf0 clearfix"></div> </footer> <a href=https://www.nicovideo.jp/watch/sm29763392 target=_blank rel="noreferrer noopener"><img alt=easter_egg src=_c_choju23_0036_s512_choju23_0036_11.png class="easter-egg svelte-72qmgd"> </a> </div></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{post:{title:"Google App Script 筆記",slug:"google-app-script-note",html:"\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Fcontributorpw\u002Fgoogle-apps-script-awesome-list#parsing\"\u003Econtributorpw\u002Fgoogle-apps-script-awesome-list: The usual list of links to interesting resources for Google Apps Script\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fmatsu7089\u002Fitems\u002F6ea7931e97ae703f6607?utm_campaign=6922a8b5e9-Qiita_newsletter_419_07_15_2020&amp;utm_term=0_e44feaa081-6922a8b5e9-34565689#%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97%E3%81%99%E3%82%8B-onget-%E3%82%92%E3%81%A4%E3%81%8F%E3%82%8B\"\u003E【GAS x Vue.js】JavaScript のみで今、家計簿をつくるとしたら【ハンズオン付き！】 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fhironobu-igawa\u002Fitems\u002F9b5c224d9bbe7b9843be\"\u003E【初心者向け Tips】単純作業はもう嫌だ！GAS ツール作りの 4 つの技 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002FFUJIvillage\u002Fitems\u002Fe22ad7efdf7fc898ffda\"\u003EGoogle Apps Script（GAS）を利用した業務改善 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fmitonattou919\u002Fitems\u002Fde415bb9302a52d52e2e\"\u003EGoogle Apps Script の割り当て値と制限値 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"get--post\"\u003EGET \u002F POST\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EdoGet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E target \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E e\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Eparameter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Etarget\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function\"\u003EgetHandler\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etarget\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EdoPost\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E parameter \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token constant\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eparse\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ee\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EpostData\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Econtents\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E target \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E parameter\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Etarget\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token function\"\u003EpostHandler\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etarget\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"sheet-handler\"\u003ESheet Handler\u003C\u002Fh2\u003E\n\u003Ch3 id=\"read\"\u003ERead\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003ESpreadsheetApp.getActiveSpreadsheet()\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003ESpreadsheet#getSheetByName(name)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003ESheet#getRange(row, column)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003ESheet#getRange(row, column, numRows)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003ESheet#getRange(row, column, numRows, numColumns)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003ESheet#getRange(cellRangeNotation)\u003C\u002Fcode\u003E\n\u003Cbr\u003E└ ex: \u003Ccode\u003EgetRange(&quot;A1:B2&quot;)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ccode\u003ERange#getValues()\u003C\u002Fcode\u003E\n\u003Cbr\u003E│ ex. \u003Ccode\u003Econst values = sheet.getRange(&quot;A1:C2&quot;).getValues();\u003C\u002Fcode\u003E\n\u003Cbr\u003E└ \u003Ccode\u003Econst values = sheet.getRange(&quot;A1:C2&quot;).getValues().flat();\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"write\"\u003EWrite\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003ERange#setValues(values)\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 id=\"寫入整個陣列內容\"\u003E寫入整個陣列內容\u003C\u002Fh4\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E rowLength \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E array\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Elength\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E colLength \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E array\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Elength\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\nsheet\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetRange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E rowLength\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E colLength\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetValues\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Earray\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"edit-trigger\"\u003EEdit Trigger\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Efunction\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003EonEdit\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Ee\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F目当てのシートでなければ中断\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ee\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erange\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetSheet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetSheetName\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E!==\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"シート名\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002Fヘッダ行だった場合も中断\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E row \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E e\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Erange\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetRow\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Erow \u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E date \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E today \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EformatDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edate\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Asia\u002FTokyo\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"yyyy\u002FMM\u002Fdd\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E time \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EformatDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edate\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Asia\u002FTokyo\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"HH:mm\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002FA1セルに８桁の年月日 B1セルに２４時間表記の時刻\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E spreadsheet \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\n    SpreadsheetApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetActiveSpreadsheet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetSheetByName\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"シート名\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  spreadsheet\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetRange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"A1\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etoday\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  spreadsheet\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetRange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"B1\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Etime\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"use-library\"\u003EUse Library\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fshikumiya_hata\u002Fitems\u002F5e11ff875a9dd050a722\"\u003EGAS でライブラリを使う・作る方法 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E開啟 App Script 程式碼頁面\n\u003Cbr\u003E├ -&gt; Resources -&gt; Libraries\n\u003Cbr\u003E├ -&gt; 複製 cheeriogs 的說明頁面裡的 script ID\n\u003Cbr\u003E└ -&gt; 貼至下方的 add library -&gt; 追加\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002FTakeshiNickOsanai\u002Fitems\u002F62810b0e96bf37bd0eca\"\u003EGoogle Apps Script + OAuth ライブラリで、freee API の操作を行う - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"crawler\"\u003ECrawler\u003C\u002Fh2\u003E\n\u003Ch3 id=\"urlfetchapp\"\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fdevelopers.google.com\u002Fapps-script\u002Freference\u002Furl-fetch\u002Furl-fetch-app\"\u003EUrlFetchApp\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fyamaguchi_yo\u002Fitems\u002F09bfc5c32faffa3beb62\"\u003E法改正情報を早く確実にキャッチするために GAS で自動化するツールを作って運用してみた。 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fcyoi0129\u002Fitems\u002F1cafb446dbe176e9366e\"\u003Eスクレイピングいろいろ - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E sheet \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E SpreadsheetApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetActiveSpreadsheet\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetSheetByName\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"urlリスト\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E rows \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E sheet\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetDataRange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E numRows \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E rows\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetNumRows\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E values \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E rows\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetValues\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 一行ずつチェック\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E results \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E i \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E i \u003Cspan class=\"token operator\"\u003E&lt;=\u003C\u002Fspan\u003E numRows \u003Cspan class=\"token operator\"\u003E-\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E i\u003Cspan class=\"token operator\"\u003E++\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E row \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E values\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ei\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F GSSから対象URLの値を取得\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E name \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E row\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E url \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E row\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F 前回のハッシュ値\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E hash \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E row\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F htmlを取得\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E html \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E UrlFetchApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eurl\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E text \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E html\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetContentText\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F ハッシュ値を計算\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E md5bin \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EcomputeDigest\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EUtilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EDigestAlgorithm\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token constant\"\u003EMD5\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E text\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E md5 \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ebase64Encode\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emd5bin\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token comment\"\u003E\u002F\u002F 前回と同じならスキップ\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ehash \u003Cspan class=\"token operator\"\u003E==\u003C\u002Fspan\u003E md5\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Econtinue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  results\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Epush\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E url\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  sheet\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetRange\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E i\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E3\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetValue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emd5\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresults\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003Elength \u003Cspan class=\"token operator\"\u003E==\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  Logger\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"更新はありませんでした。\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"cheeriogs\"\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fgithub.com\u002Ftani\u002Fcheeriogs\"\u003ECheeriogs\u003C\u002Fa\u003E\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003Echeerio 的 Google Sheet 版\u003C\u002Fli\u003E\n\u003Cli\u003E可以用類似 jQuery 的語法解析 HTML 內容\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Col\u003E\n\u003Cli\u003E選擇「Tool」 → 「Script Editor」\u003C\u002Fli\u003E\n\u003Cli\u003E「Library」 → 「Script ID」處加入 \u003Ccode\u003E1ReeQ6WO8kKNxoaA_O0XEQ589cIrRvEBA9qcWpNqdOP17i47u6N9M5Xh0\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E url \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E htmlContent \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E UrlFetchApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eurl\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetContentText\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"UTF-8\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E $ \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Cheerio\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eload\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EhtmlContent\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E title \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"title\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efirst\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\nret\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"title\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E title\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\nret\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"description\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"meta[name='description']\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efirst\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eattr\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"content\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\nret\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"pref\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E title\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Ereplace\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"赤十字血液センター｜日本赤十字社\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\nret\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"demand_date\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".center-main-today-timedate\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efirst\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\nret\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"demands\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\".center-main-today-types-state\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Eeach\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token parameter\"\u003Eindex\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E element\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  ret\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"demands\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Eindex\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003E$\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eelement\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etext\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"discord-webhook\"\u003EDiscord Webhook\u003C\u002Fh2\u003E\n\u003Ch3 id=\"url-fetch-app\"\u003EURL Fetch App\u003C\u002Fh3\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ccode\u003EUrlFetchApp.fetch(url[, params])\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch4 id=\"parameters\"\u003Eparameters\u003C\u002Fh4\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003Eparameter\u003C\u002Fth\u003E\n\u003Cth\u003Etype\u003C\u002Fth\u003E\n\u003Cth\u003Edescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd\u003Eurl\u003C\u002Ftd\u003E\n\u003Ctd\u003EString\u003C\u002Ftd\u003E\n\u003Ctd\u003E傳送 HTTP Request 的目標網址\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003Eparams.contentType\u003C\u002Ftd\u003E\n\u003Ctd\u003EString\u003C\u002Ftd\u003E\n\u003Ctd\u003ERequest 的 Content-Type\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003Eparams.headers\u003C\u002Ftd\u003E\n\u003Ctd\u003EObject\u003C\u002Ftd\u003E\n\u003Ctd\u003E設定 Request Header 的 key\u002Fvalue object\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003Eparams.method\u003C\u002Ftd\u003E\n\u003Ctd\u003EString\u003C\u002Ftd\u003E\n\u003Ctd\u003E指定使用何種 method，預設為 \u003Ccode\u003EGET\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003Eparams.payload\u003C\u002Ftd\u003E\n\u003Ctd\u003EString\u003C\u002Ftd\u003E\n\u003Ctd\u003E指定 Request Body。\u003Ccode\u003EGET\u003C\u002Fcode\u003E 時無法指定。指定後會被視為 \u003Ccode\u003Eapplication\u002Fx-www-form-urlencoded\u003C\u002Fcode\u003E 或 \u003Ccode\u003Emultipart\u002Fform-data\u003C\u002Fcode\u003E\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Ch4 id=\"handle-response\"\u003EHandle Response\u003C\u002Fh4\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003Emethod\u003C\u002Fth\u003E\n\u003Cth\u003Etype\u003C\u002Fth\u003E\n\u003Cth\u003Edescription\u003C\u002Fth\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Fthead\u003E\n\u003Ctbody\u003E\u003Ctr\u003E\n\u003Ctd\u003EgetContentText()\u003C\u002Ftd\u003E\n\u003Ctd\u003EString\u003C\u002Ftd\u003E\n\u003Ctd\u003E取得 Response Body\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EgetHeaders()\u003C\u002Ftd\u003E\n\u003Ctd\u003EObject\u003C\u002Ftd\u003E\n\u003Ctd\u003E取得 Response Header\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EgetResponseCode()\u003C\u002Ftd\u003E\n\u003Ctd\u003EInteger\u003C\u002Ftd\u003E\n\u003Ctd\u003E取得回傳的 HTTP 狀態\u003C\u002Ftd\u003E\n\u003C\u002Ftr\u003E\n\u003C\u002Ftbody\u003E\u003C\u002Ftable\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E data \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  channel\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"sample\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  text\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"hello\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\nresponse \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E UrlFetchApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E\"https:\u002F\u002Fslack.com\u002Fapi\u002Fchat.postMessage\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n    contentType\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"application\u002Fjson\"\u003C\u002Fspan\u003E\n    headers\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n      \u003Cspan class=\"token string\"\u003E\"Authorization\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Bearer xoxp-xxxxxxxxx-xxxx\"\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    method\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"post\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n    payload\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token constant\"\u003EJSON\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Estringify\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edata\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\nconsole\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresponse\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetResponseCode\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E \u003Cspan class=\"token comment\"\u003E\u002F\u002F output: 200\u003C\u002Fspan\u003E\nconsole\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Elog\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eresponse\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetContentText\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E  \u003Cspan class=\"token comment\"\u003E\u002F\u002F output: '{ \"OK\": true, ... }'\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"建立-webhook\"\u003E建立 Webhook\u003C\u002Fh3\u003E\n\u003Col\u003E\n\u003Cli\u003E點擊 Discord 頻道右邊的齒輪鍵\u003C\u002Fli\u003E\n\u003Cli\u003E點擊畫面左邊的 \u003Ccode\u003EIntegrations\u003C\u002Fcode\u003E -&gt; \u003Ccode\u003ECreate Webhook\u003C\u002Fcode\u003E -&gt; \u003Ccode\u003ECopy Webhook URL\u003C\u002Fcode\u003E\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch3 id=\"撰寫-gas\"\u003E撰寫 GAS\u003C\u002Fh3\u003E\n\u003Cp\u003E\u003Ccode\u003EGoogle App Script\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cpre class=\"language-javaScript\"\u003E\u003Ccode class=\"language-javaScript\"\u003Efunction sendToDiscord(message) {\n  const url      = ''; \u002F\u002F 上方建立的 Webhook 網址\n  const token    = ''; \u002F\u002F Webhook 網址後半的 token 部份\n                       \u002F\u002F * 未確認是否已不需要\n  const channel  = '#general';\n  const text     = message;\n  const username = 'bot';\n  const parse    = 'full';\n  const method   = 'POST';\n\n  const payload = {\n    'token'     : token,\n    'channel'   : channel,\n    'content'   : text,\n    'username'  : username,\n    'parse'     : parse,\n  };\n\n  const params = {\n    'method': method,\n    'payload': payload,\n    'muteHttpExceptions': true\n  };\n\n  response = UrlFetchApp.fetch(url, params);\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"add-timestamp\"\u003EAdd Timestamp\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002F 今天\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E date \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E today \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EformatDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edate\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Asia\u002FTaipei\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"顯示格式\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002F 明天 i=1 昨天 i=-1\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E date \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\ndate\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edate\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E i\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E day \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EformatDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edate\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Asia\u002FTaipei\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"顯示格式\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003E\u003Ccode\u003E顯示格式\u003C\u002Fcode\u003E 的部份可以使用 \u003Ccode\u003E年：y\u003C\u002Fcode\u003E、\u003Ccode\u003E月：M\u003C\u002Fcode\u003E、\u003Ccode\u003E日：d\u003C\u002Fcode\u003E、\u003Ccode\u003E時（12 小時制）：h\u003C\u002Fcode\u003E、\u003Ccode\u003E時（24 小時制）：H\u003C\u002Fcode\u003E、\u003Ccode\u003E分：m\u003C\u002Fcode\u003E、\u003Ccode\u003E秒：s\u003C\u002Fcode\u003E 自行制定格式\u003C\u002Fp\u003E\n\u003Cp\u003E例：\u003Ccode\u003E&#39;yyyy\u002FMM\u002Fdd\u002FHH:mm&#39;\u003C\u002Fcode\u003E → \u003Ccode\u003E2020\u002F12\u002F31\u002F23:59\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"set-trigger\"\u003ESet Trigger\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Ftapatyo\u002Fitems\u002F465a982635ba3933b32d\"\u003E【Google Apps Script】トリガーによる定期実行の時間のズレをなくす方法 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch3 id=\"display-message-box\"\u003EDisplay Message Box\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EBrowser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EmsgBox\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"確認\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"是否要執行？\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E Browser\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EButtons\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token constant\"\u003EYES_NO\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"yes\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch2 id=\"write-gs-code-on-vscode\"\u003EWrite GS code on VSCode\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Ca target=\"_blank\" rel=\"nofollow\" href=\"https:\u002F\u002Fqiita.com\u002Fjooji\u002Fitems\u002F76f07f3f82900ebcd2b8\"\u003E[clasp]Google Apps Script を VSCode\u002FTypescript\u002FGit で書く。 - Qiita\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Ch2 id=\"backup-sheet\"\u003EBackup Sheet\u003C\u002Fh2\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E file \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E DriveApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetFileById\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'File ID'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E folder \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E DriveApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetFolderById\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E'Folder ID'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Econst\u003C\u002Fspan\u003E filename \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E file\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetName\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'_'\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E Utilities\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EformatDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003Enew\u003C\u002Fspan\u003E \u003Cspan class=\"token class-name\"\u003EDate\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'JST'\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'MM\u002Fdd\u002FHH:mm'\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\nfile\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EmakeCopy\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Efilename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E folder\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Ch3 id=\"conver-sheet-to-excel-file\"\u003EConver Sheet to excel file\u003C\u002Fh3\u003E\n\u003Cpre class=\"language-javascript\"\u003E\u003Ccode class=\"language-javascript\"\u003E\u003Cspan class=\"token comment\"\u003E\u002F\u002Fエクセルを返すURL\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E fetchUrl \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E\"https:\u002F\u002Fdocs.google.com\u002Ffeeds\u002Fdownload\u002Fspreadsheets\u002FExport?key=\"\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E\"シートID\"\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token string\"\u003E\"&amp;amp;exportFormat=xlsx\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002FOAuth\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E fetchOpt \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n  headers\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E Authorization\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"Bearer \"\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E ScriptApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetOAuthToken\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n  muteHttpExceptions\u003Cspan class=\"token operator\"\u003E:\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token comment\"\u003E\u002F\u002Fエクセルファイルゲット！\u003C\u002Fspan\u003E\n\u003Cspan class=\"token keyword\"\u003Evar\u003C\u002Fspan\u003E xlsxFile \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E UrlFetchApp\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Efetch\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EfetchUrl\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E fetchOpt\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EgetBlob\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n  \u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EsetName\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"任意の名前.xlsx\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E",date:"2020-08-25T03:21:09.000Z",excerpt:null,printDate:"August 25, 2020",printReadingTime:"5 min read",tags:["Google"],image:"https:\u002F\u002Ff6bfb5.github.io\u002Fpreview\u002Fgoogle-app-script-note.png"}}]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.33446b18.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@2.0.4.js";s.setAttribute("data-main","/client/client.33446b18.js")}document.head.appendChild(s)</script> 