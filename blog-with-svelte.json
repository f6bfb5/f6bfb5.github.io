{"title":"Blog with Svelte","slug":"blog-with-svelte","html":"<h4 id=\"anchor-links-using-remark-slug\">Anchor links using remark-slug</h4>\n<ul>\n<li><a onclick=\"document.location.hash='前言';\" href=\"javascript:;\">前言</a></li>\n<li><a onclick=\"document.location.hash='安裝-svelte';\" href=\"javascript:;\">安裝 Svelte</a></li>\n<li><a onclick=\"document.location.hash='whats-inside-it';\" href=\"javascript:;\">What&#39;s inside it?</a></li>\n<li><a onclick=\"document.location.hash='how-does-it-work';\" href=\"javascript:;\">How does it work?</a></li>\n</ul>\n<hr>\n<h2 id=\"前言\">前言</h2>\n<p>之前陸續試了幾個能搭配 Markdown 產生網頁的 library，像是 <a target=\"_blank\" rel=\"nofollow\" href=\"https://hexo.io/zh-tw/\">Hexo</a> 或 <a target=\"_blank\" rel=\"nofollow\" href=\"https://gridsome.org/\">Gridsome</a>，但對於內容幾乎只是給自己看的雜記的我來說，用起來總覺得有種殺雞用牛刀的感覺，趁著之前也有些許關注的 Svelte 在 2020 年興起熱潮，換了 <a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/Charca/sapper-blog-template\">Sapper 的 blog template</a> 來試試使用效果如何。</p>\n<p>（追記：原本是先看到 <a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/roxiness/routify-starter\">Routify 的 blog template</a> 覺得很不錯，但 Routify 似乎因為需要用到檔案路徑做 SPA，沒辦法 host 在 GitHub Pages 上，最後改用了 Sapper。參考：<a target=\"_blank\" rel=\"nofollow\" href=\"https://blog.huli.tw/2019/09/18/spa-common-problem-about-router/\">淺談新手在學習 SPA 時的常見問題：以 Router 為例 - Huli</a>）</p>\n<hr>\n<h2 id=\"sapper-blog-template\">Sapper Blog Template</h2>\n<h3 id=\"安裝\">安裝</h3>\n<pre class=\"language-bash\"><code class=\"language-bash\">npx degit Charca/sapper-blog-template your-blog-name\ncd your-blog-name\nnpm install # or yarn!\nnpm run dev</code></pre><h3 id=\"whats-inside-it\">What&#39;s inside it?</h3>\n<h4 id=\"svelte\"><a target=\"_blank\" rel=\"nofollow\" href=\"https://svelte.dev/\">Svelte</a></h4>\n<p>一套秉持「Write less code」的精神，為了建構 UI 而生的 JavaScript 編譯器，不採用 Virtual DOM diff，而是用原生 JS 直接修改 DOM，擁有相對優秀的執行速度與檔案大小表現。</p>\n<h4 id=\"sapper\"><a target=\"_blank\" rel=\"nofollow\" href=\"https://sapper.svelte.dev/\">Sapper</a></h4>\n<p>Sapper 是套定位類似於 React 的 Next.js、Vue 的 Nuxt.js 的 framework 工具，基於 Svelte 之上處理與補足了例如 SSR、SPA、SSG 這類製作應用的需求</p>\n<h3 id=\"how-does-it-work\">How does it work?</h3>\n<p>template 中的 blog 相關檔案位於 <code>src/routes/blog</code>，主要功能由以下三個檔案實作：</p>\n<ul>\n<li><code>_posts.js</code>：讀取和 parse markdown 檔案的 module</li>\n<li><code>[slug].svelte</code>：文章頁面的 template</li>\n<li><code>index.svelte</code>：文章列表的 template</li>\n</ul>\n<p>文章則放置於 <code>src/routes/blog/posts</code> 資料夾中，文章檔案名稱會 parse 成為網頁路徑，撰寫於文章開頭到 <code>＜!-- more --＞</code> 之間的內容會成為預覽部份，標題和日期記載在檔案內的 yaml 區域內</p>\n<p>由於個人沒有使用閱讀更多註記的功能，再改寫了 <code>src/utils/markdown.js</code> 裡判斷什麼東西要丟到社群預覽的部份（其實也就加了一行程式碼）：</p>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// gray-matter 用於轉換匯入檔案以 --- 隔開的區塊部份成為 object</span>\n<span class=\"token keyword\">const</span> matter <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gray-matter\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token comment\">// 首個區塊為 yaml 資訊區，其餘部份為文章內容</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> content<span class=\"token operator\">:</span> rawContent <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">matter</span><span class=\"token punctuation\">(</span>md<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token comment\">// 原本只有判斷「閱讀更多」是否存在，以及取得位於其上方的內容</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>rawContent<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token constant\">EXCERPT_SEPARATOR</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!==</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> splittedContent <span class=\"token operator\">=</span> rawContent<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token constant\">EXCERPT_SEPARATOR</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  excerpt <span class=\"token operator\">=</span> splittedContent<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  content <span class=\"token operator\">=</span> splittedContent<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// 加入不存在時，取得 yaml 裡 summary 標籤的內容</span>\n  excerpt <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>summary<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token comment\">// ...</span></code></pre><h3 id=\"更新之後\">更新之後</h3>\n<p>如果你升級了相依套件，可能會跳出與 <code>rollup-plugin-svelte</code> 相關的編譯錯誤，網頁也會出現錯誤，這是因為相關記述方式有修改的關係：</p>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/sveltejs/rollup-plugin-svelte\">sveltejs/rollup-plugin-svelte</a></li>\n</ul>\n<pre class=\"language-diff\"><code class=\"language-diff\">  client: {\n    // ...\n    plugins: [\n      // ...\n-       svelte({\n-        dev,\n-        hydratable: true,\n-        emitCss: true,\n-      }),\n-      resolve(),\n+      svelte({\n+        emitCss: true,\n+        compilerOptions: {\n+          hydratable: true,\n+        },\n+      }),\n+      resolve({ browser: true }),\n    ]\n    // ...\n  }\n\n  server: {\n    // ...\n    plugins: [\n      // ...\n-       svelte({\n-         generate: 'ssr',\n-         dev,\n-       }),\n-       resolve(),\n+       svelte({\n+         compilerOptions: {\n+           generate: 'ssr',\n+         },\n+       }),\n+       resolve({ browser: true }),\n    ]\n    // ...\n  }</code></pre><h4 id=\"circular-dependencies\">Circular Dependencies</h4>\n<p>運行時會出現的 circular dependecies 警告可以透過修改 <code>rollup.config.js</code> 裡的偵測部份解決</p>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/sveltejs/sapper-template/pull/246/files\">Silence preload export warnings related to TypeScript support</a></li>\n</ul>\n<pre class=\"language-diff\"><code class=\"language-diff\">- const onwarn = (warning, onwarn) =>\n-   (warning.code === 'CIRCULAR_DEPENDENCY' &amp;&amp;\n-     warning.message.includes('/@sapper/')) ||\n-   onwarn(warning)\n+ const onwarn = (warning, onwarn) =>\n+     (warning.code === 'MISSING_EXPORT' &amp;&amp; /'preload'/.test(warning.message)) ||\n+     (warning.code === 'CIRCULAR_DEPENDENCY' &amp;&amp; /[/\\\\]@sapper[/\\\\]/.test(warning.message)) ||\n+     onwarn(warning);</code></pre><h3 id=\"deploy\">Deploy</h3>\n<p>這次我參考了<a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/marketplace/actions/deploy-to-github-pages\">Deploy to GitHub Pages · Actions · GitHub Marketplace</a>，讓 GitHub Actions 在 push 原始碼上去之後跑 build 和 deploy 到 <code>gh-pages</code> branch，再將 <code>github.io</code> 的顯示來源改成 <code>gh-pages</code> branch</p>\n<p>與過往經驗比較不同的是，<code>npm run build</code> 生產出來的網頁仍然和 Routify 一樣需要後端伺服器，要改用 <code>npm run export</code> 讓 Sapper 自己爬一遍整個網站，產生出來的靜態頁面才能 host 到 GitHub Pages 上</p>\n<ol>\n<li>在專案資料夾根目錄底下新增一個 <code>.github</code> 資料夾</li>\n<li>在裡頭新增一個 <code>workflows</code> 資料夾</li>\n<li>在裡頭新增一個 <code>deploy-to-github-pages.yaml</code> 檔案</li>\n<li>貼上以下截取與修改自上方連結的內容</li>\n<li>檔案 push 到 GitHub 後，就會透過 GitHub Actions\n<br>把 build 完畢的檔案自動 branch 到 <code>gh-pages</code> 分支</li>\n</ol>\n<pre class=\"language-yml\"><code class=\"language-yml\">name: Build and Deploy\non: [push]\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n    steps:\n      - name: Checkout 🛎️\n        uses: actions/checkout@v2.3.1 # If you're using actions/checkout@v2 you must set persist-credentials to false in most cases for the deployment to work correctly.\n        with:\n          persist-credentials: false\n\n      - name: Install and Build 🔧 # This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.\n        run: |\n          npm install\n          npm run export\n\n      - name: Deploy 🚀\n        uses: JamesIves/github-pages-deploy-action@3.7.1\n        with:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n          BRANCH: gh-pages # The branch the action should deploy to.\n          FOLDER: __sapper__/export # The folder the action should deploy.\n          CLEAN: true # Automatically remove deleted files from the deploy branch</code></pre><h3 id=\"google-analytics\">Google Analytics</h3>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://analytics.google.com/analytics/web/\">Google Analytics</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://www.npmjs.com/package/sapper-google-analytics\">sapper-google-analytics - npm</a></li>\n</ul>\n<ol>\n<li>申請 GA 帳戶，點擊左下角的 <code>Admin</code> 開啟控制面板</li>\n<li>點擊 <code>Create Property</code> 建立資源，輸入名稱與選擇時區</li>\n<li>點擊下方的 <code>Show advanced options</code>，啟用 <code>Create a Universal Analytics property</code> 選項</li>\n<li>建立完成資源後，點擊 <code>Tracking Info</code> 底下的 <code>Tracking Code</code>，複製裡頭的 <code>Tracking ID</code></li>\n<li><code>npm i sapper-google-analytics</code></li>\n<li>編輯 <code>src/routes/_layout.svelte</code> 加上</li>\n</ol>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> GoogleAnalytics <span class=\"token keyword\">from</span> <span class=\"token string\">\"sapper-google-analytics/GoogleAnalytics.svelte\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> stores <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@sapper/app\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">let</span> ga_measurement_id <span class=\"token operator\">=</span> <span class=\"token string\">\"UA-SOMETHING\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 剛才複製的 Tracking ID</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>GoogleAnalytics</span> <span class=\"token attr-name\">{stores}</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{ga_measurement_id}<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre><p>完成後可以到 <code>Tracking Info</code> 裡的 <code>Tracking Code</code>\n<br>點選 <code>Send test traffic</code> 測試是否新增成功</p>\n<h3 id=\"google-adsense\">Google AdSense</h3>\n<p>（待）</p>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://stackoverflow.com/questions/60722757/how-do-i-call-adsense-auto-ads-on-route-change-for-spa-single-page-app\">svelte - How do I call AdSense Auto Ads on route change for SPA (single page app)? - Stack Overflow</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://github.com/sveltejs/sapper/issues/30\">Hooks · Issue #30 · sveltejs/sapper</a></li>\n</ul>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> stores <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@sapper/app\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> page<span class=\"token punctuation\">,</span> preloading<span class=\"token punctuation\">,</span> session <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">stores</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\npage<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> path<span class=\"token punctuation\">,</span> params<span class=\"token punctuation\">,</span> query <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// do amazing things</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre><h3 id=\"rss\">RSS</h3>\n<ol>\n<li>在 <code>src/routes/</code> 底下建立一個 <code>rss.xml.js</code>：\n<br>（檔案內的 <code>title</code>、<code>description</code> 等內容請自行修改）</li>\n</ol>\n<pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> posts <span class=\"token keyword\">from</span> <span class=\"token string\">\"./_posts.js\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> siteUrl <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">toRFC3339</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">date</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">n</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> n <span class=\"token operator\">&lt;</span> <span class=\"token number\">10</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"0\"</span> <span class=\"token operator\">+</span> n <span class=\"token operator\">:</span> n<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">timezoneOffset</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">offset</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> sign<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>offset <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    sign <span class=\"token operator\">=</span> offset <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span> <span class=\"token string\">\"_\"</span> <span class=\"token operator\">:</span> <span class=\"token string\">\"+\"</span><span class=\"token punctuation\">;</span>\n    offset <span class=\"token operator\">=</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">abs</span><span class=\"token punctuation\">(</span>offset<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> sign <span class=\"token operator\">+</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>offset <span class=\"token operator\">/</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span> <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>offset <span class=\"token operator\">%</span> <span class=\"token number\">60</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    date<span class=\"token punctuation\">.</span><span class=\"token function\">getFullYear</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    <span class=\"token string\">\"-\"</span> <span class=\"token operator\">+</span>\n    <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMonth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    <span class=\"token string\">\"-\"</span> <span class=\"token operator\">+</span>\n    <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getDate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    <span class=\"token string\">\"T\"</span> <span class=\"token operator\">+</span>\n    <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getHours</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span>\n    <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getMinutes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    <span class=\"token string\">\":\"</span> <span class=\"token operator\">+</span>\n    <span class=\"token function\">pad</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getSeconds</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span>\n    <span class=\"token function\">timezoneOffset</span><span class=\"token punctuation\">(</span>date<span class=\"token punctuation\">.</span><span class=\"token function\">getTimezoneOffset</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">renderXmlRssFeed</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">posts</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;?xml version=\"1.0\" encoding=\"utf-8\" ?>\n  &lt;rss version=\"2.0\">\n    &lt;channel>\n      &lt;title>Title Here&lt;/title>\n      &lt;link href=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>siteUrl<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"/>\n      &lt;description>Description Here&lt;/description>\n      &lt;lastBuildDate></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">toRFC3339</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/lastBuildDate>\n      &lt;managingEditor>example@example.com&lt;/managingEditor>\n\n      </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>posts\n        <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>\n          <span class=\"token punctuation\">(</span><span class=\"token parameter\">post</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\n        &lt;item>\n          &lt;title></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>post<span class=\"token punctuation\">.</span>title<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/title>\n          &lt;link></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>siteUrl<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/blog/</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>post<span class=\"token punctuation\">.</span>slug<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/link>\n          &lt;pubDate></span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token function\">toRFC3339</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>post<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">&lt;/pubDate>\n          &lt;description>\n              </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>post<span class=\"token punctuation\">.</span>excerpt<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n          &lt;/description>\n        &lt;/item>\n      </span><span class=\"token template-punctuation string\">`</span></span>\n        <span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\n    &lt;/channel>\n  &lt;/rss></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> res</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">writeHead</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"Cache-Control\"</span><span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">max-age=0, s-max-age=</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token number\">600</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// 10 minutes</span>\n    <span class=\"token string\">\"Content-Type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"application/rss+xml\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> feed <span class=\"token operator\">=</span> <span class=\"token function\">renderXmlRssFeed</span><span class=\"token punctuation\">(</span>posts<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  res<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span>feed<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre><ol start=\"2\">\n<li>在 Navbar 加上 RSS 連結：<code>&lt;a class={segment === &#39;rss&#39; ? &#39;selected&#39; : &#39;&#39;} href=&quot;rss.xml&quot;&gt;rss&lt;/a&gt;</code></li>\n</ol>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://sapper-goals.netlify.app/goals/easy-rss-and-sitemap/\">Easy RSS Feed &amp; Sitemap ✅</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://lacourt.dev/2019/06/29\">2019/06/29 - migrating to Sapper part 3 - RSS feed</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://cleverdev.codes/blog/rss-atom-and-site-map-for-svelte-sapper-blog-part-3/\">RSS/Atom and Site Map for Svelte/Sapper Blog - Part 3</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://dev.to/zechtyounes/how-to-render-your-sitemap-xml-file-in-your-svelte-sapper-blog-2joh\">How to render your sitemap.xml file in your Svelte/Sapper blog - DEV Community</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://dev.to/kevinconti/how-to-create-a-sapper-svelte-sitemap-3490\">How to create a Sapper / Svelte Sitemap - DEV Community</a></li>\n</ul>\n<hr>\n<summary>\n\n<h2 id=\"routify-blog-template\">Routify Blog Template</h2>\n</summary>\n<details>\n\n<h3 id=\"安裝-1\">安裝</h3>\n<pre class=\"language-bash\"><code class=\"language-bash\">mkdir svelte-md-blog\ncd svelte-md-blog\nnpx @sveltech/routify init --branch blog\nnpm run dev</code></pre><h3 id=\"whats-inside-it-1\">What&#39;s inside it?</h3>\n<h4 id=\"svelte-1\"><a target=\"_blank\" rel=\"nofollow\" href=\"https://svelte.dev/\">Svelte</a></h4>\n<p>一套秉持「Write less code」的精神，為了建構 UI 而生的 JavaScript 編譯器，不採用 Virtual DOM diff，而是用原生 JS 直接修改 DOM，擁有相對優秀的執行速度與檔案大小表現。</p>\n<h4 id=\"routify\"><a target=\"_blank\" rel=\"nofollow\" href=\"https://routify.dev/\">Routify</a></h4>\n<p>基於檔案系統結構的 Svelte routing library，因應檔案變更自動產生路由，並具有 SPA、SSR、PWA、產生 Meta Tags、分割 code 的功能。</p>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://qiita.com/sho0211/items/ea99738f69d4426dbb1e\">Routify (Svelte Router) をコードリーディングして完全に理解する - Qiita</a></li>\n</ul>\n<h4 id=\"mdsvex\"><a target=\"_blank\" rel=\"nofollow\" href=\"https://mdsvex.com/\">MDsveX</a></h4>\n<p>可以在 Markdown 裡使用 Svelte component、在 Svelte component 裡使用 Markdown 的 Library。</p>\n<h3 id=\"how-does-it-work-1\">How does it work?</h3>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n  <span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> layout<span class=\"token punctuation\">,</span> isActive<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">,</span> goto<span class=\"token punctuation\">,</span> page <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"@svelte/routify\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">export</span> <span class=\"token keyword\">let</span> node <span class=\"token operator\">=</span> $layout<span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span>\n  {#each node.children as node}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{$url(node.path)}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">class:</span>active</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>{$isActive(node.path)}<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token punctuation\">></span></span>{node.title}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span>\n    <span class=\"token punctuation\">></span></span>\n    {#if node.children.length}\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">svelte:</span>self</span> <span class=\"token attr-name\">{node}</span> <span class=\"token punctuation\">/></span></span>\n    {/if}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n  {/each}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span></code></pre><h3 id=\"setting-html-metatags\">Setting HTML metatags</h3>\n<ul>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://routify.dev/docs/metatags\">HTML Metatags - Routify</a></li>\n<li><a target=\"_blank\" rel=\"nofollow\" href=\"https://developers.facebook.com/docs/sharing/webmasters/\">網站管理員 - Sharing</a></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>Metatags</th>\n<th>說明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td><code>og:title</code></td>\n<td>網頁內容的標題，不包含網站名稱等任何品牌內容</td>\n</tr>\n<tr>\n<td><code>og:url</code></td>\n<td>網頁內容的網址，此網址應為標準網址（canonical URL）</td>\n</tr>\n<tr>\n<td><code>og:description</code></td>\n<td>內容的簡短說明，通常為 2 到 4 個句子</td>\n</tr>\n<tr>\n<td><code>og:image</code></td>\n<td>用戶將內容分享至 SNS 時顯示的圖像網址，建議為 <code>1.91:1</code> 比例、最小 <code>1200x630</code> 解析度</td>\n</tr>\n<tr>\n<td><code>og:type</code></td>\n<td>內容的媒體類型，每個網址都應該是單一物件，預設為 <code>website</code></td>\n</tr>\n<tr>\n<td><code>og:locale</code></td>\n<td>資源的地區設定，預設為 <code>en_US</code>，原生內容以非英文撰寫時才需設定</td>\n</tr>\n</tbody></table>\n<p><code>pages\\_layout.svelte</code></p>\n<pre class=\"language-svelte\"><code class=\"language-svelte\">$: metatags.title = $page.meta.frontmatter\n  ? $page.meta.frontmatter[\"title\"]\n  : `${$page.title}`;\n$: metatags.description = $page.meta.frontmatter\n  ? $page.meta.frontmatter[\"summary\"]\n  : \"\";\n\n$: metatags[\"twitter:title\"] = $page.meta.frontmatter\n  ? $page.meta.frontmatter[\"title\"]\n  : `${$page.title}`;\n$: metatags[\"twitter:description\"] = $page.meta.frontmatter\n  ? $page.meta.frontmatter[\"summary\"]\n  : \"\";</code></pre><h3 id=\"deploy-1\">Deploy</h3>\n<p>（待）</p>\n</details>\n","date":"1970-01-02T00:00:00.000Z","printDate":"January 2, 1970","printReadingTime":"6 min read"}