function u(){return u=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},u.apply(this,arguments)}const v=n=>String(n).split(".").map(r=>String(parseInt(r||"0",10))).concat(["0","0"]).slice(0,3).join(".");let S=class{constructor(){this.isSwupPlugin=!0,this.swup=void 0,this.version=void 0,this.requires={},this.handlersToUnregister=[]}mount(){}unmount(){this.handlersToUnregister.forEach(r=>r()),this.handlersToUnregister=[]}_beforeMount(){if(!this.name)throw new Error("You must define a name of plugin when creating a class.")}_afterUnmount(){}_checkRequirements(){return typeof this.requires!="object"||Object.entries(this.requires).forEach(([r,t])=>{if(!function(e,s,i){const a=function(c,h){var p;if(c==="swup")return(p=h.version)!=null?p:"";{var l;const d=h.findPlugin(c);return(l=d?.version)!=null?l:""}}(e,i);return!!a&&((c,h)=>h.every(p=>{const[,l,d]=p.match(/^([\D]+)?(.*)$/)||[];var m,f;return((w,y)=>{const b={"":o=>o===0,">":o=>o>0,">=":o=>o>=0,"<":o=>o<0,"<=":o=>o<=0};return(b[y]||b[""])(w)})((f=d,m=v(m=c),f=v(f),m.localeCompare(f,void 0,{numeric:!0})),l||">=")}))(a,s)}(r,t=Array.isArray(t)?t:[t],this.swup)){const e=`${r} ${t.join(", ")}`;throw new Error(`Plugin version mismatch: ${this.name} requires ${e}`)}}),!0}on(r,t,e={}){var s;t=!(s=t).name.startsWith("bound ")||s.hasOwnProperty("prototype")?t.bind(this):t;const i=this.swup.hooks.on(r,t,e);return this.handlersToUnregister.push(i),i}once(r,t,e={}){return this.on(r,t,u({},e,{once:!0}))}before(r,t,e={}){return this.on(r,t,u({},e,{before:!0}))}replace(r,t,e={}){return this.on(r,t,u({},e,{replace:!0}))}off(r,t){return this.swup.hooks.off(r,t)}};function g(){return g=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n},g.apply(this,arguments)}class O extends S{constructor(r={}){super(),this.name="SwupScriptsPlugin",this.requires={swup:">=4"},this.defaults={head:!0,body:!0,optin:!1},this.options=g({},this.defaults,r)}mount(){this.on("content:replace",this.runScripts)}runScripts(){const{head:r,body:t,optin:e}=this.options,s=this.getScope({head:r,body:t});if(!s)return;const i=Array.from(s.querySelectorAll(e?"script[data-swup-reload-script]":"script:not([data-swup-ignore-script])"));i.forEach(a=>this.runScript(a)),this.swup.log(`Executed ${i.length} scripts.`)}runScript(r){const t=document.createElement("script");for(const{name:e,value:s}of r.attributes)t.setAttribute(e,s);return t.textContent=r.textContent,r.replaceWith(t),t}getScope({head:r,body:t}){return r&&t?document:r?document.head:t?document.body:null}}export{O as default};
