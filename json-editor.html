<!DOCTYPE html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta name="generator" content="Astro v3.3.0"><link rel="icon" href="/favicon.ico"><title>JSON Editor</title><!-- OGP --><meta property="og:url" content="https://f6bfb5.github.io/json-editor.html"><meta property="og:type" content="article"><meta property="og:title" content="JSON Editor"><meta property="og:description" content=""><meta property="og:image" content="https://f6bfb5.github.io/images/json-editor.png"><link rel="stylesheet" href="/_astro/_slug_.d61fd585.css" />
<link rel="stylesheet" href="/_astro/_slug_.d57a4528.css" />
<style>h1[data-astro-cid-gkspkard]{margin:0;font-size:1em;color:var(--title-color);display:inline-block}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-8){animation:Title_red .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-7){animation:Title_orange .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-6){animation:Title_yellow .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-5){animation:Title_lime .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-4){animation:Title_green .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-3){animation:Title_cyan .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-2){animation:Title_blue .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n-1){animation:Title_purple .5s linear both}.title[data-astro-cid-gkspkard] span[data-astro-cid-gkspkard]:nth-child(9n){animation:Title_pink .5s linear both}@keyframes Title_red{0%{color:var(--bg-color);fill:transparent}50%{color:#e50020;fill:#e50020}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_orange{0%{color:var(--bg-color);fill:transparent}50%{color:#ec6c00;fill:#ec6c00}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_yellow{0%{color:var(--bg-color);fill:transparent}50%{color:#fbc600;fill:#fbc600}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_lime{0%{color:var(--bg-color);fill:transparent}50%{color:#6fba2c;fill:#6fba2c}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_green{0%{color:var(--bg-color);fill:transparent}50%{color:#008b38;fill:#008b38}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_cyan{0%{color:var(--bg-color);fill:transparent}50%{color:#009fe8;fill:#009fe8}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_blue{0%{color:var(--bg-color);fill:transparent}50%{color:#004da0;fill:#004da0}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_purple{0%{color:var(--bg-color);fill:transparent}50%{color:#910782;fill:#910782}to{color:var(--title-color);fill:var(--title-color)}}@keyframes Title_pink{0%{color:var(--bg-color);fill:transparent}50%{color:#e40065;fill:#e40065}to{color:var(--title-color);fill:var(--title-color)}}.date[data-astro-cid-5grsw2hi]{margin-right:1em;color:var(--title-color)}article[data-astro-cid-5grsw2hi]{padding:10px;border:1px solid var(--subtitle-color);box-shadow:2px 2px 0 var(--subtext-color),4px 4px 0 var(--title-color);background-color:#e5edc8}
</style><script type="module">
</script>
<script type="module" src="/_astro/page.75c7f027.js"></script></head><html lang="zh-Hant-TW" data-astro-cid-37fxchfa><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta name="generator" content="Astro v3.3.0"><link rel="icon" href="/favicon.ico"></head><body data-astro-cid-37fxchfa><header data-astro-cid-pux6a34n><nav data-astro-cid-pux6a34n><a href="/" data-astro-cid-pux6a34n> トリコじかけの明け暮れ</a><a href="/rss.xml" target="_blank" data-astro-cid-pux6a34n> rss</a><a style="display: none;" href="/sitemap.xml" target="_blank" data-astro-cid-pux6a34n> sitemap</a></nav></header><main class="container" data-astro-cid-37fxchfa><article data-astro-cid-5grsw2hi><span class="date" data-astro-cid-5grsw2hi>2024.01.19 Friday</span><h1 class="title" data-astro-cid-gkspkard><span style="animation-delay:125ms;width:" data-astro-cid-gkspkard>J</span><span style="animation-delay:150ms;width:" data-astro-cid-gkspkard>S</span><span style="animation-delay:175ms;width:" data-astro-cid-gkspkard>O</span><span style="animation-delay:200ms;width:" data-astro-cid-gkspkard>N</span><span style="animation-delay:225ms;width:.25em;" data-astro-cid-gkspkard> </span><span style="animation-delay:250ms;width:" data-astro-cid-gkspkard>E</span><span style="animation-delay:275ms;width:" data-astro-cid-gkspkard>d</span><span style="animation-delay:300ms;width:" data-astro-cid-gkspkard>i</span><span style="animation-delay:325ms;width:" data-astro-cid-gkspkard>t</span><span style="animation-delay:350ms;width:" data-astro-cid-gkspkard>o</span><span style="animation-delay:375ms;width:" data-astro-cid-gkspkard>r</span></h1><div x-data="data()">
  <input type="file" x-on:change="await handleFiles($event.target.files[0])">
  <div>
  <span x-text="content"></span>
  <span x-text="Object.keys(JSONData).length"></span>
  <button type="button" class="mr-3 text-sm bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded focus:outline-none focus:shadow-outline" x-show="Object.keys(JSONData).length > 0" x-on:click="download(JSON.stringify(JSONData), &#x27;download.json&#x27;, &#x27;application/json&#x27;)">
    Download
  </button>
  </div>
  <input type="text" class="mx-auto w-full px-2 py-1 border" x-show="Object.keys(JSONData).length > 0" x-model="search">
  <div class="w-full flex justify-center" x-show="Object.keys(JSONData).length > 0">
    <input type="text" class="border-b-2 border-gray-300 py-2" x-model="title">
    <input type="text" class="border-b-2 border-gray-300 py-2" x-model="episode">
    <button type="button" class="text-sm bg-blue-500 hover:bg-blue-700 text-white py-1 px-2 rounded focus:outline-none focus:shadow-outline break-keep" x-on:click="addHandler()">
      Add
    </button>
  </div>
  <!-- https://tailwindflex.com/@ip-leroy/table-for-user-management -->
  <table class="w-full text-md bg-white shadow-md rounded mb-4">
    <template x-for="(obj, index) in JSONData" :key="index">
      <tr class="border-b hover:bg-orange-100 bg-gray-100" x-show="obj.title.includes(search)">
        <td class="p-2">
          <span class="break-keep" x-text="index"></span>
        </td>
        <td class="p-3 px-5">
          <input type="text" class="w-full bg-transparent border-b-2 border-gray-300 py-2" x-model="obj.title">
        </td>
        <td class="p-2">
          <input type="text" class="w-full bg-transparent border-b-2 border-gray-300 py-2" x-model="obj.episode">
        </td>
        <td class="p-3 px-5">
          <button type="button" class="text-sm bg-red-500 hover:bg-red-700 text-white py-1 px-2 rounded focus:outline-none focus:shadow-outline break-keep" x-on:click="deleteHandler(index)">
            Delete
          </button>
        </td>
      </tr>
    </template>
  </table>
</div>
<script>
  // https://stackoverflow.com/questions/63233506/refreshing-data-after-the-fact-in-alpinejs
  function data() {
    return {
      content: '',
      JSONData: {},
      search: '',
      title: '',
      episode: '',

      async handleFiles(file) {
        this.content = file.name;
        // load file
        if (validateFileType(file.type)) {
          let reader = new FileReader();
          reader.readAsText(file);
          // https://open-code.tech/en/post-1424/
          await new Promise(resolve => reader.onload = (event) => {
            this.JSONData = JSON.parse(event.target.result);
            resolve();
          })
        }
      },
      // https://codepen.io/aggressivetea/details/OJbgZMj
      // https://stackoverflow.com/questions/44025984/how-to-filter-an-object-by-its-values-in-es6
      // async filteredData() {
      //   if (Object.keys(this.JSONData).length) {
      //     const filteredEntries = Object.entries(this.JSONData).filter(([, v]) => this.search.includes(v));
      //     return Object.fromEntries(filteredEntries);
      //   } else {
      //     return {};
      //   }
      // },
      deleteHandler(index) {
        delete this.JSONData[index];
        this.refreshData();
      },
      addHandler() {
        if (!isNaN(Number(this.episode))) {
          let newKey = Object.keys(this.JSONData).length + 1;
          let newData = { title: this.title, episode: Number(this.episode) };
          this.JSONData[newKey] = newData;
          this.title = '';
          this.episode = '';
        }
      },
      refreshData() {
        // https://stackoverflow.com/questions/4647817/javascript-object-rename-key
        let length = Object.keys(this.JSONData).length;
        let arr = Object.entries(this.JSONData);
        for (let i=0; i<length; i++) {
          arr[i][0] = i+1;
        }
        this.JSONData = Object.fromEntries(arr);
      }
    }
  }

  function validateFileType(inputFileType) {
    console.log('validateFileType()');
    let allowedType = ['application/json'];
      if (!allowedType.includes(inputFileType)) return false;
      return true;
  }

  function download(data, filename, type) {
    // https://stackoverflow.com/questions/13405129/create-and-save-a-file-with-javascript
    let file = new Blob([data], {type: type});

    let a = document.createElement("a");
    let url = URL.createObjectURL(file);
    a.href = url;
    a.download = filename;

    a.click();

    setTimeout(() => {
      document.body.removeChild(a);
      window.URL.revokeObjectURL(url);
    }, 0);
  }
</script></article></main><footer data-astro-cid-sz7xmlte><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-sz7xmlte>
CC BY-NC-SA 4.0
</a><div class="right" data-astro-cid-sz7xmlte>
Made with <span class="heart" data-astro-cid-sz7xmlte>❤️</span> and
<a href="https://astro.new/" target="_blank" rel="noreferrer noopener nofollow" data-astro-cid-sz7xmlte>
Astro
</a></div></footer></body><script async src="https://www.googletagmanager.com/gtag/js?id=G-CRDP7WTXSQ"></script><script>
window.dataLayer = window.dataLayer || [];
function gtag() {
  dataLayer.push(arguments);
}
gtag("js", new Date());

gtag("config", "G-CRDP7WTXSQ");
</script></html>