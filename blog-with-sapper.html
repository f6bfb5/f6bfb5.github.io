<!DOCTYPE html>
<html lang="zh-Hant-TW">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />

    <link
      rel="preload"
      href="./fonts/fusion-pixel.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />
    <link rel="preload prefetch" href="./global.css" as="style" />
    <link rel="stylesheet" href="./global.css" />
    <!-- <link rel="manifest" href="./manifest.json" /> -->
    <link rel="icon" type="image/png" href="./favicon.ico" />

    <!-- This contains the contents of the <svelte:head> component, if
	     the current page has one -->
    <meta http-equiv="content-security-policy" content=""><title>Blog with Sapper</title><script async src="https://www.googletagmanager.com/gtag/js?id=G-CRDP7WTXSQ" data-svelte="svelte-bhtlqr"></script><link rel="shortcut icon" href="/favicon.ico" data-svelte="svelte-1c8ynol"><link rel="bookmark" href="/favicon.ico" data-svelte="svelte-1c8ynol"><link rel="canonical" href="https://f6bfb5.github.io/blog-with-sapper" data-svelte="svelte-17ikmly"><meta property="og:url" content="https://f6bfb5.github.io/blog-with-sapper" data-svelte="svelte-17ikmly"><meta property="og:type" content="article" data-svelte="svelte-17ikmly">
    <meta property="og:title" content="Blog with Sapper" data-svelte="svelte-17ikmly">
    

    
    <meta property="og:image" data-svelte="svelte-17ikmly">

    <meta name="twitter:card" content="summary_large_image" data-svelte="svelte-17ikmly">
    <meta name="twitter:title" value="Blog with Sapper" data-svelte="svelte-17ikmly">
    
    <meta name="twitter:label1" value="Published on" data-svelte="svelte-17ikmly">
    <meta name="twitter:data1" value="Jan 1, 2022" data-svelte="svelte-17ikmly">
	<link rel="stylesheet" href="/_app/assets/pages/__layout.svelte-193c0755.css">
	<link rel="stylesheet" href="/_app/assets/Favicon-b368fcc0.css">
	<link rel="stylesheet" href="/_app/assets/_post-b23eb12b.css">
	<link rel="stylesheet" href="/_app/assets/BlinkAnchor-39834c8c.css">
	<link rel="stylesheet" href="/_app/assets/2020-what-i-have-read-on-internet-a90af8df.css">
	<link rel="stylesheet" href="/_app/assets/ACG-does-anno-hideaki-really-dont-know-what-he-is-making-e07ed009.css">
	<link rel="stylesheet" href="/_app/assets/ACG-one-way-heroics-all-achievement-note-a5c5ad12.css">
	<link rel="stylesheet" href="/_app/assets/login-with-discord-4c509c13.css">
	<link rel="stylesheet" href="/_app/assets/our-internet-history-3d74e48c.css">
	<link rel="stylesheet" href="/_app/assets/sticker-generator-a58d6bc5.css">
	<link rel="stylesheet" href="/_app/assets/template-719be9d5.css">
	<link rel="stylesheet" href="/_app/assets/BalloonQuote2-65b715a7.css">
	<link rel="stylesheet" href="/_app/assets/tool-list-creativity-74747bfb.css">
	<link rel="stylesheet" href="/_app/assets/tool-list-system-3ddf96e1.css">
	<link rel="stylesheet" href="/_app/assets/tool-list-website-69ff68c8.css">
	<link rel="stylesheet" href="/_app/assets/what-nft-is-not-17bf58b6.css">
	<link rel="modulepreload" href="/_app/start-cc34adcf.js">
	<link rel="modulepreload" href="/_app/chunks/index-fbf036c5.js">
	<link rel="modulepreload" href="/_app/chunks/index-1cea4c04.js">
	<link rel="modulepreload" href="/_app/chunks/paths-396f020f.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-33ddf72d.js">
	<link rel="modulepreload" href="/_app/chunks/Favicon-acbff943.js">
	<link rel="modulepreload" href="/_app/chunks/store-77699777.js">
	<link rel="modulepreload" href="/_app/pages/_slug_.svelte-ff50ec07.js">
	<link rel="modulepreload" href="/_app/chunks/11ty-note-b4575e63.js">
	<link rel="modulepreload" href="/_app/chunks/_post-7f95c25c.js">
	<link rel="modulepreload" href="/_app/chunks/BlinkAnchor-990cc0ff.js">
	<link rel="modulepreload" href="/_app/chunks/2020-what-i-have-read-on-internet-c831f83a.js">
	<link rel="modulepreload" href="/_app/chunks/2021-what-i-have-read-on-internet-8503a829.js">
	<link rel="modulepreload" href="/_app/chunks/2022-what-i-have-read-on-internet-3f92a0cc.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-Pause-And-Select-Apocalypse-1e5d3f36.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-char-counterattack-fans-interview-fe52f85b.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-difference-of-director-and-producer-61890f11.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-does-anno-hideaki-really-dont-know-what-he-is-making-2a52c903.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-evening-chat-of-game-xenogears-57864697.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-expression-of-light-and-heavy-c6a22097.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-games-done-quick-introduction-c258d924.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-linda-cube-introduction-d8853cf8.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-linda-cube-on-ps-archive-7d8a05ac.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-making-of-linda3-e7be052c.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-note-aa3bf99c.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-one-way-heroics-all-achievement-note-d0c3a3dd.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-random-thoughts-about-rockman-x-dive-f87fea29.js">
	<link rel="modulepreload" href="/_app/chunks/AutomaticColorText-5bdc8eae.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-rockman-1-tas-glitch-c71e7fe5.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-seino-tooru-52487e01.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-serial-experiments-lain-for-ps-ea8c5106.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-super-manga-book-list-868199e9.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-the-influences-of-naoko-yamada-f2da8a81.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-why-you-should-not-use-interpolation-on-anime-dfc7d19e.js">
	<link rel="modulepreload" href="/_app/chunks/ACG-yume-no-shima-de-aimashou-46114762.js">
	<link rel="modulepreload" href="/_app/chunks/auto-generate-eyecatch-image-for-blog-9f8f3187.js">
	<link rel="modulepreload" href="/_app/chunks/autohotkey-note-f34247da.js">
	<link rel="modulepreload" href="/_app/chunks/blog-with-hexo-46439f28.js">
	<link rel="modulepreload" href="/_app/chunks/blog-with-sapper-b54afed6.js">
	<link rel="modulepreload" href="/_app/chunks/blog-with-sveltekit-4c2cbb59.js">
	<link rel="modulepreload" href="/_app/chunks/capitalist-realism-mark-fisher-04134755.js">
	<link rel="modulepreload" href="/_app/chunks/dot-painting-note-6279618b.js">
	<link rel="modulepreload" href="/_app/chunks/escape-from-algorithm-with-rss-29bcef35.js">
	<link rel="modulepreload" href="/_app/chunks/how-do-you-like-wendesday-6da9c630.js">
	<link rel="modulepreload" href="/_app/chunks/how-to-check-font-family-name-in-computer-5d61d810.js">
	<link rel="modulepreload" href="/_app/chunks/login-with-discord-13bbea42.js">
	<link rel="modulepreload" href="/_app/chunks/mpv-46cb7498.js">
	<link rel="modulepreload" href="/_app/chunks/operating-with-keyboard-cbb8a6b1.js">
	<link rel="modulepreload" href="/_app/chunks/our-internet-history-929cce41.js">
	<link rel="modulepreload" href="/_app/chunks/search-engine-operators-20a45c3b.js">
	<link rel="modulepreload" href="/_app/chunks/sticker-generator-2d94edff.js">
	<link rel="modulepreload" href="/_app/chunks/LibLoader-ba1901e6.js">
	<link rel="modulepreload" href="/_app/chunks/template-720c9904.js">
	<link rel="modulepreload" href="/_app/chunks/BalloonQuote2-626ae51d.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-creativity-aea621e2.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-gaming-43c1b8bc.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-system-cfa13900.js">
	<link rel="modulepreload" href="/_app/chunks/tool-list-website-b8bec9e5.js">
	<link rel="modulepreload" href="/_app/chunks/use-foobar2k-to-listen-to-podcast-346b651c.js">
	<link rel="modulepreload" href="/_app/chunks/use-google-spreadsheet-as-database-2afde7a1.js">
	<link rel="modulepreload" href="/_app/chunks/what-nft-is-not-b3a6ca60.js">
	<link rel="modulepreload" href="/_app/chunks/why-is-life-so-boring-55814cf8.js">
  </head>
  <body>
    <!-- The application will be rendered inside this element,
	     because `app/client.js` references it -->
    








<div class="layout svelte-1avnl50" style=""><div class="loader-container svelte-1avnl50"><div class="loader svelte-v56dyc"><span class="loader-text loader-step1 svelte-v56dyc">/</span>
  <span class="loader-text loader-step1 svelte-v56dyc">-</span>
  <span class="loader-text loader-step1 svelte-v56dyc">\</span>
  <span class="loader-text loader-step1 svelte-v56dyc">|</span>
</div></div></div>

<div class="layout svelte-1avnl50" style="display: none;">
  
  <header class="svelte-ka06mn"><div class="header-container svelte-ka06mn"><div class="row svelte-ka06mn"><nav class="svelte-t90z2a"><a class=" svelte-t90z2a" href="/">トリコじかけの明け暮れ
  </a>
  <a class=" svelte-t90z2a" href="/about">about
  </a>
  <a class=" svelte-t90z2a" href="/rss.xml" target="_blank">rss
  </a>
  <a style="display: none;" href="/sitemap.xml" target="_blank" class="svelte-t90z2a">sitemap
  </a>
</nav>
      <a href="https://nico.ms/sm35957126" target="_blank" rel="noreferrer noopener" class="svelte-1m045v8"><img src="data:image/gif;base64,AAABAAEAEBAQAAAAAAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAABbl4Awr28AAAAAAC4pp4ACgUAAFomhAB4aGEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiIiQiQiIkREREREJCIiQRERERESIiJBEhEREREiIkFCQRFRESIiQRIRERFRIiJBEREREREiIkE2ZmZmESQiQWYAAAZhJCJBZgAABmEkIkFmAAAGYSQiQWYAAAZhRCJBZgAABmFEIkE2ZmZmMUQiQRERERERRCJERERERERCLABwAAgAMAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAwAA" alt="logo" class="svelte-1m045v8">
</a></div>
    </div>
</header>

  <main class="svelte-1avnl50">

<header class="svelte-1y1bvug"><h1 class="title svelte-1y1bvug"><span style="animation-delay: 125ms; " class="svelte-1y1bvug">B
      </span><span style="animation-delay: 150ms; " class="svelte-1y1bvug">l
      </span><span style="animation-delay: 175ms; " class="svelte-1y1bvug">o
      </span><span style="animation-delay: 200ms; " class="svelte-1y1bvug">g
      </span><span style="animation-delay: 225ms; width: .25em;" class="svelte-1y1bvug"> 
      </span><span style="animation-delay: 250ms; " class="svelte-1y1bvug">w
      </span><span style="animation-delay: 275ms; " class="svelte-1y1bvug">i
      </span><span style="animation-delay: 300ms; " class="svelte-1y1bvug">t
      </span><span style="animation-delay: 325ms; " class="svelte-1y1bvug">h
      </span><span style="animation-delay: 350ms; width: .25em;" class="svelte-1y1bvug"> 
      </span><span style="animation-delay: 375ms; " class="svelte-1y1bvug">S
      </span><span style="animation-delay: 400ms; " class="svelte-1y1bvug">a
      </span><span style="animation-delay: 425ms; " class="svelte-1y1bvug">p
      </span><span style="animation-delay: 450ms; " class="svelte-1y1bvug">p
      </span><span style="animation-delay: 475ms; " class="svelte-1y1bvug">e
      </span><span style="animation-delay: 500ms; " class="svelte-1y1bvug">r
      </span></h1>
  <p class="meta svelte-1y1bvug"><span class="date svelte-1y1bvug">Jan 1, 2022</span>
    <div class="tags svelte-1y1bvug"><span class="tag svelte-1y1bvug">F2E</span></div></p></header>
<div class="post--container svelte-1y1bvug"><article class="post--content svelte-1y1bvug"><h2 id="js-id-前言">前言</h2>
<p>之前陸續試了幾個能搭配 Markdown 產生網頁的 library，像是 <a href="https://hexo.io/zh-tw/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://hexo.io/zh-tw/" alt="Hexo"><span>Hexo</span></a> 或 <a href="https://gridsome.org/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://gridsome.org/" alt="Gridsome"><span>Gridsome</span></a>，但對於內容幾乎只是給自己看的雜記來說，用來總有種殺雞用牛刀的感覺，正好有些許關注的 Svelte 在 2020 年興起熱潮，就趁機換成了 <a href="https://github.com/Charca/sapper-blog-template" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/Charca/sapper-blog-template" alt="Sapper 的 blog template"><span>Sapper 的 blog template</span></a> 來試試使用效果如何。</p>
<p>（追記：原本是先看到 <a href="https://github.com/roxiness/routify-starter" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/roxiness/routify-starter" alt="Routify 的 blog template"><span>Routify 的 blog template</span></a> 覺得很不錯，但 Routify 需要用到檔案路徑做 SPA，沒辦法 host 在 GitHub Pages 上，最後改用了以 <a href="https://sapper.svelte.dev/docs" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://sapper.svelte.dev/docs" alt="Sapper"><span>Sapper</span></a> 建構的 blog template。）</p>
<hr>
<h2 id="js-id-sapper-blog-template">Sapper Blog Template</h2>
<h3>安裝</h3>
<pre class="language-bash"><!-- HTML_TAG_START --><code class="language-bash">npx degit Charca/sapper-blog-template your-blog-name
<span class="token builtin class-name">cd</span> your-blog-name
<span class="token function">npm</span> <span class="token function">install</span> <span class="token comment"># or yarn!</span>
<span class="token function">npm</span> run dev</code><!-- HTML_TAG_END --></pre>
<ul><li><code>npx</code> 是 npm 在 v5.2.0 之後內建的指令，提供暫時性執行某個 npm 套件的功能</li>
<li><code>degit</code> 是一套能供使用者直接取用現存 project 樣板的套件<ul><li>也可用 <code>npm i -g degit</code> 安裝後直接呼叫 <code>degit</code></li></ul></li></ul>
<h3>What’s inside it?</h3>
<ul><li><a href="https://svelte.dev/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://svelte.dev/" alt="Svelte"><span>Svelte</span></a><ul><li>一套秉持「Write less code」的精神，為了建構 UI 而生的 JavaScript 編譯器</li>
<li>不採用 Virtual DOM diff，使用原生 JS 直接修改 DOM，擁有相對優秀的執行速度與檔案大小表現</li></ul></li>
<li><a href="https://sapper.svelte.dev/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://sapper.svelte.dev/" alt="Sapper"><span>Sapper</span></a><ul><li>定位類似於 React 的 Next.js、Vue 的 Nuxt.js 的 framework 工具</li>
<li>基於 Svelte 處理與補足了如 SSR、SPA、SSG 等應用製作的需求</li></ul></li></ul>
<h3>How does it work?</h3>
<p>template 中的頁面相關檔案位於 <code>src/routes/blog</code>，主要功能由以下三個檔案實作：</p>
<ul><li><code>_posts.js</code>：讀取和 parse markdown 檔案的 module</li>
<li><code>[slug].svelte</code>：文章頁面的 template</li>
<li><code>index.svelte</code>：文章列表的 template</li></ul>
<p>文章檔案則放置於 <code>src/routes/blog/posts</code> 資料夾中，檔案名稱會 parse 成為網頁路徑，撰寫於文章開頭到 <code>&lt;!-- more --&gt;</code> 之間的內容會成為預覽部份，標題和日期記載在檔案內的 yaml 區域內</p>
<p>這邊我改寫了 <code>src/utils/markdown.js</code> 裡要丟到社群預覽的部份：</p>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token comment">// gray-matter 用於 parse yaml 區域部份的內容</span>
<span class="token keyword">const</span> matter <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"gray-matter"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 首個區塊為 yaml 資訊區，其餘部份為文章內容</span>
<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> data<span class="token punctuation">,</span> <span class="token literal-property property">content</span><span class="token operator">:</span> rawContent <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">matter</span><span class="token punctuation">(</span>md<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>
<span class="token comment">// 判斷「閱讀更多」區域是否存在，若存在則取得位於其上方的內容</span>
<span class="token comment">// 並存入預覽內容部份</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>rawContent<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token constant">EXCERPT_SEPARATOR</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">const</span> splittedContent <span class="token operator">=</span> rawContent<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token constant">EXCERPT_SEPARATOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  excerpt <span class="token operator">=</span> splittedContent<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  content <span class="token operator">=</span> splittedContent<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token comment">// 新增不存在時，改為取得 yaml 裡 summary 標籤的內容</span>
  excerpt <span class="token operator">=</span> data<span class="token punctuation">.</span>summary<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// ...</span></code><!-- HTML_TAG_END --></pre>
<h3>更新版本</h3>
<p>如果你用 <code>npm run update</code> 升級了相依套件，可能會跳出與 <code>rollup-plugin-svelte</code> 相關的編譯錯誤，網頁也會出現錯誤，這是因為相關記述方式有修改的關係：</p>
<ul><li><a href="https://github.com/sveltejs/rollup-plugin-svelte" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/sveltejs/rollup-plugin-svelte" alt="sveltejs/rollup-plugin-svelte"><span>sveltejs/rollup-plugin-svelte</span></a></li></ul>
<pre class="language-diff"><!-- HTML_TAG_START --><code class="language-diff"><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> client: &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // ...
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       svelte(&#123;
</span><span class="token prefix deleted">-</span><span class="token line">        dev,
</span><span class="token prefix deleted">-</span><span class="token line">        hydratable: true,
</span><span class="token prefix deleted">-</span><span class="token line">        emitCss: true,
</span><span class="token prefix deleted">-</span><span class="token line">      &#125;),
</span><span class="token prefix deleted">-</span><span class="token line">      resolve(),
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      svelte(&#123;
</span><span class="token prefix inserted">+</span><span class="token line">        emitCss: true,
</span><span class="token prefix inserted">+</span><span class="token line">        compilerOptions: &#123;
</span><span class="token prefix inserted">+</span><span class="token line">          hydratable: true,
</span><span class="token prefix inserted">+</span><span class="token line">        &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">      &#125;),
</span><span class="token prefix inserted">+</span><span class="token line">      resolve(&#123; browser: true &#125;),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;
</span></span>
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> server: &#123;
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">     // ...
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">       svelte(&#123;
</span><span class="token prefix deleted">-</span><span class="token line">         generate: 'ssr',
</span><span class="token prefix deleted">-</span><span class="token line">         dev,
</span><span class="token prefix deleted">-</span><span class="token line">       &#125;),
</span><span class="token prefix deleted">-</span><span class="token line">       resolve(),
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       svelte(&#123;
</span><span class="token prefix inserted">+</span><span class="token line">         compilerOptions: &#123;
</span><span class="token prefix inserted">+</span><span class="token line">           generate: 'ssr',
</span><span class="token prefix inserted">+</span><span class="token line">         &#125;,
</span><span class="token prefix inserted">+</span><span class="token line">       &#125;),
</span><span class="token prefix inserted">+</span><span class="token line">       resolve(&#123; browser: true &#125;),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line">   // ...
</span><span class="token prefix unchanged"> </span><span class="token line"> &#125;</span></span></code><!-- HTML_TAG_END --></pre>
<h3>Circular Dependencies</h3>
<p>運行時會出現的 circular dependecies 警告，可以透過修改 <code>rollup.config.js</code> 裡的偵測部份解決：</p>
<ul><li><a href="https://github.com/sveltejs/sapper-template/pull/246/files" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/sveltejs/sapper-template/pull/246/files" alt="Silence preload export warnings related to TypeScript support"><span>Silence preload export warnings related to TypeScript support</span></a></li></ul>
<pre class="language-diff"><!-- HTML_TAG_START --><code class="language-diff"><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line"> const onwarn = (warning, onwarn) =>
</span><span class="token prefix deleted">-</span><span class="token line">   (warning.code === 'CIRCULAR_DEPENDENCY' &amp;&amp;
</span><span class="token prefix deleted">-</span><span class="token line">     warning.message.includes('/@sapper/')) ||
</span><span class="token prefix deleted">-</span><span class="token line">   onwarn(warning)
</span></span>
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line"> const onwarn = (warning, onwarn) =>
</span><span class="token prefix inserted">+</span><span class="token line"> 	(warning.code === 'MISSING_EXPORT' &amp;&amp; /'preload'/.test(warning.message)) ||
</span><span class="token prefix inserted">+</span><span class="token line"> 	(warning.code === 'CIRCULAR_DEPENDENCY' &amp;&amp; /[/\]@sapper[/\]/.test(warning.message)) ||
</span><span class="token prefix inserted">+</span><span class="token line"> 	onwarn(warning);</span></span></code><!-- HTML_TAG_END --></pre>
<h3>Deploy</h3>
<ul><li><a href="https://github.com/marketplace/actions/deploy-to-github-pages" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/marketplace/actions/deploy-to-github-pages" alt="Deploy to GitHub Pages"><span>Deploy to GitHub Pages</span></a></li></ul>
<p>讓 GitHub Actions 在原始碼 push 上去之後，去跑 build 和 deploy 到 <code>gh-pages</code> branch，並將 <code>github.io</code> 的顯示來源改成 <code>gh-pages</code> branch</p>
<p>與過往經驗比較不同的是，<code>npm run build</code> 生產出來的網頁仍然和 Routify 一樣需要後端伺服器，要改用 <code>npm run export</code> 讓 Sapper 自己爬一遍整個網站，所產生出來的靜態頁面才能 host 到 GitHub Pages 上</p>
<h4>GitHub Actions</h4>
<ol><li>在專案資料夾根目錄底下新增一個 <code>.github</code> 資料夾</li>
<li>在裡頭新增一個 <code>workflows</code> 資料夾</li>
<li>在裡頭新增一個 <code>deploy-to-github-pages.yaml</code> 檔案</li>
<li>貼上以下截取與修改自上方連結的內容</li>
<li>檔案 push 到 GitHub 後，就會透過 GitHub Actions<br>
把 build 完畢的檔案自動 branch 到 <code>gh-pages</code> 分支</li></ol>
<pre class="language-yml"><!-- HTML_TAG_START --><code class="language-yml"><span class="token key atrule">name</span><span class="token punctuation">:</span> Build and Deploy
<span class="token key atrule">on</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>push<span class="token punctuation">]</span>
<span class="token key atrule">jobs</span><span class="token punctuation">:</span>
  <span class="token key atrule">build-and-deploy</span><span class="token punctuation">:</span>
    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> ubuntu<span class="token punctuation">-</span>latest
    <span class="token key atrule">steps</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Checkout 🛎️
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v2.3.1 <span class="token comment"># If you're using actions/checkout@v2 you must set persist-credentials to false in most cases for the deployment to work correctly.</span>
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">persist-credentials</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install and Build 🔧 <span class="token comment"># This example project is built using npm and outputs the result to the 'build' folder. Replace with the commands required to build your project, or remove this step entirely if your site is pre-built.</span>
        <span class="token key atrule">run</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
          npm install
          npm run export</span>

      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Deploy 🚀
        <span class="token key atrule">uses</span><span class="token punctuation">:</span> JamesIves/github<span class="token punctuation">-</span>pages<span class="token punctuation">-</span>deploy<span class="token punctuation">-</span>action@3.7.1
        <span class="token key atrule">with</span><span class="token punctuation">:</span>
          <span class="token key atrule">GITHUB_TOKEN</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> secrets.GITHUB_TOKEN <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
          <span class="token key atrule">BRANCH</span><span class="token punctuation">:</span> gh<span class="token punctuation">-</span>pages <span class="token comment"># The branch the action should deploy to.</span>
          <span class="token key atrule">FOLDER</span><span class="token punctuation">:</span> __sapper__/export <span class="token comment"># The folder the action should deploy.</span>
          <span class="token key atrule">CLEAN</span><span class="token punctuation">:</span> <span class="token boolean important">true</span> <span class="token comment"># Automatically remove deleted files from the deploy branch</span></code><!-- HTML_TAG_END --></pre>
<h2 id="js-id-追加功能">追加功能</h2>
<h3>加入 Google Analytics</h3>
<ul><li><a href="https://analytics.google.com/analytics/web/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://analytics.google.com/analytics/web/" alt="Google Analytics"><span>Google Analytics</span></a></li>
<li><a href="https://www.npmjs.com/package/sapper-google-analytics" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://www.npmjs.com/package/sapper-google-analytics" alt="sapper-google-analytics"><span>sapper-google-analytics</span></a></li></ul>
<ol><li>申請 GA 帳戶，點擊左下角的 <code>Admin</code> 開啟控制面板</li>
<li>點擊 <code>Create Property</code> 建立資源，輸入名稱與選擇時區</li>
<li>點擊下方的 <code>Show advanced options</code><br>
啟用 <code>Create a Universal Analytics property</code> 選項</li>
<li>資源建立完成後，點擊 <code>Tracking Info</code> 底下的 <code>Tracking Code</code><br>
複製裡頭的 <code>Tracking ID</code></li>
<li><code>npm i sapper-google-analytics</code></li>
<li>編輯 <code>src/routes/_layout.svelte</code> 加上下方程式碼</li>
<li>完成後可以到 <code>Tracking Info</code> 裡的 <code>Tracking Code</code><br>點選 `Send test traffic` 測試是否新增成功</li></ol>
<pre class="language-html"><!-- HTML_TAG_START --><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>
  import GoogleAnalytics from "sapper-google-analytics/GoogleAnalytics.svelte";
  import &#123; stores &#125; from "@sapper/app";

  // 剛才複製的 Tracking ID
  let ga_measurement_id = "UA-SOMETHING";
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>GoogleAnalytics</span> <span class="token attr-name">&#123;stores&#125;</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>&#123;ga_measurement_id&#125;<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span></code><!-- HTML_TAG_END --></pre>
<h3>RSS</h3>
<ol><li>在 <code>src/routes/</code> 底下建立一個 <code>rss.xml.js</code>：<br>
（檔案內的 <code>title</code>、<code>description</code> 等內容請自行修改）</li></ol>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">import</span> posts <span class="token keyword">from</span> <span class="token string">"./_posts.js"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> siteUrl <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">toRFC3339</span><span class="token punctuation">(</span><span class="token parameter">date</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">function</span> <span class="token function">pad</span><span class="token punctuation">(</span><span class="token parameter">n</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> n <span class="token operator">&lt;</span> <span class="token number">10</span> <span class="token operator">?</span> <span class="token string">"0"</span> <span class="token operator">+</span> n <span class="token operator">:</span> n<span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">function</span> <span class="token function">timezoneOffset</span><span class="token punctuation">(</span><span class="token parameter">offset</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> sign<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>offset <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> <span class="token string">"Z"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    sign <span class="token operator">=</span> offset <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">"_"</span> <span class="token operator">:</span> <span class="token string">"+"</span><span class="token punctuation">;</span>
    offset <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> sign <span class="token operator">+</span> <span class="token function">pad</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>offset <span class="token operator">/</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">":"</span> <span class="token operator">+</span> <span class="token function">pad</span><span class="token punctuation">(</span>offset <span class="token operator">%</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    date<span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">"-"</span> <span class="token operator">+</span>
    <span class="token function">pad</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">"-"</span> <span class="token operator">+</span>
    <span class="token function">pad</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">"T"</span> <span class="token operator">+</span>
    <span class="token function">pad</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">":"</span> <span class="token operator">+</span>
    <span class="token function">pad</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token string">":"</span> <span class="token operator">+</span>
    <span class="token function">pad</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
    <span class="token function">timezoneOffset</span><span class="token punctuation">(</span>date<span class="token punctuation">.</span><span class="token function">getTimezoneOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">const</span> <span class="token function-variable function">renderXmlRssFeed</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">posts</span><span class="token punctuation">)</span> <span class="token operator">=></span>
  <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">&lt;?xml version="1.0" encoding="utf-8" ?>
  &lt;rss version="2.0">
    &lt;channel>
      &lt;title>Title Here&lt;/title>
      &lt;link href="</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>siteUrl<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">"/>
      &lt;description>Description Here&lt;/description>
      &lt;lastBuildDate></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">toRFC3339</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/lastBuildDate>
      &lt;managingEditor>example@example.com&lt;/managingEditor>

      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>posts
        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
          <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">
        &lt;item>
          &lt;title></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>post<span class="token punctuation">.</span>title<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/title>
          &lt;link></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>siteUrl<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/blog/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>post<span class="token punctuation">.</span>slug<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/link>
          &lt;pubDate></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token function">toRFC3339</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>post<span class="token punctuation">.</span>date<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/pubDate>
          &lt;description>
              </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>post<span class="token punctuation">.</span>excerpt<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
          &lt;/description>
        &lt;/item>
      </span><span class="token template-punctuation string">&#96;</span></span>
        <span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&#92;n"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
    &lt;/channel>
  &lt;/rss></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string-property property">"Cache-Control"</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">max-age=0, s-max-age=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token number">600</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">,</span> <span class="token comment">// 10 minutes</span>
    <span class="token string-property property">"Content-Type"</span><span class="token operator">:</span> <span class="token string">"application/rss+xml"</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> feed <span class="token operator">=</span> <span class="token function">renderXmlRssFeed</span><span class="token punctuation">(</span>posts<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>feed<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<ol start="2"><li>在 Navbar 加上 RSS 連結：<code>&lt;a class={segment === &#39;rss&#39; ? &#39;selected&#39; : &#39;&#39;} href=&quot;rss.xml&quot;&gt;rss&lt;/a&gt;</code></li></ol>
<ul><li><a href="https://sapper-goals.netlify.app/goals/easy-rss-and-sitemap/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://sapper-goals.netlify.app/goals/easy-rss-and-sitemap/" alt="Easy RSS Feed & Sitemap ✅"><span>Easy RSS Feed &amp; Sitemap ✅</span></a></li>
<li><a href="https://lacourt.dev/2019/06/29" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://lacourt.dev/2019/06/29" alt="2019/06/29 - migrating to Sapper part 3 - RSS feed"><span>2019/06/29 - migrating to Sapper part 3 - RSS feed</span></a></li>
<li><a href="https://cleverdev.codes/blog/rss-atom-and-site-map-for-svelte-sapper-blog-part-3/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://cleverdev.codes/blog/rss-atom-and-site-map-for-svelte-sapper-blog-part-3/" alt="RSS/Atom and Site Map for Svelte/Sapper Blog"><span>RSS/Atom and Site Map for Svelte/Sapper Blog</span></a></li></ul>
<h3>Sitemap</h3>
<ul><li>在 <code>src/routes/</code> 底下建立一個 <code>sitemap.xml.js</code>：<br>
（檔案內的 <code>siteUrl</code> 等內容請自行修改）</li></ul>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token keyword">import</span> posts <span class="token keyword">from</span> <span class="token string">"./_posts.js"</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> siteUrl <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"fs"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> pages <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

fs<span class="token punctuation">.</span><span class="token function">readdirSync</span><span class="token punctuation">(</span><span class="token string">"./src/routes"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  file <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    file<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">"_"</span> <span class="token operator">&amp;&amp;</span>
    file <span class="token operator">!==</span> <span class="token string">"sitemap"</span> <span class="token operator">&amp;&amp;</span>
    file <span class="token operator">!==</span> <span class="token string">"index"</span> <span class="token operator">&amp;&amp;</span>
    file <span class="token operator">!==</span> <span class="token string">"[slug]"</span>
  <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    pages<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">render</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">pages<span class="token punctuation">,</span> posts</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">&lt;?xml version="1.0" encoding="UTF-8" ?>
&lt;urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd">
  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>pages
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">page</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">
    &lt;url>
      &lt;loc></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>siteUrl<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>page<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/loc>
      &lt;lastmod></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/lastmod>
      &lt;priority>1.00&lt;/priority>
    &lt;/url>
  </span><span class="token template-punctuation string">&#96;</span></span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&#92;n"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
  </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>posts
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token parameter">post</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">
    &lt;url>
      &lt;loc></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>siteUrl<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">/blog/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>post<span class="token punctuation">.</span>slug<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/loc>
      &lt;lastmod></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>post<span class="token punctuation">.</span>printDate<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span>
        <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token operator">-</span><span class="token number">1</span>
      <span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&lt;/lastmod>
      &lt;priority>0.80&lt;/priority>
    &lt;/url>
  </span><span class="token template-punctuation string">&#96;</span></span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">"&#92;n"</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">
&lt;/urlset>
</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Cache-Control"</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">max-age=0, s-max-age=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token number">600</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10 minutes</span>
  res<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/rss+xml"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> sitemap <span class="token operator">=</span> <span class="token function">render</span><span class="token punctuation">(</span>pages<span class="token punctuation">,</span> posts<span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span>sitemap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<ul><li>為了 export 時 <code>sitemap.xml</code> 也要渲染<br>
修改 <code>index.svelte</code> 裡的 <code>preload</code> function</li></ul>
<pre class="language-diff"><!-- HTML_TAG_START --><code class="language-diff"><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script context="module">
</span></span><span class="token deleted-sign deleted"><span class="token prefix deleted">-</span><span class="token line">   export function preload(&#123; params, query &#125;) &#123;
</span><span class="token prefix deleted">-</span><span class="token line">     return this.fetch(&#96;index.json&#96;)
</span><span class="token prefix deleted">-</span><span class="token line">       .then((r) => r.json())
</span><span class="token prefix deleted">-</span><span class="token line">       .then((posts) => &#123;
</span><span class="token prefix deleted">-</span><span class="token line">         return &#123; posts &#125;;
</span><span class="token prefix deleted">-</span><span class="token line">       &#125;);
</span><span class="token prefix deleted">-</span><span class="token line">   &#125;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script>
</span></span>
<span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">script context="module">
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   export async function preload(&#123; params, query &#125;) &#123;
</span><span class="token prefix inserted">+</span><span class="token line">     const posts = await this.fetch(&#96;index.json&#96;)
</span><span class="token prefix inserted">+</span><span class="token line">       .then((r) => r.json())
</span><span class="token prefix inserted">+</span><span class="token line">       .then((posts) => &#123;
</span><span class="token prefix inserted">+</span><span class="token line">         return posts;
</span><span class="token prefix inserted">+</span><span class="token line">       &#125;);
</span><span class="token prefix inserted">+</span><span class="token line">     const sitemap = await this.fetch("sitemap.xml");
</span><span class="token prefix inserted">+</span><span class="token line">     return &#123; posts &#125;;
</span><span class="token prefix inserted">+</span><span class="token line">   &#125;
</span></span><span class="token deleted-arrow deleted"><span class="token prefix deleted">&lt;</span><span class="token line">/script></span></span></code><!-- HTML_TAG_END --></pre>
<ul><li><a href="https://dev.to/zechtyounes/how-to-render-your-sitemap-xml-file-in-your-svelte-sapper-blog-2joh" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://dev.to/zechtyounes/how-to-render-your-sitemap-xml-file-in-your-svelte-sapper-blog-2joh" alt="How to render your sitemap.xml file in your Svelte/Sapper blog - DEV Community"><span>How to render your sitemap.xml file in your Svelte/Sapper blog - DEV Community</span></a></li>
<li><a href="https://dev.to/kevinconti/how-to-create-a-sapper-svelte-sitemap-3490" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://dev.to/kevinconti/how-to-create-a-sapper-svelte-sitemap-3490" alt="How to create a Sapper / Svelte Sitemap - DEV Community"><span>How to create a Sapper / Svelte Sitemap - DEV Community</span></a></li></ul>
<h3>響應式 iframe</h3>
<p>如果想在文章裡放入 Youtube 嵌入影片，還需要另外修改 <code>iframe</code> 部份的 CSS 實作響應式效果，避免在視窗大小改變或在手機上瀏覽時，造成版面跑掉</p>
<iframe title="Liz and the Blue Bird" src="https://www.youtube.com/embed/OGWO3u8zgTU" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p><code>global.css</code></p>
<pre class="language-css"><!-- HTML_TAG_START --><code class="language-css"><span class="token selector">:root</span> <span class="token punctuation">&#123;</span>
  <span class="token property">--margin</span><span class="token punctuation">:</span> 2rem<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token selector">iframe</span> <span class="token punctuation">&#123;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100vw - <span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--margin<span class="token punctuation">)</span> * 2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span><span class="token punctuation">(</span>100vw - <span class="token punctuation">(</span><span class="token function">var</span><span class="token punctuation">(</span>--margin<span class="token punctuation">)</span> * 2<span class="token punctuation">)</span><span class="token punctuation">)</span> / 1.7778<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></code><!-- HTML_TAG_END --></pre>
<ul><li><a href="https://dev.to/bitdweller/responsive-iframe-without-a-parent-container-367k" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://dev.to/bitdweller/responsive-iframe-without-a-parent-container-367k" alt="Responsive iframe without a parent container - DEV Community"><span>Responsive iframe without a parent container - DEV Community</span></a></li></ul>
<h3>留言</h3>
<p>有數套如 <a href="https://github.com/adtac/commento" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/adtac/commento" alt="Commento"><span>Commento</span></a>、<a href="https://remark42.com/demo/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://remark42.com/demo/" alt="Remark42"><span>Remark42</span></a>、<a href="https://posativ.org/isso/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://posativ.org/isso/" alt="Isso"><span>Isso</span></a> 的 self-hosted 留言版，可以搭配 Heroku 使用 <a href="https://github.com/fidiego/commento-heroku" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/fidiego/commento-heroku" alt="commento-heroku"><span>commento-heroku</span></a> 架設，或是使用 GitHub Issues 作為留言版的 <a href="https://utteranc.es/" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://utteranc.es/" alt="utterances"><span>utterances</span></a></p>
<h3>Dark Mode</h3>
<p>（待）</p>
<h3>Mermaid.js</h3>
<ul><li><p><code>Mermaid.js</code> 是一套可以使用文字格式繪製甘特圖或流程圖的套件</p></li>
<li><p>由於從套件安裝會有相依版本上的問題，故直接從 cdn 引入套件</p>
<ul><li><code>d3.js</code> 僅可使用 ESM，無法再以套件內撰寫的 <code>require(&quot;d3&quot;)</code> 引入</li>
<li><a href="https://github.com/mermaid-js/mermaid/issues/2677" rel="noopener" target="_blank"><img src="https://s2.googleusercontent.com/s2/favicons?domain=https://github.com/mermaid-js/mermaid/issues/2677" alt="esbuild error: Error "><span>esbuild error: Error </span></a></li></ul></li>
<li><p><code>markdown.js</code></p>
<pre class="language-javascript"><!-- HTML_TAG_START --><code class="language-javascript"><span class="token comment">// ...</span>
renderer<span class="token punctuation">.</span><span class="token function-variable function">code</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">code<span class="token punctuation">,</span> language</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>language <span class="token operator">==</span> <span class="token string">"mermaid"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token string">'&lt;pre class="mermaid">'</span> <span class="token operator">+</span> code <span class="token operator">+</span> <span class="token string">"&lt;/pre>"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">;</span></code><!-- HTML_TAG_END --></pre></li>
<li><p><code>[slug].svelte</code></p>
<pre class="language-html"><!-- HTML_TAG_START --><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span>
  // ...
  import &#123; onMount &#125; from "svelte";
  onMount(async () => &#123;
    mermaid.init();
  &#125;);
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token namespace">svelte:</span>head</span><span class="token punctuation">></span></span>
  <span class="token comment">&lt;!-- ... --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span>
    <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js<span class="token punctuation">"</span></span>
  <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token namespace">svelte:</span>head</span><span class="token punctuation">></span></span></code><!-- HTML_TAG_END --></pre></li></ul>
<pre class="language-mermaid"><!-- HTML_TAG_START --><code class="language-mermaid"><span class="token keyword">graph</span> TB
  F<span class="token text string">[Gatsby]</span>
  F <span class="token arrow operator">--></span> G
  F <span class="token arrow operator">--></span> Github

  <span class="token keyword">subgraph</span> build
    S<span class="token text string">[(Sanity)]</span>
    G<span class="token text string">&#123;GraphQL&#125;</span>
    GH<span class="token text string">[(Github)]</span>

    G <span class="token arrow operator">--></span> GH
    G <span class="token arrow operator">--></span> S
  <span class="token keyword">end</span>

  <span class="token keyword">subgraph</span> deploy
    Github<span class="token arrow operator">--></span>Netlify
    Netlify<span class="token arrow operator">--></span>Y<span class="token text string">&#123;&#123;You&#125;&#125;</span>
  <span class="token keyword">end</span></code><!-- HTML_TAG_END --></pre>
<pre class="language-mermaid"><!-- HTML_TAG_START --><code class="language-mermaid"><span class="token keyword">sequenceDiagram</span>
    <span class="token keyword">participant</span> Client
    <span class="token keyword">participant</span> Auth server
    Client<span class="token arrow operator">->></span>Auth server<span class="token operator">:</span> Client credentials
    Auth server<span class="token arrow operator">->></span>Auth server<span class="token operator">:</span> Authenticate client
    Auth server<span class="token arrow operator">->></span>Client<span class="token operator">:</span> Access token
    Client<span class="token arrow operator">->></span>API<span class="token operator">:</span> Access protected API with access token
    API<span class="token arrow operator">->></span>Client<span class="token operator">:</span> Success</code><!-- HTML_TAG_END --></pre>
<div class="toc-container"><ul class="toc"><li><a href="#" onclick="document.querySelector('#js-id-前言').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">前言</a></li><li><a href="#" onclick="document.querySelector('#js-id-sapper-blog-template').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">Sapper Blog Template</a></li><li><a href="#" onclick="document.querySelector('#js-id-追加功能').scrollIntoView(); window.scrollBy(0, -128); event.preventDefault();">追加功能</a></li></ul></div>
    <span class="blink svelte-1kip24n">_</span></article>
  

<div class="back-to-top svelte-1p7rwza hidden" style="right: 2em">Back to top
</div>
</div></main>

  <footer scoped class="svelte-qi6xiu"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer noopener nofollow">CC BY-NC-SA 4.0
  </a>
  <div class="right svelte-qi6xiu">Made with <span class="heart svelte-qi6xiu">❤️</span> and
    <a href="https://kit.svelte.dev/" target="_blank" ref="noreferrer noopener nofollow">SvelteKit
    </a></div>
</footer>
</div>


		<script type="module" data-hydrate="1mopa32">
		import { start } from "/_app/start-cc34adcf.js";
		start({
			target: document.querySelector('[data-hydrate="1mopa32"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-33ddf72d.js"),
						import("/_app/pages/_slug_.svelte-ff50ec07.js")
				],
				params: {slug:"blog-with-sapper"},
				routeId: "[slug]"
			}
		});
	</script>
  </body>
</html>
